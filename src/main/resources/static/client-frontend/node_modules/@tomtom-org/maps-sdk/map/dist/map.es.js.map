{"version":3,"file":"map.es.js","sources":["../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_freeGlobal.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_root.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Symbol.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getRawTag.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_objectToString.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseGetTag.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isObjectLike.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isSymbol.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_arrayMap.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isArray.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseToString.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isObject.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/identity.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isFunction.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_coreJsData.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_isMasked.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_toSource.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIsNative.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getNative.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getValue.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_WeakMap.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_shortOut.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_defineProperty.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseSetToString.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/constant.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_setToString.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_isIndex.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseAssignValue.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/eq.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_assignValue.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_overRest.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isLength.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isArrayLike.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_isPrototype.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIsArguments.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isArguments.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isBuffer.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/stubFalse.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIsTypedArray.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseUnary.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_nodeUtil.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isTypedArray.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_arrayLikeKeys.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseTimes.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_overArg.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_nativeKeys.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseKeys.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/keys.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseKeysIn.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_nativeKeysIn.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/keysIn.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_isKey.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_nativeCreate.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_hashGet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_hashHas.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Hash.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_assocIndexOf.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_hashClear.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_hashDelete.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_hashSet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_listCacheDelete.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_ListCache.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_listCacheClear.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_listCacheGet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_listCacheHas.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_listCacheSet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Map.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getMapData.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_isKeyable.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_MapCache.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_mapCacheClear.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_mapCacheDelete.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_mapCacheGet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_mapCacheHas.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_mapCacheSet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/memoize.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_stringToPath.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_memoizeCapped.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_castPath.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/toString.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_toKey.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseGet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_arrayPush.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_isFlattenable.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/flatten.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseFlatten.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getPrototype.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isPlainObject.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Stack.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_stackClear.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_stackDelete.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_stackGet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_stackHas.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_stackSet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_cloneBuffer.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/stubArray.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getSymbols.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_arrayFilter.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getSymbolsIn.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseGetAllKeys.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getAllKeys.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getAllKeysIn.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_DataView.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Promise.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Set.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getTag.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_initCloneArray.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_Uint8Array.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_cloneArrayBuffer.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_cloneRegExp.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_cloneSymbol.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_initCloneByTag.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_cloneDataView.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_cloneTypedArray.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isMap.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIsMap.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isSet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIsSet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseClone.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_arrayEach.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_SetCache.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_arraySome.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_setCacheAdd.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_setCacheHas.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_equalArrays.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_cacheHas.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_mapToArray.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_setToArray.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_equalByTag.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_equalObjects.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIsEqualDeep.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIsEqual.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_isStrictComparable.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_matchesStrictComparable.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseMatches.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_getMatchData.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIsMatch.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseHasIn.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/hasIn.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_hasPath.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseMatchesProperty.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/get.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/property.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseProperty.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_basePropertyDeep.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseIteratee.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_parent.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseSlice.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isEmpty.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isEqual.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/isNil.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseUnset.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/last.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_customOmitClone.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/omit.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_flatRest.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_apply.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_copyObject.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseSet.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/pickBy.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_basePickBy.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/omitBy.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/negate.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_basePullAt.js","../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/remove.js","../src/shared/errorMessages.ts","../src/shared/imageUtils.ts","../src/shared/resources/index.ts","../src/shared/resources/pin.svg?raw","../src/shared/assertionUtils.ts","../src/shared/TomTomMapSource.ts","../src/shared/SourceWithLayers.ts","../src/shared/mapUtils.ts","../src/shared/AbstractMapModule.ts","../src/shared/EventsModule.ts","../src/shared/AbstractEventProxy.ts","../src/shared/eventUtils.ts","../src/shared/EventsProxy.ts","../src/shared/layers/layerIDs.ts","../src/shared/layers/sourcesIDs.ts","../src/pois/layers/poisLayers.ts","../src/pois/poiCategoryMapping.ts","../src/shared/layers/commonLayerProps.ts","../src/shared/layers/symbolLayers.ts","../src/shared/layers/eventState.ts","../src/places/layers/placesLayers.ts","../src/places/resources/index.ts","../src/places/utils/pinCategoryStandardMapping.ts","../src/places/utils/preparePlacesForDisplay.ts","../src/places/PlacesModule.ts","../src/shared/mapLibreFilterUtils.ts","../src/pois/poiCategoryGroups.ts","../src/pois/POIsModule.ts","../src/base/layerGroups.ts","../src/base/BaseMapModule.ts","../src/base/types/baseMapModuleConfig.ts","../src/geometry/types/geometryDisplayProps.ts","../src/geometry/layers/geometryLayers.ts","../src/geometry/prepareGeometryForDisplay.ts","../src/geometry/GeometriesModule.ts","../src/hillshade/HillshadeModule.ts","../src/init/types/mapInit.ts","../src/routing/layers/shared.ts","../src/routing/layers/chargingStopLayers.ts","../src/routing/layers/guidanceLayers.ts","../src/routing/layers/routeFerrySectionLayers.ts","../src/routing/layers/routeMainLineLayers.ts","../src/routing/layers/routeTollRoadLayers.ts","../src/routing/layers/routeTrafficSectionLayers.ts","../src/routing/layers/routeTunnelSectionLayers.ts","../src/routing/layers/routeVehicleRestrictedLayers.ts","../src/routing/layers/summaryBubbleLayers.ts","../src/routing/types/waypointDisplayProps.ts","../src/routing/layers/waypointLayers.ts","../src/routing/layers/routingLayers.ts","../src/routing/resources/index.ts","../src/routing/resources/instruction-line-arrow.svg?raw","../src/routing/resources/summary-map-bubble.svg?raw","../src/routing/resources/traffic.svg?raw","../src/routing/util/config.ts","../../core/dist/core.es.js","../src/routing/util/displayChargingStops.ts","../src/routing/util/displayTrafficSectionProps.ts","../src/routing/util/displayWaypoints.ts","../../node_modules/.pnpm/@turf+helpers@7.3.0/node_modules/@turf/helpers/dist/esm/index.js","../../node_modules/.pnpm/@turf+invariant@7.3.0/node_modules/@turf/invariant/dist/esm/index.js","../../node_modules/.pnpm/@turf+bearing@7.3.0/node_modules/@turf/bearing/dist/esm/index.js","../src/routing/util/guidance.ts","../src/routing/util/routeSections.ts","../src/routing/util/routeSelection.ts","../src/routing/util/routes.ts","../src/routing/RoutingModule.ts","../src/routing/resources/start.svg?raw","../src/routing/resources/circle.svg?raw","../src/routing/resources/finish.svg?raw","../src/init/styleInputBuilder.ts","../src/TomTomMap.ts","../src/init/buildMapOptions.ts","../src/shared/localization.ts","../src/traffic/types/trafficModuleConfig.ts","../src/traffic/filters/trafficFilters.ts","../src/traffic/TrafficFlowModule.ts","../src/traffic/TrafficIncidentsModule.ts"],"sourcesContent":["/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","import defineProperty from './_defineProperty.js';\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nexport default baseAssignValue;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignValue;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","import isObject from './isObject.js';\nimport isPrototype from './_isPrototype.js';\nimport nativeKeysIn from './_nativeKeysIn.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeysIn;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default nativeKeysIn;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeysIn from './_baseKeysIn.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nexport default keysIn;\n","import isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nexport default isKey;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import MapCache from './_MapCache.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nexport default memoize;\n","import memoizeCapped from './_memoizeCapped.js';\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nexport default stringToPath;\n","import memoize from './memoize.js';\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nexport default memoizeCapped;\n","import isArray from './isArray.js';\nimport isKey from './_isKey.js';\nimport stringToPath from './_stringToPath.js';\nimport toString from './toString.js';\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nexport default castPath;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","import isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default toKey;\n","import castPath from './_castPath.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nexport default baseGet;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","import Symbol from './_Symbol.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nexport default isFlattenable;\n","import baseFlatten from './_baseFlatten.js';\n\n/**\n * Flattens `array` a single level deep.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flatten([1, [2, [3, [4]], 5]]);\n * // => [1, 2, [3, [4]], 5]\n */\nfunction flatten(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, 1) : [];\n}\n\nexport default flatten;\n","import arrayPush from './_arrayPush.js';\nimport isFlattenable from './_isFlattenable.js';\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nexport default baseFlatten;\n","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n","import baseGetTag from './_baseGetTag.js';\nimport getPrototype from './_getPrototype.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nexport default isPlainObject;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import root from './_root.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nexport default cloneBuffer;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","import arrayPush from './_arrayPush.js';\nimport getPrototype from './_getPrototype.js';\nimport getSymbols from './_getSymbols.js';\nimport stubArray from './stubArray.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nexport default getSymbolsIn;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbolsIn from './_getSymbolsIn.js';\nimport keysIn from './keysIn.js';\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nexport default getAllKeysIn;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nexport default initCloneArray;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","import Uint8Array from './_Uint8Array.js';\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nexport default cloneArrayBuffer;\n","/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nexport default cloneRegExp;\n","import Symbol from './_Symbol.js';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nexport default cloneSymbol;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\nimport cloneDataView from './_cloneDataView.js';\nimport cloneRegExp from './_cloneRegExp.js';\nimport cloneSymbol from './_cloneSymbol.js';\nimport cloneTypedArray from './_cloneTypedArray.js';\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nexport default initCloneByTag;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nexport default cloneDataView;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nexport default cloneTypedArray;\n","import baseIsMap from './_baseIsMap.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nexport default isMap;\n","import getTag from './_getTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nexport default baseIsMap;\n","import baseIsSet from './_baseIsSet.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nexport default isSet;\n","import getTag from './_getTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nexport default baseIsSet;\n","import Stack from './_Stack.js';\nimport arrayEach from './_arrayEach.js';\nimport assignValue from './_assignValue.js';\nimport baseAssign from './_baseAssign.js';\nimport baseAssignIn from './_baseAssignIn.js';\nimport cloneBuffer from './_cloneBuffer.js';\nimport copyArray from './_copyArray.js';\nimport copySymbols from './_copySymbols.js';\nimport copySymbolsIn from './_copySymbolsIn.js';\nimport getAllKeys from './_getAllKeys.js';\nimport getAllKeysIn from './_getAllKeysIn.js';\nimport getTag from './_getTag.js';\nimport initCloneArray from './_initCloneArray.js';\nimport initCloneByTag from './_initCloneByTag.js';\nimport initCloneObject from './_initCloneObject.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isMap from './isMap.js';\nimport isObject from './isObject.js';\nimport isSet from './isSet.js';\nimport keys from './keys.js';\nimport keysIn from './keysIn.js';\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nexport default baseClone;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nexport default arrayEach;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nexport default baseHasIn;\n","import baseHasIn from './_baseHasIn.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nexport default hasIn;\n","import castPath from './_castPath.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isIndex from './_isIndex.js';\nimport isLength from './isLength.js';\nimport toKey from './_toKey.js';\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nexport default hasPath;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","import baseGet from './_baseGet.js';\nimport baseSlice from './_baseSlice.js';\n\n/**\n * Gets the parent value at `path` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} path The path to get the parent value of.\n * @returns {*} Returns the parent value.\n */\nfunction parent(object, path) {\n  return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));\n}\n\nexport default parent;\n","/**\n * The base implementation of `_.slice` without an iteratee call guard.\n *\n * @private\n * @param {Array} array The array to slice.\n * @param {number} [start=0] The start position.\n * @param {number} [end=array.length] The end position.\n * @returns {Array} Returns the slice of `array`.\n */\nfunction baseSlice(array, start, end) {\n  var index = -1,\n      length = array.length;\n\n  if (start < 0) {\n    start = -start > length ? 0 : (length + start);\n  }\n  end = end > length ? length : end;\n  if (end < 0) {\n    end += length;\n  }\n  length = start > end ? 0 : ((end - start) >>> 0);\n  start >>>= 0;\n\n  var result = Array(length);\n  while (++index < length) {\n    result[index] = array[index + start];\n  }\n  return result;\n}\n\nexport default baseSlice;\n","import baseKeys from './_baseKeys.js';\nimport getTag from './_getTag.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isArrayLike from './isArrayLike.js';\nimport isBuffer from './isBuffer.js';\nimport isPrototype from './_isPrototype.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    setTag = '[object Set]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if `value` is an empty object, collection, map, or set.\n *\n * Objects are considered empty if they have no own enumerable string keyed\n * properties.\n *\n * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n * jQuery-like collections are considered empty if they have a `length` of `0`.\n * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n * @example\n *\n * _.isEmpty(null);\n * // => true\n *\n * _.isEmpty(true);\n * // => true\n *\n * _.isEmpty(1);\n * // => true\n *\n * _.isEmpty([1, 2, 3]);\n * // => false\n *\n * _.isEmpty({ 'a': 1 });\n * // => false\n */\nfunction isEmpty(value) {\n  if (value == null) {\n    return true;\n  }\n  if (isArrayLike(value) &&\n      (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n        isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n    return !value.length;\n  }\n  var tag = getTag(value);\n  if (tag == mapTag || tag == setTag) {\n    return !value.size;\n  }\n  if (isPrototype(value)) {\n    return !baseKeys(value).length;\n  }\n  for (var key in value) {\n    if (hasOwnProperty.call(value, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport default isEmpty;\n","import baseIsEqual from './_baseIsEqual.js';\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nexport default isEqual;\n","/**\n * Checks if `value` is `null` or `undefined`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is nullish, else `false`.\n * @example\n *\n * _.isNil(null);\n * // => true\n *\n * _.isNil(void 0);\n * // => true\n *\n * _.isNil(NaN);\n * // => false\n */\nfunction isNil(value) {\n  return value == null;\n}\n\nexport default isNil;\n","import castPath from './_castPath.js';\nimport last from './last.js';\nimport parent from './_parent.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.unset`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The property path to unset.\n * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n */\nfunction baseUnset(object, path) {\n  path = castPath(path, object);\n  object = parent(object, path);\n  return object == null || delete object[toKey(last(path))];\n}\n\nexport default baseUnset;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nexport default last;\n","import isPlainObject from './isPlainObject.js';\n\n/**\n * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain\n * objects.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {string} key The key of the property to inspect.\n * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.\n */\nfunction customOmitClone(value) {\n  return isPlainObject(value) ? undefined : value;\n}\n\nexport default customOmitClone;\n","import arrayMap from './_arrayMap.js';\nimport baseClone from './_baseClone.js';\nimport baseUnset from './_baseUnset.js';\nimport castPath from './_castPath.js';\nimport copyObject from './_copyObject.js';\nimport customOmitClone from './_customOmitClone.js';\nimport flatRest from './_flatRest.js';\nimport getAllKeysIn from './_getAllKeysIn.js';\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * The opposite of `_.pick`; this method creates an object composed of the\n * own and inherited enumerable property paths of `object` that are not omitted.\n *\n * **Note:** This method is considerably slower than `_.pick`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The source object.\n * @param {...(string|string[])} [paths] The property paths to omit.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.omit(object, ['a', 'c']);\n * // => { 'b': '2' }\n */\nvar omit = flatRest(function(object, paths) {\n  var result = {};\n  if (object == null) {\n    return result;\n  }\n  var isDeep = false;\n  paths = arrayMap(paths, function(path) {\n    path = castPath(path, object);\n    isDeep || (isDeep = path.length > 1);\n    return path;\n  });\n  copyObject(object, getAllKeysIn(object), result);\n  if (isDeep) {\n    result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);\n  }\n  var length = paths.length;\n  while (length--) {\n    baseUnset(result, paths[length]);\n  }\n  return result;\n});\n\nexport default omit;\n","import flatten from './flatten.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * A specialized version of `baseRest` which flattens the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @returns {Function} Returns the new function.\n */\nfunction flatRest(func) {\n  return setToString(overRest(func, undefined, flatten), func + '');\n}\n\nexport default flatRest;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","import assignValue from './_assignValue.js';\nimport baseAssignValue from './_baseAssignValue.js';\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nexport default copyObject;\n","import assignValue from './_assignValue.js';\nimport castPath from './_castPath.js';\nimport isIndex from './_isIndex.js';\nimport isObject from './isObject.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.set`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to set.\n * @param {*} value The value to set.\n * @param {Function} [customizer] The function to customize path creation.\n * @returns {Object} Returns `object`.\n */\nfunction baseSet(object, path, value, customizer) {\n  if (!isObject(object)) {\n    return object;\n  }\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      lastIndex = length - 1,\n      nested = object;\n\n  while (nested != null && ++index < length) {\n    var key = toKey(path[index]),\n        newValue = value;\n\n    if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n      return object;\n    }\n\n    if (index != lastIndex) {\n      var objValue = nested[key];\n      newValue = customizer ? customizer(objValue, key, nested) : undefined;\n      if (newValue === undefined) {\n        newValue = isObject(objValue)\n          ? objValue\n          : (isIndex(path[index + 1]) ? [] : {});\n      }\n    }\n    assignValue(nested, key, newValue);\n    nested = nested[key];\n  }\n  return object;\n}\n\nexport default baseSet;\n","import arrayMap from './_arrayMap.js';\nimport baseIteratee from './_baseIteratee.js';\nimport basePickBy from './_basePickBy.js';\nimport getAllKeysIn from './_getAllKeysIn.js';\n\n/**\n * Creates an object composed of the `object` properties `predicate` returns\n * truthy for. The predicate is invoked with two arguments: (value, key).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The source object.\n * @param {Function} [predicate=_.identity] The function invoked per property.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.pickBy(object, _.isNumber);\n * // => { 'a': 1, 'c': 3 }\n */\nfunction pickBy(object, predicate) {\n  if (object == null) {\n    return {};\n  }\n  var props = arrayMap(getAllKeysIn(object), function(prop) {\n    return [prop];\n  });\n  predicate = baseIteratee(predicate);\n  return basePickBy(object, props, function(value, path) {\n    return predicate(value, path[0]);\n  });\n}\n\nexport default pickBy;\n","import baseGet from './_baseGet.js';\nimport baseSet from './_baseSet.js';\nimport castPath from './_castPath.js';\n\n/**\n * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The source object.\n * @param {string[]} paths The property paths to pick.\n * @param {Function} predicate The function invoked per property.\n * @returns {Object} Returns the new object.\n */\nfunction basePickBy(object, paths, predicate) {\n  var index = -1,\n      length = paths.length,\n      result = {};\n\n  while (++index < length) {\n    var path = paths[index],\n        value = baseGet(object, path);\n\n    if (predicate(value, path)) {\n      baseSet(result, castPath(path, object), value);\n    }\n  }\n  return result;\n}\n\nexport default basePickBy;\n","import baseIteratee from './_baseIteratee.js';\nimport negate from './negate.js';\nimport pickBy from './pickBy.js';\n\n/**\n * The opposite of `_.pickBy`; this method creates an object composed of\n * the own and inherited enumerable string keyed properties of `object` that\n * `predicate` doesn't return truthy for. The predicate is invoked with two\n * arguments: (value, key).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The source object.\n * @param {Function} [predicate=_.identity] The function invoked per property.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.omitBy(object, _.isNumber);\n * // => { 'b': '2' }\n */\nfunction omitBy(object, predicate) {\n  return pickBy(object, negate(baseIteratee(predicate)));\n}\n\nexport default omitBy;\n","/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that negates the result of the predicate `func`. The\n * `func` predicate is invoked with the `this` binding and arguments of the\n * created function.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {Function} predicate The predicate to negate.\n * @returns {Function} Returns the new negated function.\n * @example\n *\n * function isEven(n) {\n *   return n % 2 == 0;\n * }\n *\n * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));\n * // => [1, 3, 5]\n */\nfunction negate(predicate) {\n  if (typeof predicate != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  return function() {\n    var args = arguments;\n    switch (args.length) {\n      case 0: return !predicate.call(this);\n      case 1: return !predicate.call(this, args[0]);\n      case 2: return !predicate.call(this, args[0], args[1]);\n      case 3: return !predicate.call(this, args[0], args[1], args[2]);\n    }\n    return !predicate.apply(this, args);\n  };\n}\n\nexport default negate;\n","import baseUnset from './_baseUnset.js';\nimport isIndex from './_isIndex.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * The base implementation of `_.pullAt` without support for individual\n * indexes or capturing the removed elements.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {number[]} indexes The indexes of elements to remove.\n * @returns {Array} Returns `array`.\n */\nfunction basePullAt(array, indexes) {\n  var length = array ? indexes.length : 0,\n      lastIndex = length - 1;\n\n  while (length--) {\n    var index = indexes[length];\n    if (length == lastIndex || index !== previous) {\n      var previous = index;\n      if (isIndex(index)) {\n        splice.call(array, index, 1);\n      } else {\n        baseUnset(array, index);\n      }\n    }\n  }\n  return array;\n}\n\nexport default basePullAt;\n","import baseIteratee from './_baseIteratee.js';\nimport basePullAt from './_basePullAt.js';\n\n/**\n * Removes all elements from `array` that `predicate` returns truthy for\n * and returns an array of the removed elements. The predicate is invoked\n * with three arguments: (value, index, array).\n *\n * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`\n * to pull elements from an array by value.\n *\n * @static\n * @memberOf _\n * @since 2.0.0\n * @category Array\n * @param {Array} array The array to modify.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new array of removed elements.\n * @example\n *\n * var array = [1, 2, 3, 4];\n * var evens = _.remove(array, function(n) {\n *   return n % 2 == 0;\n * });\n *\n * console.log(array);\n * // => [1, 3]\n *\n * console.log(evens);\n * // => [2, 4]\n */\nfunction remove(array, predicate) {\n  var result = [];\n  if (!(array && array.length)) {\n    return result;\n  }\n  var index = -1,\n      indexes = [],\n      length = array.length;\n\n  predicate = baseIteratee(predicate, 3);\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result.push(value);\n      indexes.push(index);\n    }\n  }\n  basePullAt(array, indexes);\n  return result;\n}\n\nexport default remove;\n","import type { StyleModule } from '../init';\n\n/**\n * @ignore\n */\nexport const notInTheStyle = (actionText: string): Error =>\n    new Error(`Trying to ${actionText} while it is not in the map style. Did you exclude it when loading the map?`);\n\n/**\n * @ignore\n */\nexport const cannotAddStyleModuleToCustomStyle = (styleModule: StyleModule): Error =>\n    new Error(`Trying to add style module ${styleModule} to the custom style!`);\n","/**\n * @ignore\n */\nexport const isDOMImageSupported = (): boolean =>\n    typeof document != 'undefined' && typeof DOMParser != 'undefined' && typeof btoa != 'undefined';\n\n/**\n * @ignore\n */\nexport const svgToImg = (svgDomElement: SVGElement): HTMLImageElement => {\n    if (!isDOMImageSupported()) {\n        return undefined as never as HTMLImageElement;\n    }\n    const img = document.createElement('img');\n    img.src = `data:image/svg+xml;base64,${btoa(new XMLSerializer().serializeToString(svgDomElement))}`;\n    return img;\n};\n","import { SVGIconStyleOptions } from '../types';\nimport pinSvgRaw from './pin.svg?raw';\n\n/**\n * Helper function to parse SVG string (typically imported from ...svg?raw) to SVGElement\n * @ignore\n */\nexport const parseSvg = (svgString: string): SVGElement =>\n    new DOMParser().parseFromString(svgString, 'image/svg+xml').documentElement as unknown as SVGElement;\n\n/**\n * @ignore\n */\nexport const pinSvg = (options: SVGIconStyleOptions | undefined): SVGElement => {\n    const element = parseSvg(pinSvgRaw);\n    // see pin.svg structure\n    if (options?.fillColor) {\n        element.querySelector('#background')?.setAttribute('fill', options.fillColor);\n    }\n    if (options?.outlineColor) {\n        element.querySelector('#outline')?.setAttribute('fill', options.outlineColor);\n    }\n    if (options?.outlineOpacity !== undefined) {\n        element.querySelector('#outline')?.setAttribute('fill-opacity', options.outlineOpacity.toString());\n    }\n    return element;\n};\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"120\\\" height=\\\"140\\\">\\n    <path id=\\\"background\\\" d=\\\"M63.95 137.516c6.556-12.737 19.098-21.09 30.828-29.388C110.046 97.324 120 79.603 120 59.574 120 26.671 93.138 0 60 0S0 26.671 0 59.574c0 20.029 9.954 37.75 25.22 48.55 11.734 8.302 24.274 16.652 30.83 29.388 1.706 3.316 6.194 3.316 7.9 0z\\\"\\n          fill=\\\"#1988cf\\\"/>\\n    <path id=\\\"outline\\\" d=\\\"M91.298 103.272C105.052 93.544 114 77.596 114 59.574c0-29.61-24.176-53.617-54-53.617S6 29.964 6 59.574c0 18.022 8.95 33.97 22.7 43.698l2.27 1.601c10.172 7.153 21.922 15.423 29.03 27.416 7.104-11.993 18.858-20.259 29.03-27.416l2.268-1.601zm1.468 6.274c-11.13 7.845-22.632 15.957-28.816 27.966-1.706 3.316-6.194 3.316-7.9 0-6.182-12.009-17.686-20.121-28.816-27.966l-2.016-1.422C9.954 97.324 0 79.603 0 59.574 0 26.671 26.862 0 60 0s60 26.671 60 59.574c0 20.029-9.954 37.75-25.222 48.55l-2.016 1.422z\\\"\\n          fill-opacity=\\\".3\\\"/>\\n</svg>\\n\"","import { isNil } from 'lodash-es';\n\n/**\n * Throws an error if the given value is not defined.\n * @ignore\n */\nexport function assertDefined<T>(value: T | null | undefined): asserts value is T {\n    if (isNil(value)) {\n        throw new Error(`${value} must not be null/undefined. Something went wrong with its initialization.`);\n    }\n}\n\n/**\n * Returns the given value as its defined type, or throws an error if it isn't defined.\n * @ignore\n * @throws\n */\nexport const asDefined = <T>(value: T | null | undefined): T => {\n    assertDefined(value);\n    return value;\n};\n","import type { Map, Source, SourceSpecification } from 'maplibre-gl';\n\n/**\n * Contains a source relevant for TomTom Maps SDK JS.\n * * The source might already be initialized from the map style, or it might be initialized here.\n * @ignore\n */\nexport class TomTomMapSource<\n    SOURCE_SPEC extends SourceSpecification = SourceSpecification,\n    RUNTIME_SOURCE extends Source = Source,\n> {\n    constructor(\n        readonly id: string,\n        readonly spec?: SOURCE_SPEC,\n        public runtimeSource?: RUNTIME_SOURCE,\n    ) {}\n\n    ensureAddedToMap(map: Map) {\n        if (!this.runtimeSource) {\n            if (!map.getSource(this.id) && this.spec) {\n                map.addSource(this.id, this.spec);\n            }\n            this.runtimeSource = map.getSource(this.id) as RUNTIME_SOURCE;\n        }\n    }\n}\n","import type { FeatureCollection } from 'geojson';\nimport type {\n    GeoJSONSource,\n    GeoJSONSourceSpecification,\n    LayerSpecification,\n    Map,\n    Source,\n    SourceSpecification,\n} from 'maplibre-gl';\nimport { asDefined } from './assertionUtils';\nimport { TomTomMapSource } from './TomTomMapSource';\nimport type {\n    ByIdOrIndex,\n    CleanEventStateOptions,\n    CleanEventStatesOptions,\n    LayerSpecFilter,\n    LayerSpecWithSource,\n    PutEventStateOptions,\n    SourceWithLayerIDs,\n    SourceWithLayers,\n    ToBeAddedLayerSpec,\n    ToBeAddedLayerSpecWithoutSource,\n} from './types';\n\n/**\n * Contains a source and the layers to render its data.\n * @ignore\n */\nexport abstract class AbstractSourceWithLayers<\n    SOURCE_SPEC extends SourceSpecification = SourceSpecification,\n    RUNTIME_SOURCE extends Source = Source,\n    LAYER_SPEC extends LayerSpecification = LayerSpecification,\n> {\n    readonly _layerSpecs: LAYER_SPEC[];\n    private _sourceAndLayerIDs!: SourceWithLayerIDs;\n\n    constructor(\n        readonly map: Map,\n        readonly source: TomTomMapSource<SOURCE_SPEC, RUNTIME_SOURCE>,\n        layerSpecs: LAYER_SPEC[],\n    ) {\n        this._layerSpecs = layerSpecs;\n        this._updateSourceAndLayerIDs();\n    }\n\n    isAnyLayerVisible(filter?: LayerSpecFilter): boolean {\n        return this.getLayerSpecs(filter).some((layer) => this.isLayerVisible(layer));\n    }\n\n    areAllLayersVisible(filter?: LayerSpecFilter): boolean {\n        return this.getLayerSpecs(filter).every((layer) => this.isLayerVisible(layer));\n    }\n\n    private getLayerSpecs(filter?: LayerSpecFilter) {\n        return filter ? this._layerSpecs.filter(filter) : this._layerSpecs;\n    }\n\n    _updateSourceAndLayerIDs(): void {\n        this._sourceAndLayerIDs = { sourceID: this.source.id, layerIDs: this._layerSpecs.map((layer) => layer.id) };\n    }\n\n    private isLayerVisible(layer: LayerSpecification): boolean {\n        return this.map.getLayoutProperty(layer.id, 'visibility') !== 'none';\n    }\n\n    setLayersVisible(visible: boolean, filter?: LayerSpecFilter): void {\n        for (const layerSpec of this.getLayerSpecs(filter)) {\n            this.map.setLayoutProperty(layerSpec.id, 'visibility', visible ? 'visible' : 'none', { validate: false });\n        }\n    }\n\n    get sourceAndLayerIDs(): SourceWithLayerIDs {\n        return this._sourceAndLayerIDs;\n    }\n\n    equalSourceAndLayerIDs(other: SourceWithLayers): boolean {\n        return (\n            this.sourceAndLayerIDs.sourceID === other.sourceAndLayerIDs.sourceID &&\n            this.sourceAndLayerIDs.layerIDs.length === other.sourceAndLayerIDs.layerIDs.length &&\n            this.sourceAndLayerIDs.layerIDs.every((id, index) => id === other.sourceAndLayerIDs.layerIDs[index])\n        );\n    }\n}\n\n/**\n * @ignore\n * @param loadedMap\n * @param sourceIDs\n */\nexport const filterLayersBySources = (loadedMap: Map, sourceIDs: string[]): LayerSpecWithSource[] =>\n    loadedMap\n        .getStyle()\n        .layers.filter((layer) => sourceIDs.includes((layer as LayerSpecWithSource)?.source)) as LayerSpecWithSource[];\n\n/**\n * Source with layers which are coming from the downloaded TT map style.\n * * Examples are parts of the base map, traffic, pois, and hillshade.\n * @ignore\n */\nexport class StyleSourceWithLayers<\n    SOURCE_SPEC extends SourceSpecification = SourceSpecification,\n    RUNTIME_SOURCE extends Source = Source,\n> extends AbstractSourceWithLayers<SourceSpecification, RUNTIME_SOURCE> {\n    constructor(map: Map, runtimeSource: RUNTIME_SOURCE, filter?: LayerSpecFilter) {\n        let layers = filterLayersBySources(map, [runtimeSource.id]);\n        if (filter) {\n            layers = layers.filter(filter);\n        }\n        super(\n            map,\n            new TomTomMapSource<SOURCE_SPEC, RUNTIME_SOURCE>(\n                runtimeSource.id,\n                map.getStyle().sources[runtimeSource.id] as SOURCE_SPEC,\n                runtimeSource,\n            ),\n            layers,\n        );\n    }\n}\n\n/**\n * Source with layers which originally is not in the map style, but it's to be added after the map is initialized.\n * @ignore\n */\nexport class AddedSourceWithLayers<\n    SOURCE_SPEC extends SourceSpecification = SourceSpecification,\n    RUNTIME_SOURCE extends Source = Source,\n> extends AbstractSourceWithLayers<SOURCE_SPEC, RUNTIME_SOURCE, ToBeAddedLayerSpec> {\n    constructor(map: Map, sourceId: string, sourceSpec: SOURCE_SPEC, layerSpecs: ToBeAddedLayerSpecWithoutSource[]) {\n        super(\n            map,\n            new TomTomMapSource<SOURCE_SPEC, RUNTIME_SOURCE>(sourceId, sourceSpec),\n            // We ensure the source ID is assigned to the layers:\n            layerSpecs.map((layerSpec) => ({ ...layerSpec, source: sourceId }) as ToBeAddedLayerSpec),\n        );\n    }\n\n    private ensureLayersAddedToMap(): void {\n        for (const layerSpec of this._layerSpecs) {\n            if (!this.map.getLayer(layerSpec.id)) {\n                this.map.addLayer(layerSpec, layerSpec.beforeID);\n            }\n        }\n    }\n\n    ensureAddedToMapWithVisibility(visible: boolean, addLayersToMap: boolean): void {\n        this.source.ensureAddedToMap(this.map);\n        if (addLayersToMap) {\n            this.ensureLayersAddedToMap();\n            this.setLayersVisible(visible);\n        }\n    }\n}\n\nconst emptyFeatureCollection: FeatureCollection = { type: 'FeatureCollection', features: [] };\n\n/**\n * @ignore\n */\nexport class GeoJSONSourceWithLayers<T extends FeatureCollection = FeatureCollection> extends AddedSourceWithLayers<\n    GeoJSONSourceSpecification,\n    GeoJSONSource\n> {\n    shownFeatures: T = emptyFeatureCollection as T;\n\n    constructor(map: Map, sourceId: string, layerSpecs: ToBeAddedLayerSpecWithoutSource[], addLayersToMap = true) {\n        // MapLibre does not reuse the given feature ID. Either we generate it on the fly or use the one from properties via promotedId value.\n        // We must generate \"id\" property based on the feature id on the fly on \"prepareForDisplay\" functions.\n        super(map, sourceId, { type: 'geojson', data: emptyFeatureCollection, promoteId: 'id' }, layerSpecs);\n        this.ensureAddedToMapWithVisibility(false, addLayersToMap);\n    }\n\n    show(featureCollection: T): void {\n        this.shownFeatures = featureCollection;\n        asDefined(this.source.runtimeSource).setData(featureCollection);\n        this.setLayersVisible(!!featureCollection.features.length);\n    }\n\n    clear(): void {\n        this.show(emptyFeatureCollection as T);\n    }\n\n    private findFeature(options: ByIdOrIndex) {\n        if ('index' in options) {\n            return this.shownFeatures.features[options.index];\n        } else if ('id' in options) {\n            return this.shownFeatures.features.find((f) => f.id === options.id);\n        }\n        return undefined;\n    }\n\n    putEventState(options: PutEventStateOptions) {\n        const mode = options.mode ?? 'put';\n        if (mode === 'put') {\n            for (const feature of this.shownFeatures.features) {\n                if (feature.properties?.eventState === options.state) {\n                    delete feature.properties.eventState;\n                }\n            }\n        }\n\n        const feature = this.findFeature(options);\n        if (feature) {\n            feature.properties = { ...feature.properties, eventState: options.state };\n        }\n\n        if (options.show !== false) {\n            this.show(this.shownFeatures);\n        }\n    }\n\n    cleanEventState(options: CleanEventStateOptions) {\n        const feature = this.findFeature(options);\n\n        if (feature?.properties?.eventState) {\n            delete feature?.properties?.eventState;\n            if (options?.show !== false) {\n                this.show(this.shownFeatures);\n            }\n        }\n    }\n\n    cleanEventStates(options?: CleanEventStatesOptions) {\n        let changed = false;\n        for (const feature of this.shownFeatures.features) {\n            if (!options?.states || options.states.includes(feature.properties?.eventState)) {\n                delete feature.properties?.eventState;\n                changed = true;\n            }\n        }\n\n        if (options?.show !== false && changed) {\n            this.show(this.shownFeatures);\n        }\n    }\n}\n","import type { GlobalConfig } from '@tomtom-org/maps-sdk/core';\nimport { generateTomTomHeaders } from '@tomtom-org/maps-sdk/core';\nimport type {\n    FilterSpecification,\n    Map,\n    MapGeoJSONFeature,\n    RequestParameters,\n    ResourceType,\n    StyleImageMetadata,\n} from 'maplibre-gl';\nimport { StandardStyle, StandardStyleID, StyleInput, StyleModule, type TomTomMapParams } from '../init';\nimport type { TomTomMap } from '../TomTomMap';\nimport { cannotAddStyleModuleToCustomStyle } from './errorMessages';\nimport { svgToImg } from './imageUtils';\nimport { parseSvg } from './resources';\nimport { AbstractSourceWithLayers, filterLayersBySources } from './SourceWithLayers';\nimport type { LightDark, ToBeAddedLayerSpec, ToBeAddedLayerSpecWithoutSource } from './types';\n\n/**\n * Wait until the map is ready.\n * @param tomtomMap The TomTomMap instance.\n * @returns {Promise<boolean>} Returns a Promise<boolean>\n */\nexport const waitUntilMapIsReady = async (tomtomMap: TomTomMap): Promise<void> => {\n    if (!tomtomMap.mapReady) {\n        await tomtomMap.mapLibreMap.once('styledata');\n        // Recursively waiting for map to be ready (in case of style changes quickly in succession):\n        await waitUntilMapIsReady(tomtomMap);\n    }\n};\n\n/**\n * Wait until the source is ready.\n * @param tomtomMap The TomTomMap instance.\n * @param sourceId we want to check for.\n * @returns {Promise<boolean>} Returns a Promise<boolean>\n */\nexport const waitUntilSourceIsLoaded = async (tomtomMap: TomTomMap, sourceId: string): Promise<void> => {\n    if (!tomtomMap.mapLibreMap.getSource(sourceId) || !tomtomMap.mapLibreMap.isSourceLoaded(sourceId)) {\n        await tomtomMap.mapLibreMap.once('sourcedata');\n    }\n};\n\n/**\n * Deserializes the properties from MapLibre features.\n * * Maplibre has a bug where all properties from a feature are stringified.\n * See: {@link} https://github.com/maplibre/maplibre-gl-js/issues/1325\n *\n * @param features An Array with MapGeoJSONFeatures objects\n *\n * @ignore\n */\nexport const deserializeFeatures = (features: MapGeoJSONFeature[]): void => {\n    for (const feature of features) {\n        if (!feature || Object.keys(feature.properties).length === 0) {\n            return;\n        }\n\n        for (const key in feature.properties) {\n            if (typeof feature.properties[key] === 'string') {\n                try {\n                    feature.properties[key] = JSON.parse(feature.properties[key]);\n                } catch (e) {\n                    // We ignore the error if the object can't be parsed and continue.\n                    console.warn('Cannot deserialize feature property', key, 'with value', feature.properties[key], e);\n                }\n            }\n        }\n    }\n};\n\n/**\n * Inject TomTom custom headers to requests to TomTom.\n *\n * @ignore\n * @param params Global SDK Map configuration\n */\nexport const injectTomTomHeaders =\n    (params: Partial<GlobalConfig>) =>\n    (url: string, resourceType?: ResourceType): RequestParameters => {\n        if (url.includes('tomtom.com')) {\n            if (resourceType === 'Image') {\n                return { url };\n            }\n            return { url, headers: { ...generateTomTomHeaders(params) } };\n        }\n        return { url };\n    };\n\n/**\n * Compares two MapLibre features by reference or ID.\n * @ignore\n */\nexport const areBothDefinedAndEqual = (\n    featureA: MapGeoJSONFeature | undefined,\n    featureB: MapGeoJSONFeature | undefined,\n): boolean => !!featureA && !!featureB && featureA.id === featureB.id;\n\ntype LayerProps = {\n    id: string;\n    layout?: any;\n    paint?: any;\n    minzoom?: number;\n    maxzoom?: number;\n    filter?: FilterSpecification;\n};\n\n/**\n * Applies the layout and paint properties from newLayoutPaint\n * while unsetting (setting as undefined) the ones from previousSpec which no longer exist in newLayoutPaint.\n * * This allows for a quick change of a layer visuals without removing-re-adding the layer.\n * @ignore\n * @param newLayerProps The new layer from which to apply layout/pain props.\n * @param prevLayerProps The previous layer to ensure layout/paint props are removed.\n * @param map\n */\nexport const changeLayerProps = (newLayerProps: LayerProps, prevLayerProps: LayerProps, map: Map) => {\n    const layerId = newLayerProps.id;\n    if (newLayerProps.maxzoom !== prevLayerProps.maxzoom || newLayerProps.minzoom !== prevLayerProps.minzoom) {\n        map.setLayerZoomRange(\n            layerId,\n            newLayerProps.minzoom ?? map.getMinZoom(),\n            newLayerProps.maxzoom ?? map.getMaxZoom(),\n        );\n    }\n    map.setFilter(layerId, newLayerProps.filter, { validate: false });\n    for (const property of Object.keys(prevLayerProps.layout ?? [])) {\n        if (!newLayerProps.layout?.[property]) {\n            map.setLayoutProperty(layerId, property, undefined, { validate: false });\n        }\n    }\n    for (const property of Object.keys(prevLayerProps.paint ?? [])) {\n        if (!newLayerProps.paint?.[property]) {\n            map.setPaintProperty(layerId, property, undefined, { validate: false });\n        }\n    }\n    for (const [property, value] of Object.entries(newLayerProps.paint ?? [])) {\n        map.setPaintProperty(layerId, property, value, { validate: false });\n    }\n\n    for (const [property, value] of Object.entries(newLayerProps.layout ?? [])) {\n        map.setLayoutProperty(layerId, property, value, { validate: false });\n    }\n};\n\n/**\n * Applies the layer properties from each layer of newLayoutPaints\n * while unsetting (setting as undefined) the ones from the corresponding layer from prevLayoutPaints\n * which no longer exist in the new one.\n * * The two layer inputs are expected to be parallel arrays.\n * * This allows for quick changes of layer visuals without removing-re-adding the layers.\n * @ignore\n */\nexport const changeLayersProps = (newLayerProps: LayerProps[], prevLayerProps: LayerProps[], map: Map) => {\n    newLayerProps.forEach((layoutPaint, index) => changeLayerProps(layoutPaint, prevLayerProps[index], map));\n};\n\n/**\n * Handles new layer specs for the provided source. It will remove layers no longer present,\n * update existing layers and add new one if needed to the source.\n * Adding layers to the map needs to be done correctly, so after calling this method, you should call addLayersInCorrectOrder.\n * If ID of layer to be added already is present on map, MapLibre will through exception.\n * @param newLayersSpecs new layer specification for provided source.\n * @param oldLayersSpecs current layer specification for provided source.\n * @param sourceWithLayers provided source that contains layers.\n * @param map provided map libre map object.\n * @ignore\n */\nexport const updateLayersAndSource = (\n    newLayersSpecs: ToBeAddedLayerSpecWithoutSource[],\n    oldLayersSpecs: ToBeAddedLayerSpecWithoutSource[],\n    sourceWithLayers: AbstractSourceWithLayers,\n    map: Map,\n): void => {\n    // map layers by id in object for easier access, reduces number of loops\n    const newLayersMap: Record<string, ToBeAddedLayerSpecWithoutSource> = newLayersSpecs.reduce(\n        (acc, cur) => ({ ...acc, [cur.id]: cur }),\n        {},\n    );\n    const oldLayersMap: Record<string, ToBeAddedLayerSpecWithoutSource> = oldLayersSpecs.reduce(\n        (acc, cur) => ({ ...acc, [cur.id]: cur }),\n        {},\n    );\n\n    // we need to store layers in four arrays, layers to add ID, layers to remove ID and layers to update\n    const layersToAdd: string[] = [];\n    const layersToRemove: string[] = [];\n    const newLayersToUpdate: ToBeAddedLayerSpecWithoutSource[] = [];\n    const oldLayersToUpdate: ToBeAddedLayerSpecWithoutSource[] = [];\n    Object.keys(newLayersMap).forEach((key) => {\n        if (oldLayersMap[key]) {\n            newLayersToUpdate.push(newLayersMap[key]);\n            oldLayersToUpdate.push(oldLayersMap[key]);\n        } else {\n            layersToAdd.push(key);\n        }\n    });\n    Object.keys(oldLayersMap).forEach((key) => {\n        if (!newLayersMap[key]) {\n            layersToRemove.push(key);\n        }\n    });\n\n    // remove the old layers no longer present in new layer specification\n    const layerSpecs: ToBeAddedLayerSpec[] = sourceWithLayers._layerSpecs;\n    layersToRemove.forEach((layerId) => {\n        map.removeLayer(layerId);\n        for (let i = 0; i < layerSpecs.length; i++) {\n            if (layerSpecs[i].id === layerId) {\n                layerSpecs.splice(i, 1);\n                break;\n            }\n        }\n    });\n    // add new layers\n    layersToAdd.forEach((layerId) => {\n        // add layer spec and map\n        const toBeAddedLayerSpec: ToBeAddedLayerSpec = {\n            ...newLayersMap[layerId],\n            source: sourceWithLayers.source.id,\n        } as ToBeAddedLayerSpec;\n        layerSpecs.push(toBeAddedLayerSpec);\n    });\n    sourceWithLayers._updateSourceAndLayerIDs();\n    // update existing layers\n    changeLayersProps(newLayersToUpdate, oldLayersToUpdate, map);\n};\n\n/**\n * Adds the given layers to the map ensuring they respect their \"beforeID\" properties.\n * * We need to make sure that layers are added in the correct Z order because one layer may depend on another layer.\n * @param layersToAdd\n * @param map MapLibre map\n * @ignore\n */\nexport const addLayers = (layersToAdd: ToBeAddedLayerSpec[], map: Map): void => {\n    const layerIdsAlreadyOnMap = new Set<string>();\n    const addLayer = (layer: ToBeAddedLayerSpec): void => {\n        // we can safely add this layer\n        if (!map.getLayer(layer.id)) {\n            map.addLayer({ ...layer, layout: { ...layer.layout, visibility: 'none' } }, layer.beforeID);\n        }\n        layerIdsAlreadyOnMap.add(layer.id);\n    };\n\n    const mapIdDependency: Record<string, ToBeAddedLayerSpec[]> = {};\n\n    layersToAdd.forEach((layer) => {\n        if (layer.beforeID) {\n            if (layerIdsAlreadyOnMap.has(layer.beforeID) || map.getLayer(layer.beforeID)) {\n                layerIdsAlreadyOnMap.add(layer.beforeID);\n                addLayer(layer);\n            } else if (mapIdDependency[layer.beforeID]) {\n                // we cannot add this layer yet\n                mapIdDependency[layer.beforeID].push(layer);\n            } else {\n                mapIdDependency[layer.beforeID] = [layer];\n            }\n        } else {\n            addLayer(layer);\n        }\n    });\n\n    // try to process the rest of layers\n    while (Object.keys(mapIdDependency).length > 0) {\n        const idsWeCanProcess = Object.keys(mapIdDependency).filter((id) => layerIdsAlreadyOnMap.has(id));\n        if (idsWeCanProcess.length === 0) {\n            throw Error(`Circular dependency for before Ids ${JSON.stringify(Object.keys(mapIdDependency))}`);\n        }\n        idsWeCanProcess.forEach((id) => {\n            mapIdDependency[id].forEach((layer) => addLayer(layer));\n            delete mapIdDependency[id];\n        });\n    }\n};\n\n/**\n * Adding a style-based module to the given style input, if possible.\n * * This results in a style input which will include such style-based module (e.g. include traffic layers).\n * @param style which we want to update.\n * @param styleModule module we want to add.\n * @ignore\n */\nexport const updateStyleWithModule = (style: StyleInput | undefined, styleModule: StyleModule): StyleInput => {\n    switch (typeof style) {\n        case 'undefined':\n            return { type: 'standard', include: [styleModule] };\n        case 'string':\n            // this is a standard style\n            return { type: 'standard', id: style, include: [styleModule] };\n        default:\n            if (style.type === 'standard') {\n                if (style.include) {\n                    return { ...style, include: [...style.include, styleModule] };\n                }\n                return { ...style, include: [styleModule] };\n            }\n            throw cannotAddStyleModuleToCustomStyle(styleModule);\n    }\n};\n\n/**\n * Checks if the source is missing and try to add it to the map by reloading its style.\n * @param map the TomTom map instance.\n * @param sourceId id of the source.\n * @param styleModule style module of the source.\n * @ignore\n */\nexport const ensureAddedToStyle = async (map: TomTomMap, sourceId: string, styleModule: StyleModule): Promise<void> => {\n    if (!map.mapLibreMap.getSource(sourceId)) {\n        if (!map.mapLibreMap.isStyleLoaded()) {\n            // we let the map settle before changing its style again, so the previous style/data load goes smoother:\n            await map.mapLibreMap.once('idle');\n        }\n        map.setStyle(updateStyleWithModule(map.getStyle(), styleModule));\n        await waitUntilSourceIsLoaded(map, sourceId);\n\n        map.mapLibreMap.once('styledata', () => {\n            // we're loading a bunch of style layers to the map, and we hide them all by default:\n            // see TomTomMap.handleStyleData for similar logic\n            for (const layer of filterLayersBySources(map.mapLibreMap, [sourceId])) {\n                map.mapLibreMap.setLayoutProperty(layer.id, 'visibility', 'none', { validate: false });\n            }\n        });\n    }\n};\n\n/**\n * Sets the given image on the map (loading it if necessary), either adding or updating it.\n * @ignore\n */\nexport const addOrUpdateImage = async (\n    mode: 'if-not-in-sprite' | 'add-or-update',\n    imageId: string,\n    imageToLoad: string | HTMLImageElement,\n    map: Map,\n    options?: Partial<StyleImageMetadata>,\n) => {\n    // defensive check (should not happen but we cannot let it crash):\n    if (!imageToLoad) {\n        console.warn(`addOrUpdateImage called with empty image for ID ${imageId}`);\n        return;\n    }\n\n    // Helper function to add or update the image\n    const addOrUpdateImage = (imgElement: HTMLImageElement | ImageData | ImageBitmap) => {\n        const imageExists = map.hasImage(imageId);\n        if (imageExists && mode == 'add-or-update') {\n            map.updateImage(imageId, imgElement);\n        } else if (!imageExists) {\n            map.addImage(imageId, imgElement, options);\n        }\n    };\n\n    if (typeof imageToLoad === 'string') {\n        if (imageToLoad.includes('<svg')) {\n            // Supporting raw SVGs:\n            const imgElement = svgToImg(parseSvg(imageToLoad));\n            // (Defensive setTimeout to ensure the image is loaded)\n            setTimeout(() => addOrUpdateImage(imgElement));\n        } else {\n            // Expecting image URL, so the image needs to be downloaded first:\n            addOrUpdateImage((await map.loadImage(imageToLoad)).data);\n        }\n    } else {\n        // Expecting HTMLImageElement, ready to be added:\n        // (Defensive setTimeout to ensure the image is loaded)\n        setTimeout(() => addOrUpdateImage(imageToLoad));\n    }\n};\n\n/**\n * Returns the light/dark theme for a known standard style.\n * @param standardStyleID\n */\nconst getStandardStyleTheme = (standardStyleID: StandardStyleID): LightDark => {\n    switch (standardStyleID) {\n        case 'standardDark':\n        case 'drivingDark':\n        case 'monoDark':\n        case 'satellite':\n            return 'dark';\n        default:\n            return 'light';\n    }\n};\n\n/**\n * Returns the light/dark theme for a given style input.\n * * Unknown standard styles and custom styles are considered as 'light' theme.\n * @param styleInput The style input to check. If not provided, 'light' is returned.\n * @ignore\n */\nexport const getStyleLightDarkTheme = (styleInput?: StyleInput): LightDark => {\n    if (typeof styleInput === 'string') {\n        return getStandardStyleTheme(styleInput);\n    }\n    const standardStyle = styleInput as StandardStyle;\n    if (standardStyle?.id) {\n        return getStandardStyleTheme(standardStyle.id);\n    }\n    return 'light';\n};\n\n/**\n * Adds the large POI sprite to the map style.\n * @ignore\n */\nexport const addPinCategoriesSpriteToStyle = async (mapParams: TomTomMapParams, mapLibreMap: Map) => {\n    mapLibreMap.setSprite(\n        `${mapParams.commonBaseURL}/maps/orbis/assets/sprites/2.*/sprite?key=${mapParams.apiKey}&poi=poi_${getStyleLightDarkTheme(mapParams.style)}&apiVersion=1&apiChannel=preview`,\n        { validate: false },\n    );\n};\n","import type { Map } from 'maplibre-gl';\nimport type { TomTomMap } from '../TomTomMap';\nimport type { EventsProxy } from './EventsProxy';\nimport { waitUntilMapIsReady } from './mapUtils';\nimport type { SourcesWithLayers, SourceWithLayerIDs } from './types';\nimport type { MapModuleSource } from './types/mapModule';\n\n/**\n * Base class for all Maps SDK map modules.\n *\n * This abstract class provides the foundation for creating map modules that can display\n * and manage various types of data on a TomTom map. It handles module lifecycle management,\n * including initialization, configuration updates, and automatic restoration after map style changes.\n *\n * @remarks\n * All map modules extend this class to ensure consistent behavior across the SDK.\n * The class manages the module's sources, layers, and configuration, automatically\n * handling map style changes by restoring the module's state when needed.\n *\n * @typeParam SOURCES_WITH_LAYERS - The type defining the sources and layers used by this module\n * @typeParam CFG - The configuration type for this module, or undefined if no configuration is needed\n *\n * @example\n * ```typescript\n * class CustomModule extends AbstractMapModule<MySourcesWithLayers, MyConfig> {\n *   constructor(tomtomMap: TomTomMap, config?: MyConfig) {\n *     super('geojson', tomtomMap, config);\n *   }\n *   // Implement abstract methods...\n * }\n * ```\n *\n * @group Shared\n */\nexport abstract class AbstractMapModule<SOURCES_WITH_LAYERS extends SourcesWithLayers, CFG = undefined> {\n    private readonly sourceType: MapModuleSource;\n    /**\n     * @ignore\n     */\n    protected readonly tomtomMap: TomTomMap;\n    /**\n     * @ignore\n     */\n    protected readonly eventsProxy: EventsProxy;\n    /**\n     * @ignore\n     */\n    protected readonly mapLibreMap: Map;\n    /**\n     * @ignore\n     */\n    protected sourcesWithLayers!: SOURCES_WITH_LAYERS;\n    /**\n     * @ignore\n     */\n    protected _sourceAndLayerIDs!: Record<keyof SOURCES_WITH_LAYERS, SourceWithLayerIDs>;\n    /**\n     * @ignore\n     */\n    protected config?: CFG;\n    /**\n     * @ignore\n     */\n    protected _initializing = true;\n\n    /**\n     * Indicates that this module is currently adding its sources and layers to the map, so during this time it might not function properly.\n     * @see waitUntilModuleReady\n     * @private\n     */\n    private moduleReady = false;\n\n    /**\n     * Builds this module based on a given Maps SDK map.\n     * @param tomtomMap The map. It may or may not be initialized at this stage,\n     * but the module ensures to initialize itself once it is.\n     * @param sourceType Whether the module is based on a map style or on added GeoJSON data.\n     * @param config Optional configuration to initialize directly as soon as the map is ready.\n     */\n    protected constructor(sourceType: MapModuleSource, tomtomMap: TomTomMap, config?: CFG) {\n        this.sourceType = sourceType;\n        this.tomtomMap = tomtomMap;\n        this.eventsProxy = tomtomMap._eventsProxy;\n        this.mapLibreMap = tomtomMap.mapLibreMap;\n        this.initSourcesWithLayers(config);\n        this.applyConfig(config);\n        this.tomtomMap.addStyleChangeHandler({\n            onStyleAboutToChange: () => {\n                this.moduleReady = false;\n            },\n            onStyleChanged: () => this.restoreDataAndConfig(),\n        });\n        this._initializing = false;\n    }\n\n    /**\n     * Initializes the sources with layers of this module.\n     * @param config The optional configuration for the module.\n     * @param restore Whether we are restoring an existing module after the map style got reloaded.\n     * @protected\n     * @ignore\n     */\n    protected initSourcesWithLayers(config?: CFG, restore?: boolean): void {\n        this.moduleReady = false;\n        this.sourcesWithLayers = this._initSourcesWithLayers(config, restore);\n        this._sourceAndLayerIDs = Object.fromEntries(\n            Object.entries(this.sourcesWithLayers).map(([name, sourceWithLayers]) => [\n                name,\n                sourceWithLayers.sourceAndLayerIDs,\n            ]),\n        ) as Record<keyof SOURCES_WITH_LAYERS, SourceWithLayerIDs>;\n        if (restore) {\n            this.eventsProxy.updateIfRegistered(this.sourcesWithLayers);\n        }\n        // Only if the map is still ready, we consider that the module is ready.\n        // Otherwise, we assume there's a quick style change in progress and expect that'll trigger the module to restore itself again.\n        if (this.tomtomMap.mapReady) {\n            this.moduleReady = true;\n        }\n    }\n\n    /**\n     * Initializes the sources with layers for the specific module.\n     * @protected\n     * @ignore\n     */\n    protected abstract _initSourcesWithLayers(config?: CFG, restore?: boolean): SOURCES_WITH_LAYERS;\n\n    protected async waitUntilModuleReady(): Promise<void> {\n        await waitUntilMapIsReady(this.tomtomMap);\n        if (!this.moduleReady) {\n            await new Promise<void>((resolve) => {\n                const interval = setInterval(() => {\n                    if (this.tomtomMap.mapReady && this.moduleReady) {\n                        clearInterval(interval);\n                        resolve();\n                    }\n                }, 200);\n            });\n        }\n    }\n\n    /**\n     * Applies a configuration to this module.\n     *\n     * This method updates the module's behavior and appearance based on the provided configuration.\n     * The configuration is stored internally and will be automatically reapplied if the map style changes.\n     *\n     * @param config - The configuration object to apply to the module. Pass `undefined` to reset\n     * the configuration to default values.\n     *\n     * @remarks\n     * When a configuration is applied, the module updates its visual representation and behavior\n     * accordingly. The configuration persists across map style changes, ensuring consistent\n     * module behavior even when the map's base style is modified.\n     *\n     * @example\n     * ```typescript\n     * // Apply a new configuration\n     * myModule.applyConfig({ visible: true, opacity: 0.8 });\n     *\n     * // Reset to default configuration\n     * myModule.applyConfig(undefined);\n     * ```\n     *\n     * @see {@link resetConfig} for a convenience method to reset configuration\n     * @see {@link getConfig} to retrieve the current configuration\n     */\n    applyConfig(config: CFG | undefined) {\n        this.config = this._applyConfig(config);\n    }\n\n    /**\n     * Internal implementation to apply config for the specific module.\n     * @param config The config to apply. this.config contains the previous configuration (if any).\n     * Once the method returns config, it will be assigned to this.config.\n     * @protected\n     * @ignore\n     */\n    protected abstract _applyConfig(config: CFG | undefined): CFG | undefined;\n\n    /**\n     * Resets the configuration of this module to its default values.\n     *\n     * This is a convenience method that clears any previously applied configuration\n     * and restores the module to its initial state. This is equivalent to calling\n     * `applyConfig(undefined)`.\n     *\n     * @remarks\n     * After calling this method, the module will behave as if no configuration was ever applied.\n     * Any custom settings, styling, or behavior modifications will be removed and replaced\n     * with default values.\n     *\n     * @example\n     * ```typescript\n     * // Apply some configuration\n     * myModule.applyConfig({ visible: true, opacity: 0.5 });\n     *\n     * // Later, reset to defaults\n     * myModule.resetConfig();\n     * ```\n     *\n     * @see {@link applyConfig} to apply a new configuration\n     * @see {@link getConfig} to retrieve the current configuration before resetting\n     */\n    resetConfig(): void {\n        this.applyConfig(undefined);\n    }\n\n    private async restoreDataAndConfig() {\n        // defensively declaring the module as not ready to prevent race conditions:\n        this.moduleReady = false;\n        if (this.sourceType === 'geojson') {\n            // (We use setTimeout to compensate for a MapLibre glitch where symbol layers can't get added right after\n            // a styledata event. With this setTimeout, we wait just a tiny bit more which mitigates the issue)\n            setTimeout(() => this.restoreDataAndConfigImpl(), 400);\n        } else {\n            this.restoreDataAndConfigImpl();\n        }\n    }\n\n    /**\n     * implementation needed to restore the module state (data and config applied to the module).\n     * to be used to restore module state after map style change\n     * @protected\n     * @ignore\n     */\n    protected restoreDataAndConfigImpl(): void {\n        this.initSourcesWithLayers(this.config, true);\n        this._applyConfig(this.config);\n    }\n\n    /**\n     * Retrieves a copy of the current module configuration.\n     *\n     * This method returns a shallow copy of the configuration object that is currently\n     * applied to the module. If no configuration has been applied, it returns `undefined`.\n     *\n     * @returns A shallow copy of the current configuration object, or `undefined` if no\n     * configuration is currently applied. The returned object is a copy to prevent\n     * unintended modifications to the internal state.\n     *\n     * @remarks\n     * The returned configuration object is a shallow copy, which means that while the\n     * top-level properties are copied, any nested objects or arrays are still referenced\n     * from the original configuration. This is sufficient for most use cases but should\n     * be kept in mind when dealing with complex configurations.\n     *\n     * @example\n     * ```typescript\n     * // Apply a configuration\n     * myModule.applyConfig({ visible: true, opacity: 0.8 });\n     *\n     * // Later, retrieve the current configuration\n     * const currentConfig = myModule.getConfig();\n     * console.log(currentConfig); // { visible: true, opacity: 0.8 }\n     *\n     * // When no config is applied\n     * myModule.resetConfig();\n     * console.log(myModule.getConfig()); // undefined\n     * ```\n     *\n     * @see {@link applyConfig} to modify the configuration\n     * @see {@link resetConfig} to clear the configuration\n     */\n    getConfig() {\n        return this.config && { ...this.config };\n    }\n\n    /**\n     * Gets the source and layer identifiers for all sources managed by this module.\n     *\n     * This property provides access to the MapLibre source and layer IDs that were created\n     * and are managed by this module. These IDs can be used to interact directly with\n     * MapLibre's API or to identify which layers belong to this module.\n     *\n     * @returns A record mapping each source name to its corresponding source ID and layer IDs.\n     * Each entry contains the MapLibre source identifier and an array of layer identifiers\n     * associated with that source.\n     *\n     * @remarks\n     * The returned IDs are useful when you need to:\n     * - Directly manipulate layers using MapLibre's native API\n     * - Identify which layers on the map belong to this module\n     * - Set layer ordering or positioning relative to other layers\n     * - Access source or layer properties through MapLibre methods\n     *\n     * @example\n     * ```typescript\n     * const ids = myModule.sourceAndLayerIDs;\n     * console.log(ids);\n     * // {\n     * //   mySource: {\n     * //     sourceID: 'my-source-id',\n     * //     layerIDs: ['layer-1', 'layer-2']\n     * //   }\n     * // }\n     *\n     * // Use with MapLibre API\n     * const map = myModule.mapLibreMap;\n     * ids.mySource.layerIDs.forEach(layerId => {\n     *   map.setLayoutProperty(layerId, 'visibility', 'visible');\n     * });\n     * ```\n     */\n    get sourceAndLayerIDs(): Record<keyof SOURCES_WITH_LAYERS, SourceWithLayerIDs> {\n        return this._sourceAndLayerIDs;\n    }\n}\n","import type { MapGeoJSONFeature } from 'maplibre-gl';\nimport type { EventsProxy } from './EventsProxy';\nimport type { EventType, SourceWithLayers, UserEventHandler } from './types';\n\n/**\n * Event handling interface for map features.\n *\n * Provides a simple API for attaching and removing event handlers for user interactions\n * with map features such as clicks, hovers, and context menus. Each map module (POIs, Routing,\n * Places, etc.) exposes an `events` property that returns an EventsModule instance.\n *\n * @typeParam T - The feature type returned in event handlers (extends MapGeoJSONFeature)\n *\n * @remarks\n * **Supported Event Types:**\n * - `click`: User clicks/taps on a feature\n * - `contextmenu`: User right-clicks on a feature (or long-press on mobile)\n * - `hover`: Mouse enters a feature\n * - `long-hover`: Mouse hovers over feature for configured duration (300-800ms)\n *\n * **Event Handler Signature:**\n * ```typescript\n * (feature: T, lngLat: LngLat, features: T[]) => void\n * ```\n *\n * **Parameters:**\n * - `feature`: The primary feature under the cursor\n * - `lngLat`: Geographic coordinates of the event\n * - `features`: All features at this location (when multiple overlap)\n *\n * **Key Features:**\n * - Automatic cursor management (pointer on hover)\n * - Smart event handling for overlapping features\n * - Configurable hover delays\n * - Memory-safe cleanup when removing handlers\n *\n * @example\n * ```typescript\n * // POI click handler\n * const pois = map.pois();\n * pois.events.on('click', (feature, lngLat) => {\n *   console.log('Clicked POI:', feature.properties.name);\n *   console.log('Location:', lngLat);\n *   showInfoWindow(feature.properties);\n * });\n *\n * // Route waypoint hover\n * const routing = map.routing();\n * routing.events.waypoints.on('hover', (waypoint) => {\n *   showTooltip(`Waypoint ${waypoint.properties.index}`);\n * });\n *\n * // Long-hover for detailed info\n * pois.events.on('long-hover', (feature) => {\n *   loadAndShowDetailedInfo(feature.properties.id);\n * });\n *\n * // Context menu (right-click)\n * routing.events.mainLines.on('contextmenu', (route, lngLat) => {\n *   showContextMenu(lngLat, [\n *     { label: 'Add waypoint here', action: () => addWaypoint(lngLat) },\n *     { label: 'View route details', action: () => showDetails(route) }\n *   ]);\n * });\n *\n * // Remove all click handlers\n * pois.events.off('click');\n * ```\n *\n * @example\n * ```typescript\n * // Complete interaction example\n * const places = map.places();\n *\n * // Show name on hover\n * places.events.on('hover', (place) => {\n *   tooltip.show(place.properties.name);\n * });\n *\n * // Show details on click\n * places.events.on('click', (place, lngLat) => {\n *   sidebar.show({\n *     title: place.properties.name,\n *     address: place.properties.address.freeformAddress,\n *     coordinates: lngLat\n *   });\n * });\n *\n * // Cleanup on component unmount\n * onUnmount(() => {\n *   places.events.off('hover');\n *   places.events.off('click');\n * });\n * ```\n *\n * @group User Events\n */\nexport class EventsModule<T = MapGeoJSONFeature> {\n    constructor(\n        private readonly eventProxy: EventsProxy,\n        private readonly sourceWithLayers: SourceWithLayers,\n    ) {}\n\n    /**\n     * Register an event handler for user interactions with map features.\n     *\n     * Attaches a callback function that will be invoked when users interact with\n     * features in this module (e.g., clicking on a POI, hovering over a route).\n     *\n     * @param type The type of event to listen for (click, contextmenu, hover, long-hover)\n     * @param handler Callback function invoked when the event occurs\n     *\n     * @remarks\n     * **Handler Parameters:**\n     * - `feature`: The primary feature that triggered the event\n     * - `lngLat`: Geographic coordinates [longitude, latitude] of the event\n     * - `features`: Array of all features at the event location (for overlapping features)\n     *\n     * **Behavior:**\n     * - Only one handler per event type (calling `on()` again replaces the previous handler)\n     * - Handlers are preserved across map style changes\n     * - Cursor automatically changes to pointer on hover\n     * - Events respect module visibility (hidden features don't trigger events)\n     *\n     * **Performance:**\n     * - Hover events use spatial indexing for fast lookup\n     * - Long-hover has configurable delay to prevent accidental triggers\n     * - Event handlers should be lightweight to maintain smooth interaction\n     *\n     * @example\n     * ```typescript\n     * // Basic click handler\n     * module.events.on('click', (feature, lngLat, features) => {\n     *   console.log('Clicked feature:', feature.properties);\n     *   console.log('Location:', lngLat);\n     *   console.log('All features here:', features.length);\n     * });\n     *\n     * // Hover with tooltip\n     * module.events.on('hover', (feature) => {\n     *   const name = feature.properties.name || 'Unnamed';\n     *   tooltip.show(name);\n     * });\n     *\n     * // Long-hover for detailed preview\n     * module.events.on('long-hover', (feature) => {\n     *   // Only triggered after hovering for 300-800ms\n     *   loadPreview(feature.properties.id);\n     * });\n     *\n     * // Right-click context menu\n     * module.events.on('contextmenu', (feature, lngLat) => {\n     *   event.preventDefault(); // Prevent browser context menu\n     *   showCustomMenu(lngLat, feature);\n     * });\n     * ```\n     *\n     * @example\n     * ```typescript\n     * // Route-specific handlers\n     * const routing = map.routing();\n     *\n     * // Handle route line clicks\n     * routing.events.mainLines.on('click', (route) => {\n     *   highlightRoute(route.properties.routeID);\n     *   showRouteSummary(route.properties.summary);\n     * });\n     *\n     * // Handle waypoint interactions\n     * routing.events.waypoints.on('hover', (waypoint) => {\n     *   const index = waypoint.properties.index;\n     *   showTooltip(`Stop ${index + 1}`);\n     * });\n     * ```\n     */\n    on(type: EventType, handler: UserEventHandler<T>) {\n        this.eventProxy.addEventHandler(this.sourceWithLayers, handler, type);\n    }\n\n    /**\n     * Remove all event handlers for a specific event type.\n     *\n     * Unregisters the callback function for the specified event type, stopping\n     * further event notifications. This is important for cleanup to prevent\n     * memory leaks and unwanted behavior.\n     *\n     * @param type The type of event to stop listening for\n     *\n     * @remarks\n     * **Cleanup Behavior:**\n     * - Removes only the specified event type (other types remain active)\n     * - Resets cursor behavior for this module\n     * - Safe to call multiple times (no error if no handler exists)\n     * - Does not affect other modules' event handlers\n     *\n     * **When to Use:**\n     * - Component unmounting/cleanup\n     * - Switching between interaction modes\n     * - Temporarily disabling interactions\n     * - Replacing an existing handler (call `off()` then `on()`)\n     *\n     * **Best Practices:**\n     * - Always clean up event handlers when component unmounts\n     * - Remove handlers before removing features from the map\n     * - Use framework lifecycle hooks for automatic cleanup\n     *\n     * @example\n     * ```typescript\n     * // Remove click handlers\n     * module.events.off('click');\n     *\n     * // Remove all handlers\n     * module.events.off('click');\n     * module.events.off('hover');\n     * module.events.off('long-hover');\n     * module.events.off('contextmenu');\n     * ```\n     *\n     * @example\n     * ```typescript\n     * // React component cleanup\n     * useEffect(() => {\n     *   const pois = map.pois();\n     *\n     *   pois.events.on('click', handlePoiClick);\n     *   pois.events.on('hover', handlePoiHover);\n     *\n     *   return () => {\n     *     // Cleanup on unmount\n     *     pois.events.off('click');\n     *     pois.events.off('hover');\n     *   };\n     * }, [map]);\n     * ```\n     *\n     * @example\n     * ```typescript\n     * // Replace handler\n     * module.events.off('click'); // Remove old handler\n     * module.events.on('click', newHandler); // Add new handler\n     *\n     * // Disable interactions temporarily\n     * const savedHandler = currentHandler;\n     * module.events.off('click'); // Disable\n     * // ... later ...\n     * module.events.on('click', savedHandler); // Re-enable\n     * ```\n     */\n    off(type: EventType) {\n        this.eventProxy.remove(this.sourceWithLayers, type);\n    }\n}\n","import { isEmpty, remove } from 'lodash-es';\nimport type { LayerSpecification, MapGeoJSONFeature } from 'maplibre-gl';\nimport type { EventType, SourcesWithLayers, SourceWithLayers, UserEventHandler } from './types';\n\n// TODO: add support for multiple handlers per source, layers, and event type?\n//  ... (this means multiple handlers for the same module, or repeated \"on\" calls for the same module)\ntype SourceEventTypeHandler = { sourceWithLayers: SourceWithLayers; layerIDs: string[]; fn: UserEventHandler<any> };\n\ntype SourceEventHandlers = Partial<Record<EventType, SourceEventTypeHandler[]>>;\n\n// Source ID to event handlers for that source:\n// Example:\n// const handlers = {\n//     vectorTiles: {\n//         click: [\n//             {\n//                 sourceWithLayers: SourceWithLayers reference,\n//                 layerIDs: [\"Buildings\", \"Roads - Major\"],\n//                 fn: UserEventsHandler...\n//             },\n//             {\n//                 sourceWithLayers: SourceWithLayers reference,\n//                 layerIDs: [\"Water\", \"Landuse - Parks],\n//                 fn: UserEventsHandler...\n//             }\n//         ],\n//         hover: [\n//             {\n//                 sourceWithLayers: SourceWithLayers reference,\n//                 layerIDs: [...],\n//                 fn: UserEventsHandler...\n//              }\n//         ]\n//     },\ntype EventHandlers = Record<string, SourceEventHandlers>;\n\nconst matchesLayers = (layers: LayerSpecification[], layerIDs: string[]): boolean =>\n    layerIDs.every((layerId, index) => layerId === layers[index].id);\n\n/**\n * @ignore\n */\nexport abstract class AbstractEventProxy {\n    protected interactiveLayerIDs: string[] = [];\n    protected handlers: EventHandlers = {};\n\n    /**\n     * Adds the given layers as interactive, so we'll listen to them for hover and click.\n     * @param sourceWithLayers The sources and layers to listen to.\n     */\n    private ensureInteractiveLayerIDsAdded(sourceWithLayers: SourceWithLayers) {\n        sourceWithLayers._layerSpecs.forEach((layerSpec) => {\n            if (!this.interactiveLayerIDs.includes(layerSpec.id)) {\n                this.interactiveLayerIDs.push(layerSpec.id);\n            }\n        });\n    }\n\n    /**\n     * Register an event listener to the list.\n     * @param sourceWithLayers The sources and layers to added.\n     * @param handlerFn Function that will handle the event.\n     * @param type Type of event to listen to.\n     */\n    addEventHandler<T = MapGeoJSONFeature>(\n        sourceWithLayers: SourceWithLayers,\n        handlerFn: UserEventHandler<T>,\n        type: EventType,\n    ) {\n        this.ensureInteractiveLayerIDsAdded(sourceWithLayers);\n        const sourceId = sourceWithLayers.source.id;\n\n        if (!this.handlers[sourceId]) {\n            this.handlers[sourceId] = { [type]: [] };\n        }\n        this.handlers[sourceId][type] ??= [];\n\n        this.handlers[sourceId][type]?.push({\n            sourceWithLayers,\n            layerIDs: sourceWithLayers._layerSpecs.map((layer) => layer.id),\n            fn: handlerFn,\n        });\n    }\n\n    /**\n     * Removes the given sources and layers from the interactive list. When not present, nothing happens.\n     * @param type The event type to be removed.\n     * @param sourceWithLayers The sources and layers to remove, matched by source and layer IDs.\n     */\n    remove(sourceWithLayers: SourceWithLayers, type: EventType) {\n        const sourceEventTypeHandlers = this.handlers[sourceWithLayers.source.id]?.[type];\n        if (sourceEventTypeHandlers) {\n            // @ts-ignore\n            remove(sourceEventTypeHandlers, (handler) => matchesLayers(sourceWithLayers._layerSpecs, handler.layerIDs));\n            // cleaning up empty arrays and objects if necessary:\n            if (!sourceEventTypeHandlers.length) {\n                delete this.handlers[sourceWithLayers.source.id]?.[type];\n                if (isEmpty(this.handlers[sourceWithLayers.source.id])) {\n                    delete this.handlers[sourceWithLayers.source.id];\n                }\n            }\n        }\n        for (const layer of sourceWithLayers._layerSpecs) {\n            // @ts-ignore\n            remove(this.interactiveLayerIDs, (id) => layer.id === id);\n        }\n    }\n\n    /**\n     * Removes all interactive sources and layers.\n     */\n    removeAll() {\n        this.interactiveLayerIDs = [];\n        this.handlers = {};\n    }\n\n    /**\n     * Returns whether this source is registered for events (has handlers attached).\n     * @param sourceId The source id (should be linked to a SourceWithLayers instance).\n     */\n    hasSourceID(sourceId: string): boolean {\n        return !!this.handlers[sourceId];\n    }\n\n    /**\n     * Updates the given sourcesWithLayers, if they have any handlers.\n     * * (This is typically called to refresh any registered, stale sourceWithLayers references after a map style has changed).\n     * @param sourcesWithLayers The new sources with layers to replace existing ones.\n     */\n    updateIfRegistered(sourcesWithLayers: SourcesWithLayers): void {\n        for (const sourceWithLayers of Object.values(sourcesWithLayers)) {\n            const sourceHandlers = this.handlers[sourceWithLayers.source.id];\n            if (sourceHandlers) {\n                for (const sourceEventTypeHandlers of Object.values(sourceHandlers)) {\n                    for (const handler of sourceEventTypeHandlers) {\n                        if (sourceWithLayers.equalSourceAndLayerIDs(handler.sourceWithLayers)) {\n                            // We keep the reference fresh:\n                            handler.sourceWithLayers = sourceWithLayers;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    protected findHandlers = (\n        types: EventType[],\n        sourceId: string | undefined,\n        layerId: string | undefined,\n    ): SourceEventTypeHandler[] =>\n        (sourceId &&\n            layerId &&\n            types.flatMap((type) => {\n                const sourceEventTypeHandlers = this.handlers[sourceId]?.[type];\n                return sourceEventTypeHandlers?.length === 1\n                    ? // if there's only handler for that source and type, we just return it, no need to match layers:\n                      sourceEventTypeHandlers\n                    : this.handlers[sourceId]?.[type]?.filter((handler) => handler.layerIDs.includes(layerId)) || [];\n            })) ||\n        [];\n}\n","import type { Feature } from 'geojson';\nimport { isNil, omit } from 'lodash-es';\nimport type { MapGeoJSONFeature, Point2D } from 'maplibre-gl';\nimport { areBothDefinedAndEqual } from './mapUtils';\nimport { GeoJSONSourceWithLayers } from './SourceWithLayers';\nimport type { EventType, SourceWithLayers } from './types';\n\ntype IndexedFeature<F extends Feature = Feature> = { feature: F; index: number };\n\nconst findFeatureById = (features: Feature[], id: string | number | undefined): IndexedFeature | undefined => {\n    for (let i = 0; i < features.length; i++) {\n        const feature = features[i];\n        if (feature.id === id) {\n            return { feature, index: i };\n        }\n    }\n    return undefined;\n};\n\nconst isHighPriority = (eventType: EventType): boolean => eventType === 'click' || eventType === 'contextmenu';\n\n/**\n * Puts or removes the given event state to the right feature in featuresToUpdate based on the\n * @param eventState The new event state to apply or to use as reference.\n * @param featureID The ID of the feature to update within featuresToUpdate.\n * @param featuresToUpdate The features list which will be updated.\n * @param mode If updateInProps, replaces the existing eventState. If removeFromProps, removes the existing eventState.\n * @return The index of the updated feature in the mutated featuresToUpdate array.\n * @ignore\n */\nexport const putEventState = (\n    eventState: EventType,\n    featureId: string | number | undefined,\n    featuresToUpdate: Feature[], // \"featuresToUpdate\" will be mutated\n    mode: 'updateInProps' | 'removeFromProps' = 'updateInProps',\n): number | undefined => {\n    const { feature, index } = findFeatureById(featuresToUpdate, featureId) || {};\n    if (feature && (!isHighPriority(feature.properties?.eventState) || isHighPriority(eventState))) {\n        const updatedFeature = {\n            ...feature,\n            properties:\n                mode === 'updateInProps'\n                    ? { ...feature?.properties, eventState }\n                    : omit(feature?.properties, 'eventState'),\n        };\n        featuresToUpdate.splice(index as number, 1, updatedFeature);\n        return index;\n    }\n    return undefined;\n};\n\nconst removeEventStateAndShow = (\n    newEventType: EventType,\n    rawFeature: MapGeoJSONFeature,\n    sourceWithLayers: GeoJSONSourceWithLayers,\n): void => {\n    const prevFeaturesToUpdate = [...sourceWithLayers.shownFeatures.features];\n    const updatedIndex = putEventState(newEventType, rawFeature.id, prevFeaturesToUpdate, 'removeFromProps');\n    if (!isNil(updatedIndex)) {\n        sourceWithLayers.show({ ...sourceWithLayers.shownFeatures, features: prevFeaturesToUpdate });\n    }\n};\n\n/**\n * Updates the event state props of the given features.\n * @param eventState The type of event that is being done or undone.\n * @param eventFeature The current MapLibre feature affected by the event, if any.\n * If undefined, it means the event is being undone from prevRawFeature without going to any other one.\n * @param prevEventFeature The previous MapLibre feature affected by the event type, if any (e.g. previous one clicked or hovered).\n * @param sourceWithLayers The source with layers of eventFeature, if any.\n * @param prevSourceWithLayers The source with layers of prevEventFeature, if any.\n * @ignore\n */\nexport const updateEventState = (\n    eventState: EventType,\n    eventFeature: MapGeoJSONFeature | undefined,\n    prevEventFeature: MapGeoJSONFeature | undefined,\n    sourceWithLayers: SourceWithLayers | undefined,\n    prevSourceWithLayers: SourceWithLayers | undefined,\n): Partial<IndexedFeature> => {\n    if (eventFeature && sourceWithLayers instanceof GeoJSONSourceWithLayers) {\n        const featuresToUpdate = [...sourceWithLayers.shownFeatures.features];\n        const updatedIndex = putEventState(eventState, eventFeature.id, featuresToUpdate) as number;\n\n        if (prevEventFeature && !areBothDefinedAndEqual(prevEventFeature, eventFeature)) {\n            // (we have both current and prev features for this event type)\n            if (prevSourceWithLayers === sourceWithLayers) {\n                // we undo the event state from prev feature next to the new one (they will be shown below):\n                putEventState(eventState, prevEventFeature.id, featuresToUpdate, 'removeFromProps');\n            } else if (prevSourceWithLayers instanceof GeoJSONSourceWithLayers) {\n                // the prev feature is in other source/layers, so we update and show them:\n                removeEventStateAndShow(eventState, prevEventFeature, prevSourceWithLayers);\n            }\n        }\n\n        sourceWithLayers.show({\n            ...sourceWithLayers.shownFeatures,\n            features: featuresToUpdate,\n        });\n\n        return { feature: featuresToUpdate[updatedIndex], index: updatedIndex };\n    }\n    if (prevEventFeature && prevSourceWithLayers instanceof GeoJSONSourceWithLayers) {\n        removeEventStateAndShow(eventState, prevEventFeature, prevSourceWithLayers);\n    }\n    return { feature: eventFeature };\n};\n\n/**\n * Detects whether there's been a hovering change with the given event and state params.\n * @param hoveringPoint The current hovering pixel coordinates.\n * @param hoveringFeature The current feature being hovered, if any.\n * @param prevHoveredPoint The pixel coordinates from the previous hovering event, if any.\n * @param prevHoveredFeature The previous feature being hovered, if any (could be the same as hoveringFeature).\n * @ignore\n */\nexport const detectHoverState = (\n    hoveringPoint: Point2D,\n    hoveringFeature: MapGeoJSONFeature | undefined,\n    prevHoveredPoint: Point2D | undefined,\n    prevHoveredFeature: MapGeoJSONFeature | undefined,\n): {\n    /**\n     * Whether a hover state change happened, such as no-hover -> hover or vice-versa.\n     */\n    hoverChanged?: boolean;\n    /**\n     * Whether the mouse is moving along the hovered feature (not stopped on it).\n     */\n    mouseInMotionOverHoveredFeature?: boolean;\n} => {\n    if (hoveringFeature) {\n        if (!prevHoveredFeature) {\n            return { hoverChanged: true };\n        }\n        if (\n            (hoveringFeature.id && hoveringFeature.id !== prevHoveredFeature.id) ||\n            (hoveringFeature.properties.id && hoveringFeature.properties.id !== prevHoveredFeature.properties.id) ||\n            hoveringFeature.source !== prevHoveredFeature.source ||\n            // comparing by layer ID is needed when two id-less features from the same source but different layers are compared\n            // this can happen when e.g. hovering over different layer groups for the base map\n            hoveringFeature.layer.id !== prevHoveredFeature.layer.id\n        ) {\n            // hovering from one feature to another one (from the same or different layer/source):\n            return { hoverChanged: true };\n        }\n        // (else we're hovering along the same feature)\n        if (\n            prevHoveredPoint &&\n            (hoveringPoint.x - prevHoveredPoint.x != 0 || hoveringPoint.y - prevHoveredPoint.y != 0)\n        ) {\n            return { mouseInMotionOverHoveredFeature: true };\n        }\n    } else if (prevHoveredFeature) {\n        return { hoverChanged: true };\n    }\n    return {};\n};\n","import type { LngLat, Map, MapGeoJSONFeature, MapMouseEvent, Point2D, PointLike } from 'maplibre-gl';\nimport type { MapEventsConfig } from '../init';\nimport { AbstractEventProxy } from './AbstractEventProxy';\nimport { detectHoverState, updateEventState } from './eventUtils';\nimport { deserializeFeatures } from './mapUtils';\nimport type { ClickEventType, SourceWithLayers } from './types';\n\n// Default values for events\nconst eventsProxyDefaultConfig: Required<MapEventsConfig> = {\n    precisionMode: 'box',\n    paddingBoxPx: 5,\n    cursorOnHover: 'pointer',\n    cursorOnMouseDown: 'grabbing',\n    cursorOnMap: 'default',\n    /**\n     * Delayed hover control:\n     * * The first hover we do after the map moves is longer\n     */\n    longHoverDelayAfterMapMoveMS: 800,\n    /* Followup hovers with the same non-moving map are quicker (\"hovering around mode\") */\n    longHoverDelayOnStillMapMS: 300,\n};\n\n/**\n * This is the place where we handle the user events on the map (mousemove/hover and click mostly).\n * To have full control on hovers and clicks when multiple overlapping layers are present, that logic must be centralized here.\n * @ignore\n */\nexport class EventsProxy extends AbstractEventProxy {\n    private readonly map: Map;\n    private readonly mapCanvas: HTMLCanvasElement;\n    private enabled = true;\n    private hoveringLngLat?: LngLat;\n    private hoveringPoint?: Point2D;\n    private hoveringFeature?: MapGeoJSONFeature;\n    private hoveringFeatures?: MapGeoJSONFeature[];\n    private hoveringSourceWithLayers?: SourceWithLayers;\n    private longHoverTimeoutHandlerID?: number;\n    // Control flag to indicate that the coming hover is the first one since the map is \"quiet\" again:\n    private firstDelayedHoverSinceMapMove = true;\n    private lastClickedFeature?: MapGeoJSONFeature;\n    private lastClickedSourceWithLayers?: SourceWithLayers;\n    private lastCursorStyle: string;\n    // Configuration\n    private readonly config: Required<MapEventsConfig>;\n    private readonly defaultZoomLevel: number;\n\n    constructor(map: Map, config: MapEventsConfig = {}) {\n        super();\n        this.map = map;\n        this.mapCanvas = map.getCanvas();\n        this.config = { ...eventsProxyDefaultConfig, ...config };\n        this.mapCanvas.style.cursor = this.config.cursorOnMap;\n        this.lastCursorStyle = this.config.cursorOnMap;\n        this.defaultZoomLevel = Math.round(this.map.getZoom());\n        this.listenToEvents();\n    }\n\n    private listenToEvents() {\n        this.map.on('mousemove', (ev) => this.onMouseMove(ev));\n        this.map.on('movestart', () => this.onMouseStart());\n        this.map.on('mouseout', () => this.onMouseOut());\n        this.map.on('mouseover', (ev) => this.onMouseMove(ev));\n        this.map.on('mousedown', () => this.onMouseDown());\n        this.map.on('mouseup', () => this.onMouseUp());\n        this.map.on('click', (ev) => this.onMapClick('click', ev));\n        this.map.on('contextmenu', (ev) => this.onMapClick('contextmenu', ev));\n    }\n\n    // Enable/Disable Events\n    public enable(enabled: boolean) {\n        this.enabled = enabled;\n        if (!enabled) {\n            this.clearLongHoverTimeout();\n        }\n    }\n\n    private toPaddedBounds(point: Point2D): [[number, number], [number, number]] {\n        const padding = this.config.paddingBoxPx;\n        return [\n            // sw:\n            [point.x - padding, point.y + padding],\n            // ne:\n            [point.x + padding, point.y - padding],\n        ];\n    }\n\n    private isEnabled() {\n        return this.enabled && !this.map.isMoving();\n    }\n\n    private getRenderedFeatures(point: Point2D): MapGeoJSONFeature[] {\n        const options = { layers: this.interactiveLayerIDs, validate: false };\n        const precision = this.config.precisionMode;\n        // first attempt right in the given coordinates:\n        const renderedFeatures =\n            precision === 'point-then-box' || precision === 'point'\n                ? this.map.queryRenderedFeatures(point as PointLike, options)\n                : [];\n        return renderedFeatures.length || precision === 'point'\n            ? renderedFeatures\n            : // second attempt using padded bounds (trying to hit something slightly further from the pointer location)\n              this.map.queryRenderedFeatures(this.toPaddedBounds(point), options);\n    }\n\n    private clearLongHoverTimeout() {\n        window.clearTimeout(this.longHoverTimeoutHandlerID);\n    }\n\n    private restartLongHoverTimeout() {\n        this.clearLongHoverTimeout();\n        this.longHoverTimeoutHandlerID = window.setTimeout(\n            () => this.handleLongHoverTimeout(),\n            this.firstDelayedHoverSinceMapMove\n                ? this.config.longHoverDelayAfterMapMoveMS\n                : this.config.longHoverDelayOnStillMapMS,\n        );\n    }\n\n    private handleLongHoverTimeout() {\n        // We avoid firing long hovers when the feature is in clicked state:\n        this.firstDelayedHoverSinceMapMove = false;\n\n        if (this.hoveringSourceWithLayers) {\n            const eventState = updateEventState(\n                'long-hover',\n                this.hoveringFeature,\n                undefined,\n                this.hoveringSourceWithLayers,\n                undefined,\n            );\n\n            this.findHandlers(['long-hover'], this.hoveringFeature?.source, this.hoveringFeature?.layer.id).forEach(\n                (handler) =>\n                    handler.fn(\n                        eventState.feature,\n                        this.hoveringLngLat as LngLat,\n                        this.hoveringFeatures as MapGeoJSONFeature[],\n                        this.hoveringSourceWithLayers as SourceWithLayers,\n                    ),\n            );\n        }\n    }\n\n    private onMouseStart() {\n        this.firstDelayedHoverSinceMapMove = true;\n        this.clearLongHoverTimeout();\n    }\n\n    private onMouseOut() {\n        // Preventing accidental de-hover event if we actually leave the map canvas.\n        // Since this could potentially be about jumping into a map popup, so we leave that up to the caller.\n        this.clearLongHoverTimeout();\n    }\n\n    private onMouseDown() {\n        this.lastCursorStyle = this.mapCanvas.style.cursor;\n        this.mapCanvas.style.cursor = this.config.cursorOnMouseDown;\n    }\n\n    private onMouseUp() {\n        this.mapCanvas.style.cursor = this.lastCursorStyle;\n    }\n\n    private onMouseMove(ev: MapMouseEvent) {\n        if (!this.isEnabled()) {\n            // We ensure no unwanted hover handling while disabled or the map moves\n            return;\n        }\n\n        this.hoveringFeatures = this.getRenderedFeatures(ev.point);\n        deserializeFeatures(this.hoveringFeatures);\n        const [hoveredTopFeature] = this.hoveringFeatures;\n\n        // Check if the layer has any handlers registered.\n        // Since hover is the \"lowest\" event type, having a handler for any event type justifies supporting hover state.\n        // However, we'll only fire the hover events if there are handlers for hover specifically.\n        if (hoveredTopFeature && !this.hasSourceID(hoveredTopFeature.source)) {\n            return;\n        }\n\n        // hoverChangeDetected: whether a change happened, such as no-hover -> hover or vice versa:\n        // mouseInMotionOverHoveredFeature: whether the mouse is moving along the hovered feature (not stopped on it):\n        const { hoverChanged, mouseInMotionOverHoveredFeature } = detectHoverState(\n            ev.point,\n            hoveredTopFeature,\n            this.hoveringPoint,\n            this.hoveringFeature,\n        );\n\n        if (hoverChanged || mouseInMotionOverHoveredFeature) {\n            this.hoveringLngLat = ev.lngLat;\n            this.hoveringPoint = ev.point;\n            const prevHoveredFeature = this.hoveringFeature;\n            this.hoveringFeature = hoveredTopFeature;\n            const prevHoveredSourceWithLayers = this.hoveringSourceWithLayers;\n\n            // Hovering basic event states are still processed if any other handlers are registered for that source/layers.\n            // We do so because basic hovering states indicate a feature is interactive.\n            // (e.g. if there's a click handler, we'll still apply basic hover states, even if we don't fire hover events)\n            const allHandlers = this.findHandlers(\n                ['hover', 'long-hover', 'click', 'contextmenu'],\n                hoveredTopFeature?.source,\n                hoveredTopFeature?.layer.id,\n            );\n\n            // NOTE: handlers overlapping in source and layer IDs won't be supported properly:\n            this.hoveringSourceWithLayers = allHandlers?.[0]?.sourceWithLayers;\n\n            if (hoverChanged) {\n                this.updateCursor(prevHoveredFeature);\n\n                const eventState = updateEventState(\n                    'hover',\n                    this.hoveringFeature,\n                    prevHoveredFeature,\n                    this.hoveringSourceWithLayers,\n                    prevHoveredSourceWithLayers,\n                );\n\n                const hoverHandlers = this.findHandlers(\n                    ['hover'],\n                    hoveredTopFeature?.source,\n                    hoveredTopFeature?.layer.id,\n                );\n\n                for (const handler of hoverHandlers) {\n                    handler.fn(eventState.feature, ev.lngLat, this.hoveringFeatures, this.hoveringSourceWithLayers);\n                }\n            }\n\n            this.restartLongHoverTimeout();\n        }\n    }\n\n    private updateCursor(prevHoveredFeature: MapGeoJSONFeature | undefined) {\n        if (!prevHoveredFeature && this.hoveringFeature) {\n            // no hover -> hover\n            this.mapCanvas.style.cursor = this.config.cursorOnHover;\n        } else if (prevHoveredFeature && !this.hoveringFeature) {\n            // hover -> no hover (un-hover)\n            this.mapCanvas.style.cursor = this.config.cursorOnMap;\n        }\n    }\n\n    private onMapClick(clickType: ClickEventType, ev: MapMouseEvent) {\n        if (!this.isEnabled()) {\n            // We avoid any accidental click handling while disabled or the map moves\n            return;\n        }\n\n        const clickedFeatures = this.getRenderedFeatures(ev.point);\n        // Deserialize Features from maplibre queryRenderedFeatures response\n        deserializeFeatures(clickedFeatures);\n\n        const prevClickedFeature = this.lastClickedFeature;\n        this.lastClickedFeature = clickedFeatures[0];\n        const prevClickedSourceWithLayers = this.lastClickedSourceWithLayers;\n        const clickHandlers = this.findHandlers(\n            [clickType],\n            this.lastClickedFeature?.source,\n            this.lastClickedFeature?.layer.id,\n        );\n\n        // NOTE: handlers overlapping in source and layer IDs won't be supported properly:\n        this.lastClickedSourceWithLayers = clickHandlers?.[0]?.sourceWithLayers;\n\n        const eventState = updateEventState(\n            clickType,\n            this.lastClickedFeature,\n            prevClickedFeature,\n            this.lastClickedSourceWithLayers,\n            prevClickedSourceWithLayers,\n        );\n\n        for (const handler of clickHandlers) {\n            handler.fn(eventState.feature, ev.lngLat, clickedFeatures, this.lastClickedSourceWithLayers);\n        }\n    }\n}\n","/**\n * Key layer IDs from the vector map style for positioning custom layers.\n *\n * @remarks\n * This constant provides reference layer IDs from TomTom's vector map styles that are used\n * as anchors when positioning custom layers in the map's layer stack. By referencing these\n * layer IDs, SDK modules and custom implementations can control where their layers appear\n * in the rendering order (visual stacking).\n *\n * **Understanding Layer Order:**\n *\n * \"Lowest\" refers to position in the layer stack, not physical elevation. Layers are rendered\n * from bottom to top - layers lower in the stack are drawn first and appear underneath layers\n * higher in the stack. When you add a layer \"before\" a reference layer, it's inserted lower\n * in the stack and will be drawn underneath that reference layer.\n *\n * **How SDK Modules Use These IDs:**\n *\n * **RoutingModule** - Positions route visualizations below labels for readability:\n * ```typescript\n * // Routes appear below labels but above the base map\n * const routing = await RoutingModule.get(map);\n * // Uses mapStyleLayerIDs.lowestLabel by default\n * ```\n *\n * **GeometriesModule** - Configurable layer positioning for polygon areas:\n * ```typescript\n * // Default: below labels\n * const geometries = await GeometriesModule.get(map);\n *\n * // Custom: below buildings to show at ground level\n * const geometries = await GeometriesModule.get(map, {\n *   beforeLayerConfig: 'lowestBuilding'\n * });\n *\n * // On top of everything\n * const geometries = await GeometriesModule.get(map, {\n *   beforeLayerConfig: 'top'\n * });\n * ```\n *\n * **Custom Layer Implementation:**\n * ```typescript\n * // Add a highlight layer below labels\n * map.addLayer({\n *   id: 'search-results',\n *   type: 'fill',\n *   source: 'results-source',\n *   paint: { 'fill-color': '#ffcc00', 'fill-opacity': 0.4 }\n * }, mapStyleLayerIDs.lowestLabel);\n * ```\n *\n * **Style Persistence:**\n *\n * These layer IDs remain consistent across TomTom map style changes (e.g., switching from\n * 'standardLight' to 'standardDark'). The SDK automatically repositions module layers using\n * the corresponding reference layers in the new style, maintaining the intended visual hierarchy.\n *\n * **Important Notes:**\n * - `lowestBuilding` is not available in the Satellite style\n * - If a reference layer doesn't exist, custom layers will be added on top of the style\n * - Both RoutingModule and GeometriesModule default to `lowestLabel` for optimal visibility\n *\n * @see {@link GeometryBeforeLayerConfig} for GeometriesModule layer positioning options\n * @see {@link RouteLayersConfig} for RoutingModule layer configuration\n *\n * @group Map Style\n */\nexport const mapStyleLayerIDs = {\n    /**\n     * Country name label layer.\n     *\n     * @remarks\n     * Lower in the stack than most labels. Use to position elements below country\n     * labels but above other map features.\n     */\n    country: 'Places - Country name',\n    /**\n     * The lowest layer for place labels.\n     *\n     * @remarks\n     * Lower in the stack than city labels. Use to position content below all place\n     * name labels while keeping it visible above geographic features.\n     */\n    lowestPlaceLabel: 'Places - Village / Hamlet',\n    /**\n     * Points of Interest layer.\n     *\n     * @remarks\n     * Use to position custom content in the layer stack relative to POI icons and labels.\n     */\n    poi: 'POI',\n    /**\n     * The lowest labels layer in the stack.\n     *\n     * @remarks\n     * **Most commonly used reference layer.** Positioning layers before this ensures\n     * content appears below all text labels, maintaining map readability while keeping\n     * visualizations prominent.\n     *\n     * **Default for SDK modules:**\n     * - RoutingModule uses this for route lines and waypoints\n     * - GeometriesModule uses this as the default for polygon fills and borders\n     *\n     * This provides optimal balance between visibility and not obscuring map labels.\n     */\n    lowestLabel: 'Borders - Treaty label',\n    /**\n     * The lowest road line layer in the stack.\n     *\n     * @remarks\n     * Represents tunnel railway outlines. Use to position content below the road network,\n     * useful for showing base layers or features that should appear beneath transportation\n     * infrastructure.\n     */\n    lowestRoadLine: 'Tunnel - Railway outline',\n    /**\n     * The lowest building layer in the stack.\n     *\n     * @remarks\n     * Use to position content below 3D building extrusions while keeping it above\n     * flat map features like roads and terrain.\n     *\n     * **Note:** Not available in the Satellite style.\n     */\n    lowestBuilding: 'Buildings - Underground',\n} as const;\n","/**\n * Source identifier for POI (Point of Interest) vector tiles.\n *\n * @remarks\n * Used to reference the POI layer in the map style, which contains\n * business locations, landmarks, and other points of interest.\n *\n * @group POIs\n */\nexport const POI_SOURCE_ID = 'vectorTiles';\n\n/**\n * Source identifier for hillshade terrain visualization.\n *\n * @remarks\n * References the raster source that provides terrain shading to visualize\n * elevation and topography on the map.\n *\n * @group Hillshade\n */\nexport const HILLSHADE_SOURCE_ID = 'hillshade';\n\n/**\n * Source identifier prefix for places (geocoding results) features.\n *\n * @remarks\n * Combined with a unique identifier to create source IDs for place markers\n * displayed via the Places module.\n *\n * @group Places\n */\nexport const PLACES_SOURCE_PREFIX_ID = 'places';\n\n/**\n * Source identifier for base map vector tiles.\n *\n * @remarks\n * References the primary vector tile source containing roads, buildings,\n * land use, water bodies, and other fundamental map features.\n *\n * @group Base Map\n */\nexport const BASE_MAP_SOURCE_ID = 'vectorTiles';\n\n/**\n * Source identifier for traffic incidents vector tiles.\n *\n * @remarks\n * References the vector tile source containing real-time traffic incident data\n * such as accidents, road closures, and construction.\n *\n * @group Traffic Incidents\n */\nexport const TRAFFIC_INCIDENTS_SOURCE_ID = 'vectorTilesIncidents';\n\n/**\n * Source identifier for traffic flow vector tiles.\n *\n * @remarks\n * References the vector tile source containing real-time traffic flow data\n * showing current traffic speeds and congestion levels.\n *\n * @group Traffic Flow\n */\nexport const TRAFFIC_FLOW_SOURCE_ID = 'vectorTilesFlow';\n","/**\n * Layer IDs for POIs on the map.\n * @ignore\n */\nexport const poiLayerIDs = ['POI', 'POI - Micro'];\n","import type { POICategory } from '@tomtom-org/maps-sdk/core';\n\n/**\n * @ignore\n */\nconst mapDisplayPoiCategoryMappings: Partial<Record<POICategory, string>> = {\n    ACCESS_GATEWAY: 'access_gateway',\n    ADVENTURE_SPORTS_FACILITY: 'adventure_sports_facility',\n    ADVENTURE_SPORTS_VENUE: 'adventure_sports_venue',\n    AGRICULTURE: 'agriculture_business',\n    AIRPORT: 'airport',\n    AMUSEMENT_PARK: 'amusement_park',\n    AQUATIC_ZOO: 'zoo_or_aquarium',\n    ASHRAM: 'religious_site',\n    ATM: 'atm',\n    AUTOMOTIVE_DEALER: 'automotive_dealer',\n    BANK: 'bank',\n    BEACH: 'beach',\n    BUS_STOP: 'bus_station',\n    BUSINESS_PARK: 'business_park',\n    CAFE_PUB: 'cafe',\n    CAMPING_GROUND: 'camping_ground',\n    CAR_WASH: 'car_wash',\n    CASH_DISPENSER: 'atm',\n    CASINO: 'casino',\n    CLOTHING_SHOP: 'clothing_shop',\n    CHURCH: 'religious_site',\n    CINEMA: 'cinema',\n    CLUB_ASSOCIATION: 'club_and_association',\n    COLLEGE_UNIVERSITY: 'college_or_university',\n    COMMERCIAL_BUILDING: 'commercial_building',\n    COMMUNITY_CENTER: 'community_center',\n    COMPANY: 'company_or_office',\n    CONCERT_HALL: 'nightlife',\n    COURTHOUSE: 'courthouse',\n    CULTURAL_CENTER: 'cultural_center',\n    DENTIST: 'dentist',\n    DEPARTMENT_STORE: 'department_store',\n    DOCTOR: 'doctor',\n    ELECTRIC_VEHICLE_STATION: 'charging_location',\n    EMBASSY: 'institution_office',\n    EMERGENCY_MEDICAL_SERVICE: 'emergency_medical_service',\n    EMERGENCY_ROOM: 'emergency_room',\n    ENTERTAINMENT: 'entertainment',\n    EXCHANGE: 'stock_exchange',\n    EXHIBITION_CONVENTION_CENTER: 'cultural_center',\n    FERRY_TERMINAL: 'ferry_terminal',\n    FIRE_STATION_BRIGADE: 'fire_station',\n    FRONTIER_CROSSING: 'frontier_crossing',\n    FUEL_FACILITIES: 'fuel_station',\n    GAS_STATION: 'fuel_station',\n    GEOGRAPHIC_FEATURE: 'geographic_feature',\n    GOLD_EXCHANGE: 'gold_exchange',\n    GOLF_COURSE: 'golf_course',\n    GOVERNMENT_OFFICE: 'institution_office',\n    GURUDWARA: 'religious_site',\n    HEALTH_CARE_SERVICE: 'healthcare_service',\n    HELIPAD_HELICOPTER_LANDING: 'heliport_or_helipad',\n    HILL: 'elevation_point',\n    HOLIDAY_RENTAL: 'holiday_home',\n    HOSPITAL: 'hospital',\n    HOSPITAL_POLYCLINIC: 'hospital',\n    HOTEL_MOTEL: 'hotel_or_motel',\n    ICE_SKATING_RINK: 'ice_skating_rink',\n    IMPORTANT_TOURIST_ATTRACTION: 'tourist_attraction',\n    INDUSTRIAL_BUILDING: 'industrial_building',\n    LEISURE_CENTER: 'leisure_center',\n    LIBRARY: 'library',\n    MANUFACTURING_FACILITY: 'manufacturing_facility',\n    MARINA: 'marina',\n    MARKET: 'marketplace',\n    MEDIA_FACILITY: 'media_facility',\n    MILITARY_INSTALLATION: 'military_facility',\n    MOSQUE: 'religious_site',\n    MOTORING_ORGANIZATION_OFFICE: 'motoring_organization_office',\n    MOUNTAIN_PASS: 'mountain_pass',\n    MOUNTAIN_PEAK: 'elevation_point',\n    MOVIE_THEATER: 'cinema',\n    MUSEUM: 'museum',\n    NATIVE_RESERVATION: 'native_reservation',\n    NIGHTLIFE: 'nightlife',\n    NON_GOVERNMENTAL_ORGANIZATION: 'non_governmental_organization',\n    OPEN_PARKING_AREA: 'parking_facility',\n    OPERA_HOUSE: 'theater',\n    PAGODA: 'religious_site',\n    PARK_RECREATION_AREA: 'park_and_recreation_area',\n    PARKING_GARAGE: 'parking_facility',\n    PETROL_STATION: 'fuel_station',\n    PHARMACY: 'pharmacy',\n    PLACE_OF_WORSHIP: 'place_of_worship',\n    POLICE_STATION: 'police_station',\n    PORT_WAREHOUSE_FACILITY: 'port_or_warehouse_facility',\n    POST_OFFICE: 'post_office',\n    PRIMARY_RESOURCE_UTILITY: 'primary_resource_or_utility',\n    PRISON_CORRECTIONAL_FACILITY: 'prison',\n    PUBLIC_AMENITY: 'public_amenity',\n    PUBLIC_TRANSPORT_STOP: 'public_transport_stop',\n    RAILWAY_STATION: 'railway_station',\n    RENT_A_CAR_FACILITY: 'car_rental',\n    RENT_A_CAR_PARKING: 'rent_a_car_parking',\n    REPAIR_FACILITY: 'repair_facility',\n    RESEARCH_FACILITY: 'research_facility',\n    RESIDENTIAL_ACCOMMODATION: 'urban_ground',\n    REST_AREA: 'rest_area',\n    RESTAURANT: 'restaurant',\n    RESTAURANT_AREA: 'restaurant_area',\n    SCENIC_PANORAMIC_VIEW: 'viewpoint',\n    SCHOOL: 'school',\n    SHOP: 'shop_or_store',\n    SHOPPING_CENTER: 'shop_or_store',\n    SPORTS_CENTER: 'sport_facility',\n    STADIUM: 'stadium',\n    SUPERMARKETS_HYPERMARKETS: 'supermarket',\n    SWIMMING_POOL: 'swimming_pool',\n    SYNAGOG: 'religious_site',\n    TAXI_STAND: 'taxi_stand',\n    TEMPLE: 'religious_site',\n    TENNIS_COURT: 'tennis_court',\n    THEATER: 'theater',\n    TOLL_GATE: 'toll_gate',\n    TOURIST_INFORMATION_OFFICE: 'tourist_information_office',\n    TRAFFIC_CONTROL_DEPARTMENT: 'traffic_control_department',\n    TRAFFIC_SERVICE_CENTER: 'traffic_service_center',\n    TRAIL_SYSTEM: 'trail_system',\n    TRAILS: 'trails',\n    TRANSPORT_AUTHORITY_VEHICLE_REGISTRATION: 'transport_authority_or_vehicle_registration',\n    TRUCK_STOP: 'truck_stop',\n    VACATION_RENTAL: 'vacation_rental',\n    VETERINARIAN: 'veterinarian',\n    WATER_SPORT: 'water_sport',\n    WEIGH_STATION: 'weigh_station',\n    WELFARE_ORGANIZATION: 'welfare_organization',\n    WINERY: 'manufacturing_facility',\n    ZOOS_ARBORETA_BOTANICAL_GARDEN: 'zoo_or_aquarium',\n};\n\n/**\n * Map style POI category type.\n *\n * @remarks\n * Represents all available POI (Point of Interest) categories used in the map style.\n * These categories correspond to Search API classification codes and are used for\n * filtering, styling, and displaying POI icons on the map.\n *\n * Each category maps to a specific icon sprite and can be used with custom icon configurations.\n *\n * @example\n * ```ts\n * const category: MapStylePOICategory = 'RESTAURANT';\n * ```\n *\n * @see {@link POICategoryGroup} - For grouped collections of related categories\n *\n * @group POIs\n */\nexport type MapStylePOICategory = keyof typeof mapDisplayPoiCategoryMappings;\n\n/**\n * @ignore\n */\nexport const toMapDisplayPOICategory = (category: POICategory): string =>\n    // if it's one of the different categories between search and poi layer, use poi layer category\n    category in mapDisplayPoiCategoryMappings\n        ? (mapDisplayPoiCategoryMappings[category] as string)\n        : category.toLowerCase();\n","import type { ExpressionSpecification } from 'maplibre-gl';\n\n/**\n * Bold font face used in the TomTom map style.\n *\n * @remarks\n * This is the primary bold font used for prominent labels and headings in the map.\n * Use this constant when creating custom layers to maintain visual consistency with the map style.\n *\n * @example\n * ```typescript\n * import { MAP_BOLD_FONT } from '@tomtom-international/maps-sdk-js/map';\n *\n * const textLayer = {\n *   type: 'symbol',\n *   layout: {\n *     'text-font': [MAP_BOLD_FONT],\n *     'text-field': ['get', 'name']\n *   }\n * };\n * ```\n *\n * @group Map Style\n */\nexport const MAP_BOLD_FONT = 'Noto-Bold';\n\n/**\n * Regular font face used in the TomTom map style.\n *\n * @remarks\n * This is the standard font used for most text labels on the map.\n * Use this constant when creating custom layers to maintain visual consistency with the map style.\n *\n * @example\n * ```typescript\n * import { MAP_REGULAR_FONT } from '@tomtom-international/maps-sdk-js/map';\n *\n * const textLayer = {\n *   type: 'symbol',\n *   layout: {\n *     'text-font': [MAP_REGULAR_FONT],\n *     'text-field': ['get', 'description']\n *   }\n * };\n * ```\n *\n * @group Map Style\n */\nexport const MAP_REGULAR_FONT = 'Noto-Regular';\n\n/**\n * Medium weight font face used in the TomTom map style.\n *\n * @remarks\n * This font provides a middle ground between regular and bold weights.\n * Use this constant when creating custom layers to maintain visual consistency with the map style.\n *\n * @example\n * ```typescript\n * import { MAP_MEDIUM_FONT } from '@tomtom-international/maps-sdk-js/map';\n *\n * const textLayer = {\n *   type: 'symbol',\n *   layout: {\n *     'text-font': [MAP_MEDIUM_FONT],\n *     'text-field': ['get', 'title']\n *   }\n * };\n * ```\n *\n * @group Map Style\n */\nexport const MAP_MEDIUM_FONT = 'Noto-Medium';\n\n/**\n * Italic font face used in the TomTom map style.\n *\n * @remarks\n * This is the italic variant used for emphasized or secondary text labels.\n * Use this constant when creating custom layers to maintain visual consistency with the map style.\n *\n * @example\n * ```typescript\n * import { MAP_ITALIC_FONT } from '@tomtom-international/maps-sdk-js/map';\n *\n * const textLayer = {\n *   type: 'symbol',\n *   layout: {\n *     'text-font': [MAP_ITALIC_FONT],\n *     'text-field': ['get', 'subtitle']\n *   }\n * };\n * ```\n *\n * @group Map Style\n */\nexport const MAP_ITALIC_FONT = 'NotoSans-MediumItalic';\n\n/**\n * Default text size expression used in the TomTom map style.\n *\n * @remarks\n * This MapLibre expression defines zoom-dependent text sizing that scales from 12px at zoom 10\n * to 14px at zoom 16. Use this for consistent text sizing across zoom levels.\n *\n * @example\n * ```typescript\n * import { DEFAULT_TEXT_SIZE } from '@tomtom-international/maps-sdk-js/map';\n *\n * const textLayer = {\n *   type: 'symbol',\n *   layout: {\n *     'text-size': DEFAULT_TEXT_SIZE,\n *     'text-field': ['get', 'name']\n *   }\n * };\n * ```\n *\n * @group Map Style\n */\nexport const DEFAULT_TEXT_SIZE: ExpressionSpecification = ['interpolate', ['linear'], ['zoom'], 10, 14, 18, 16];\n\n/**\n * Array of all available font faces in the TomTom map style.\n *\n * @remarks\n * Contains all font variants available in the map style. Useful for font selection\n * or validation when creating custom layers.\n *\n * @example\n * ```typescript\n * import { mapFonts } from '@tomtom-international/maps-sdk-js/map';\n *\n * // Check if a font is available\n * if (mapFonts.includes('Noto-Bold')) {\n *   // Use the font\n * }\n *\n * // Use as fallback list\n * const textLayer = {\n *   type: 'symbol',\n *   layout: {\n *     'text-font': [...mapFonts]\n *   }\n * };\n * ```\n *\n * @group Map Style\n */\nexport const mapFonts = [MAP_REGULAR_FONT, MAP_ITALIC_FONT, MAP_BOLD_FONT, MAP_MEDIUM_FONT] as const;\n\n/**\n * Type representing valid font faces available in the TomTom map style.\n *\n * @remarks\n * Use this type to ensure type-safe font selection when working with text layers.\n * Restricts values to only the fonts available in the map style.\n *\n * @example\n * ```typescript\n * import type { MapFont } from '@tomtom-international/maps-sdk-js/map';\n *\n * function createTextLayer(font: MapFont) {\n *   return {\n *     type: 'symbol',\n *     layout: {\n *       'text-font': [font],\n *       'text-field': ['get', 'name']\n *     }\n *   };\n * }\n *\n * // Type-safe: only accepts valid map fonts\n * const layer = createTextLayer('Noto-Bold');\n * ```\n *\n * @group Map Style\n */\nexport type MapFont = (typeof mapFonts)[number];\n\n/**\n * @ignore\n */\nexport const PIN_ICON_SIZE: ExpressionSpecification = ['interpolate', ['linear'], ['zoom'], 8, 0.6, 22, 0.8];\n\n/**\n * @ignore\n */\nexport const SELECTED_PIN_ICON_SIZE: ExpressionSpecification = ['interpolate', ['linear'], ['zoom'], 8, 0.8, 22, 1];\n","import { SymbolLayerSpecification } from 'maplibre-gl';\nimport { LayerSpecTemplate } from '../types';\nimport { DEFAULT_TEXT_SIZE, MAP_BOLD_FONT, PIN_ICON_SIZE } from './commonLayerProps';\n\n/**\n * @ignore\n */\nexport const TITLE = 'title';\n\n/**\n * @ignore\n */\nexport const ICON_ID = 'iconID';\n\n/**\n * @ignore\n */\nexport const DEFAULT_PLACE_ICON_ID = 'default_place';\n\n/**\n * @ignore\n */\nexport const pinIconBaseLayout: SymbolLayerSpecification['layout'] = {\n    'icon-image': ['get', ICON_ID],\n    'icon-anchor': 'bottom',\n    'icon-size': PIN_ICON_SIZE,\n    'icon-allow-overlap': true,\n    'icon-padding': 0,\n};\n\n/**\n * @ignore\n */\nexport const pinIconBasePaint: SymbolLayerSpecification['paint'] = {\n    'icon-translate': [0, 5],\n    'icon-translate-anchor': 'viewport',\n};\n\n/**\n * @ignore\n */\nexport const pinTextBaseLayout: SymbolLayerSpecification['layout'] = {\n    'text-optional': true,\n    'text-font': [MAP_BOLD_FONT],\n    'text-field': ['get', TITLE],\n    'text-justify': 'auto',\n    'text-variable-anchor': ['top', 'left', 'right'],\n    // NOTE: make sure to text against pins and waypoints, in a way that there's enough distance from the pin so the text doesn't disappear\n    'text-variable-anchor-offset': ['top', [0, 0.7], 'left', [1.4, -1.4], 'right', [-1.4, -1.4]],\n    'text-size': DEFAULT_TEXT_SIZE,\n    'text-padding': 5,\n};\n\n/**\n * @ignore\n */\nexport const pinTextBasePaint: SymbolLayerSpecification['paint'] = {\n    'text-color': '#333333',\n    'text-halo-color': '#FFFFFF',\n    'text-halo-width': ['interpolate', ['linear'], ['zoom'], 6, 1, 10, 1.5],\n    'text-translate-anchor': 'viewport',\n};\n\n/**\n * Pin places, base layer with mostly the icon portion.\n * @ignore\n */\nexport const pinLayerBaseSpec: LayerSpecTemplate<SymbolLayerSpecification> = {\n    type: 'symbol',\n    layout: { ...pinIconBaseLayout, ...pinTextBaseLayout },\n    paint: { ...pinIconBasePaint, ...pinTextBasePaint },\n};\n","import type { ExpressionSpecification } from 'maplibre-gl';\n\n/**\n * @ignore\n */\nexport const isClickEventState: ExpressionSpecification = [\n    'in',\n    ['get', 'eventState'],\n    ['literal', ['click', 'contextmenu']],\n];\n","import type {\n    DataDrivenPropertyValueSpecification,\n    ExpressionSpecification,\n    Map,\n    SymbolLayerSpecification,\n} from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { SELECTED_PIN_ICON_SIZE } from '../../shared/layers/commonLayerProps';\nimport { isClickEventState } from '../../shared/layers/eventState';\nimport { ICON_ID, pinLayerBaseSpec, TITLE } from '../../shared/layers/symbolLayers';\nimport type { PlaceLayerName, PlaceLayersConfig, PlacesModuleConfig } from '../types/placesModuleConfig';\n\n/**\n * @ignore\n */\nexport const hasEventState: ExpressionSpecification = ['has', 'eventState'];\n\n/**\n * @ignore\n */\nexport const SELECTED_COLOR = '#3f9cd9';\n\n/**\n * @ignore\n */\nexport const pinLayerSpec: LayerSpecTemplate<SymbolLayerSpecification> = {\n    ...pinLayerBaseSpec,\n    filter: ['!', hasEventState],\n};\n\n/**\n * We use an extra layer for highlighted text since it's not easy to enforce z-ordering with icons and text\n * while text has different collision rules.\n * @ignore\n */\nexport const selectedPinLayerSpec: LayerSpecTemplate<SymbolLayerSpecification> = {\n    ...pinLayerBaseSpec,\n    filter: hasEventState,\n    layout: {\n        ...pinLayerBaseSpec.layout,\n        'icon-size': SELECTED_PIN_ICON_SIZE,\n        'text-allow-overlap': true,\n    },\n    paint: {\n        ...pinLayerBaseSpec.paint,\n        'text-color': SELECTED_COLOR,\n    },\n};\n\nconst withConfig = (\n    layerSpec: LayerSpecTemplate<SymbolLayerSpecification>,\n    config: PlacesModuleConfig | undefined,\n    layerName: PlaceLayerName,\n): LayerSpecTemplate<SymbolLayerSpecification> => {\n    const textConfig = config?.text;\n    const customLayer = config?.layers?.[layerName];\n    return {\n        ...layerSpec,\n        layout: {\n            ...layerSpec.layout,\n            ...(textConfig?.size && { 'text-size': textConfig.size }),\n            ...(textConfig?.font && { 'text-font': textConfig.font }),\n            ...(textConfig?.offset && { 'text-offset': textConfig.offset }),\n            ...(textConfig?.title &&\n                typeof textConfig?.title !== 'function' && {\n                    'text-field': textConfig?.title,\n                }),\n        },\n        paint: {\n            ...layerSpec.paint,\n            ...(textConfig?.color && { 'text-color': textConfig.color }),\n            ...(textConfig?.haloColor && { 'text-halo-color': textConfig.haloColor }),\n            ...(textConfig?.haloWidth && { 'text-halo-width': textConfig.haloWidth }),\n        },\n        ...customLayer,\n    };\n};\n\n/**\n * @ignore\n */\nexport const getTextSizeSpec = (\n    textSize?: DataDrivenPropertyValueSpecification<number>,\n): DataDrivenPropertyValueSpecification<number> => {\n    return JSON.parse(JSON.stringify(textSize)?.replace(/name/g, TITLE));\n};\n\nconst buildPoiLikeLayerSpec = (map: Map): LayerSpecTemplate<SymbolLayerSpecification> => {\n    const poiLayer = (map.getStyle().layers.filter((layer) => layer.id === 'POI')[0] as SymbolLayerSpecification) || {};\n    const textSize = poiLayer.layout?.['text-size'];\n    return {\n        filter: ['!', isClickEventState],\n        type: 'symbol',\n        paint: poiLayer.paint,\n        layout: {\n            ...poiLayer.layout,\n            'text-field': ['get', TITLE],\n            'icon-image': ['get', ICON_ID],\n            ...(textSize && { 'text-size': getTextSizeSpec(textSize) }),\n        },\n    };\n};\n\n/**\n * @ignore\n */\nexport const buildPlacesLayerSpecs = (config: PlacesModuleConfig | undefined, map: Map): PlaceLayersConfig => {\n    // Build the layer spec templates based on the theme:\n    let layerSpecTemplates;\n    if (config?.theme === 'base-map') {\n        const poiLikeLayerSpec = buildPoiLikeLayerSpec(map);\n        layerSpecTemplates = {\n            main: poiLikeLayerSpec,\n            selected: {\n                ...poiLikeLayerSpec,\n                filter: hasEventState,\n                layout: {\n                    ...poiLikeLayerSpec.layout,\n                    'text-allow-overlap': true,\n                },\n                paint: {\n                    ...poiLikeLayerSpec.paint,\n                    'text-color': SELECTED_COLOR,\n                },\n            },\n        };\n    } else {\n        // pin / circle\n        layerSpecTemplates = {\n            main: pinLayerSpec,\n            selected: selectedPinLayerSpec,\n        };\n    }\n\n    return {\n        main: withConfig(layerSpecTemplates.main, config, 'main'),\n        selected: withConfig(layerSpecTemplates.selected, config, 'selected'),\n        ...config?.layers?.additional,\n    };\n};\n","import { SVGIconStyleOptions } from '../../shared';\nimport { isDOMImageSupported, svgToImg } from '../../shared/imageUtils';\nimport { pinSvg } from '../../shared/resources';\n\n/**\n * Default pin for selected images without a specific category on it.\n * @ignore\n */\nexport const defaultPin = (options?: SVGIconStyleOptions): HTMLImageElement => {\n    // defensive check for SSR and node-test environments:\n    if (!isDOMImageSupported()) {\n        return undefined as never as HTMLImageElement;\n    }\n    return svgToImg(pinSvg(options));\n};\n","import { Place } from '@tomtom-org/maps-sdk/core';\n\n// Supported sub-categories for map display pins\n// See: https://github.com/tomtom-internal/mdt-backend-mapbox-gl-js-styles/blob/orbis-preview/src/orbis/sprites/poi_light/config.json\n// For the rest we'll use the main categories (which are the first 4 digits of a category)\nconst supportedPinSubcategories: Set<number> = new Set([\n    7339002, 8099002, 7369004, 7321003, 7376006, 9362003, 9362004, 9160004, 9376007, 7315015, 9376006, 9376002, 7315078,\n    7315149, 9376005, 7372003, 9352045, 9352032, 9361048, 9902003, 9378005, 7383004, 9910004, 7320002, 9362016, 7320003,\n    9362025, 9942002, 9942003, 7380005, 9663003, 9361021, 9379009, 9379004, 7315147, 9376003, 9160002, 9160003, 9352008,\n    9361006, 7389004, 9910006,\n]);\n\n/**\n * Maps a place to the ID of the map style sprite image to use as pin for it.\n * NOTE: this is likely to evolve in the future as Orbis APIs mature and stop relying on Genesis categories.\n * @see https://github.com/tomtom-internal/mdt-backend-mapbox-gl-js-styles/blob/orbis-preview/src/orbis/sprites/poi_light/config.json\n * @ignore\n */\nexport const toMapDisplayPin = (place: Place, defaultPlaceIconID: string): string => {\n    const categoryID = place.properties.poi?.categoryIds?.[0];\n    if (!categoryID) {\n        return defaultPlaceIconID;\n    }\n\n    // Check if the category ID is in our supported subcategories:\n    if (supportedPinSubcategories.has(categoryID)) {\n        return categoryID.toString();\n    }\n\n    // If not, fall back to the main category (first 4 digits of the category ID):\n    return categoryID.toString().substring(0, 4);\n};\n","import type { Place, Places, POICategory } from '@tomtom-org/maps-sdk/core';\nimport { toMapDisplayPOICategory } from '../../pois/poiCategoryMapping';\nimport { DEFAULT_PLACE_ICON_ID } from '../../shared/layers/symbolLayers';\nimport type { DisplayPlaceProps } from '../types/placeDisplayProps';\nimport type { PlacesModuleConfig } from '../types/placesModuleConfig';\nimport { toMapDisplayPin } from './pinCategoryStandardMapping';\n\n/**\n * Builds the title of the place to display it on the map.\n * @param place The place to display.\n * @ignore\n */\nexport const buildPlaceTitle = (place: Place): string =>\n    place.properties.poi?.name ?? place.properties.address.freeformAddress;\n\n/**\n * @ignore\n */\nexport const imageIDWithInstanceSuffix = (baseID: string, instanceIndex: number): string =>\n    `${baseID}-${instanceIndex}`;\n\n/**\n * Gets the map style sprite image ID to display on the map for the give place.\n * @ignore\n */\nexport const getIconIDForPlace = (place: Place, instanceIndex: number, config: PlacesModuleConfig = {}): string => {\n    const iconTheme = config.theme ?? 'pin';\n    // TODO: perhaps all the available icon mappings should come resolved from PlacesModule instance\n    const categoryIcons = config.icon?.categoryIcons;\n\n    // First we try to match any custom icon:\n    const classificationCode = place.properties.poi?.classifications?.[0]?.code as POICategory;\n    const matchingCustomIcon = categoryIcons?.find((customIcon) => customIcon.id === classificationCode);\n    if (matchingCustomIcon) {\n        return imageIDWithInstanceSuffix(matchingCustomIcon.id, instanceIndex);\n    }\n    // Else: if no custom icon matched, we map to the map style icons:\n\n    const defaultPlaceIconID = imageIDWithInstanceSuffix(DEFAULT_PLACE_ICON_ID, instanceIndex);\n    let iconId: string;\n    if (iconTheme === 'pin') {\n        iconId = toMapDisplayPin(place, defaultPlaceIconID);\n    } else {\n        // POI assets have their own category mapping and we use search classification codes to map them:\n        // TODO: consider default_circle asset instead of default_pin\n        iconId = (classificationCode && `poi-${toMapDisplayPOICategory(classificationCode)}`) ?? defaultPlaceIconID;\n    }\n\n    return iconId;\n};\n\n/**\n * Maps a Place category to the poi layer one, so the latter's style can apply it.\n * @ignore\n */\nexport const getPOILayerCategoryForPlace = (place: Place): string | undefined => {\n    const category = place.properties.poi?.classifications?.[0]?.code;\n    // if it's one of the different categories between search and poi layer, use poi layer category\n    return category && toMapDisplayPOICategory(category);\n};\n\n/**\n * Transforms the input of a \"show\" call to FeatureCollection \"Places\".\n * @ignore\n */\nexport const toPlaces = (places: Place | Place[] | Places): Places => {\n    if (Array.isArray(places)) {\n        return { type: 'FeatureCollection', features: places };\n    }\n    return places.type === 'Feature' ? { type: 'FeatureCollection', features: [places] } : places;\n};\n\n/**\n * prepare places features to be displayed on map by adding needed  properties for title, icon and style\n * @ignore\n */\nexport const preparePlacesForDisplay = (\n    placesInput: Place | Place[] | Places,\n    instanceIndex: number,\n    config: PlacesModuleConfig = {},\n): Places<DisplayPlaceProps> => {\n    const places = toPlaces(placesInput);\n    return {\n        ...places,\n        features: places.features.map((place) => {\n            const title =\n                typeof config?.text?.title === 'function' ? config?.text?.title(place) : buildPlaceTitle(place);\n\n            const extraFeatureProps = config.extraFeatureProps\n                ? Object.fromEntries(\n                      Object.entries(config.extraFeatureProps).map(([prop, value]) => [\n                          prop,\n                          typeof value === 'function' ? value(place) : value,\n                      ]),\n                  )\n                : {};\n\n            return {\n                ...place,\n                geometry: { ...place.geometry, bbox: place.bbox },\n                properties: {\n                    ...place.properties,\n                    id: place.id,\n                    title,\n                    iconID: getIconIDForPlace(place, instanceIndex, config),\n                    ...(config?.theme === 'base-map' && { category: getPOILayerCategoryForPlace(place) }),\n                    ...extraFeatureProps,\n                },\n            };\n        }),\n    };\n};\n","import type { Place, Places } from '@tomtom-org/maps-sdk/core';\nimport type {\n    CleanEventStateOptions,\n    CleanEventStatesOptions,\n    PutEventStateOptions,\n    SymbolLayerSpecWithoutSource,\n} from '../shared';\nimport { AbstractMapModule, EventsModule, GeoJSONSourceWithLayers, PLACES_SOURCE_PREFIX_ID } from '../shared';\nimport { DEFAULT_PLACE_ICON_ID } from '../shared/layers/symbolLayers';\nimport { addOrUpdateImage, changeLayersProps, waitUntilMapIsReady } from '../shared/mapUtils';\nimport type { TomTomMap } from '../TomTomMap';\nimport { buildPlacesLayerSpecs } from './layers/placesLayers';\nimport { defaultPin } from './resources';\nimport type { DisplayPlaceProps } from './types/placeDisplayProps';\nimport {\n    PlaceIconConfig,\n    PlaceLayerName,\n    PlacesModuleConfig,\n    PlacesTheme,\n    PlaceTextConfig,\n} from './types/placesModuleConfig';\nimport { imageIDWithInstanceSuffix, preparePlacesForDisplay } from './utils/preparePlacesForDisplay';\n\ntype PlacesSourcesAndLayers = {\n    /**\n     * Places source id with corresponding layers ids.\n     */\n    places: GeoJSONSourceWithLayers<Places<DisplayPlaceProps>>;\n};\n\n/**\n * Map module for displaying and managing place markers.\n *\n * The PlacesModule provides functionality to display location markers (pins) on the map\n * for points of interest, search results, or custom locations. It supports various marker\n * styles, custom icons, text labels, and interactive events.\n *\n * @remarks\n * **Features:**\n * - Multiple marker styles (pin, circle, POI-like)\n * - Custom icons per POI category\n * - Text labels with styling options\n * - Data-driven styling via MapLibre expressions\n * - Interactive events (click, hover, etc.)\n * - Support for custom feature properties\n *\n * **Marker Styles:**\n * - `pin`: Traditional teardrop-shaped map pins\n * - `circle`: Simple circular markers\n * - `base-map`: Mimics built-in POI layer styling\n *\n * **Common Use Cases:**\n * - Search result visualization\n * - Custom location markers\n * - Store locators\n * - Delivery/pickup points\n * - Saved locations display\n *\n * @example\n * ```typescript\n * // Create places module with pin markers\n * const places = await PlacesModule.get(map, {\n *   icon: {\n *     categoryIcons: []\n *   },\n *   text: {\n *     field: (place) => place.properties.poi?.name || 'Unknown'\n *   },\n *   theme: 'pin'\n * });\n *\n * // Display places from search\n * await places.show(searchResults);\n *\n * // Handle clicks\n * places.events.on('click', (feature) => {\n *   console.log('Clicked:', feature.properties);\n * });\n *\n * places.events.on('hover', (feature) => {\n *   showTooltip(feature.properties.poi?.name);\n * });\n * ```\n *\n * @see [Places Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/places)\n *\n * @group Places\n */\nexport class PlacesModule extends AbstractMapModule<PlacesSourcesAndLayers, PlacesModuleConfig> {\n    private static lastInstanceIndex = -1;\n    private layerSpecs!: Record<PlaceLayerName, SymbolLayerSpecWithoutSource>;\n    private sourceID!: string;\n    private layerIDPrefix!: string;\n    /**\n     * The index of this instance, to generate unique source and layer IDs.\n     * * Starts with 0 and each instance increments it by one.\n     * @private\n     */\n    private instanceIndex!: number;\n    private defaultPlaceIconID!: string;\n\n    /**\n     * Make sure the map is ready before create an instance of the module and any other interaction with the map\n     * @param tomtomMap The TomTomMap instance.\n     * @param config  The module optional configuration\n     * @returns {Promise} Returns a promise with a new instance of this module\n     */\n    static async get(tomtomMap: TomTomMap, config?: PlacesModuleConfig): Promise<PlacesModule> {\n        await waitUntilMapIsReady(tomtomMap);\n        return new PlacesModule(tomtomMap, config);\n    }\n\n    private constructor(map: TomTomMap, config?: PlacesModuleConfig) {\n        super('geojson', map, config);\n    }\n\n    /**\n     * @ignore\n     */\n    protected _initSourcesWithLayers(config?: PlacesModuleConfig, restore?: boolean): PlacesSourcesAndLayers {\n        // Only increment the instance index for new instances, not for restore operations\n        if (!restore) {\n            PlacesModule.lastInstanceIndex++;\n            this.instanceIndex = PlacesModule.lastInstanceIndex;\n            this.sourceID = `${PLACES_SOURCE_PREFIX_ID}-${this.instanceIndex}`;\n            this.layerIDPrefix = `places-${this.instanceIndex}`;\n            this.defaultPlaceIconID = imageIDWithInstanceSuffix(DEFAULT_PLACE_ICON_ID, this.instanceIndex);\n        }\n\n        // Update each layer id with the instance-specific prefix\n        this.layerSpecs = this.buildLayerSpecs(config);\n\n        return {\n            places: new GeoJSONSourceWithLayers(this.mapLibreMap, this.sourceID, [\n                this.layerSpecs.main,\n                this.layerSpecs.selected,\n            ]),\n        };\n    }\n\n    private buildLayerSpecs(config?: PlacesModuleConfig) {\n        const layerSpecTemplates = buildPlacesLayerSpecs(config, this.mapLibreMap);\n\n        // Update each layer id with the instance-specific prefix\n        return Object.fromEntries(\n            Object.entries(layerSpecTemplates).map(([key, spec]) => [\n                key,\n                { ...spec, id: `${this.layerIDPrefix}-${key}` },\n            ]),\n        ) as Record<PlaceLayerName, SymbolLayerSpecWithoutSource>;\n    }\n\n    /**\n     * @ignore\n     */\n    protected _applyConfig(config: PlacesModuleConfig | undefined) {\n        this.updateLayersAndData(config);\n        return config;\n    }\n\n    /**\n     * @ignore\n     */\n    protected restoreDataAndConfigImpl() {\n        const previousShownFeatures = this.sourcesWithLayers.places.shownFeatures;\n        this.initSourcesWithLayers(this.config, true);\n        this.config && this._applyConfig(this.config);\n        this.show(previousShownFeatures);\n    }\n\n    /**\n     * Updates the visual theme for displayed places.\n     *\n     * @param theme - The theme style to apply to place markers.\n     *\n     * @remarks\n     * **Available Themes:**\n     * - `pin`: Traditional teardrop-shaped map pins\n     * - `circle`: Simple circular markers\n     * - `base-map`: Mimics the map's built-in POI layer style with category icons\n     *\n     * Changes apply immediately to all currently shown places. Other configuration\n     * properties (icon config, text config) remain unchanged.\n     *\n     * @example\n     * ```typescript\n     * // Switch to pin markers\n     * places.applyTheme('pin');\n     *\n     * // Use simple circles\n     * places.applyTheme('circle');\n     *\n     * // Match map's POI style (ideal to blend in)\n     * places.applyTheme('base-map');\n     * ```\n     */\n    applyTheme(theme: PlacesTheme): void {\n        this.applyConfigPart({ theme });\n    }\n\n    /**\n     * Updates the icon configuration for displayed places.\n     *\n     * @param iconConfig - New icon configuration settings.\n     *\n     * @remarks\n     * - Changes apply immediately to currently shown places\n     * - Custom icons are loaded if not already in style\n     * - Other configuration properties remain unchanged\n     *\n     * @example\n     * ```typescript\n     * places.applyIconConfig({\n     *   categoryIcons: [\n     *     { category: 'RESTAURANT', id: 'restaurant-icon', image: '/icons/food.png' }\n     *   ]\n     * });\n     * ```\n     */\n    applyIconConfig(iconConfig: PlaceIconConfig): void {\n        this.applyConfigPart({ icon: iconConfig });\n    }\n\n    /**\n     * Updates the text/label configuration for displayed places.\n     *\n     * @param textConfig - New text configuration settings.\n     *\n     * @remarks\n     * Supports both functions and MapLibre expressions for dynamic text.\n     *\n     * @example\n     * ```typescript\n     * // Use function\n     * places.applyTextConfig({\n     *   field: (place) => place.properties.poi?.name || 'Unknown'\n     * });\n     *\n     * // Use MapLibre expression\n     * places.applyTextConfig({\n     *   field: ['get', 'title'],\n     *   size: 14,\n     *   color: '#333'\n     * });\n     * ```\n     */\n    applyTextConfig(textConfig: PlaceTextConfig): void {\n        this.applyConfigPart({ text: textConfig });\n    }\n\n    private applyConfigPart(partialConfig: Partial<PlacesModuleConfig>): void {\n        const config = { ...this.config, ...partialConfig };\n        this.updateLayersAndData(config);\n        this.config = config;\n    }\n\n    /**\n     * Applies additional feature properties to displayed places.\n     *\n     * @param extraFeatureProps - Object mapping property names to values or functions.\n     *\n     * @remarks\n     * Useful for adding computed properties or metadata for styling/filtering.\n     *\n     * @example\n     * ```typescript\n     * places.applyExtraFeatureProps({\n     *   category: (place) => place.properties.poi?.categories?.[0],\n     *   rating: (place) => place.properties.poi?.rating || 0,\n     *   isOpen: true\n     * });\n     * ```\n     */\n    applyExtraFeatureProps(extraFeatureProps: { [key: string]: any }): void {\n        const config = { ...this.config, extraFeatureProps };\n        this.updateData(config);\n        this.config = config;\n    }\n\n    private updateLayersAndData(config: PlacesModuleConfig | undefined): void {\n        this.setupImages(config);\n        const newLayerSpecs = this.buildLayerSpecs(config);\n        // Convert layerSpecs objects to arrays for changeLayersProps\n        const newLayerSpecsArray = [newLayerSpecs.main, newLayerSpecs.selected];\n        const oldLayerSpecsArray = [this.layerSpecs.main, this.layerSpecs.selected];\n        changeLayersProps(newLayerSpecsArray, oldLayerSpecsArray, this.mapLibreMap);\n        this.layerSpecs = newLayerSpecs;\n        this.updateData(config);\n    }\n\n    private setupImages(config: PlacesModuleConfig | undefined): void {\n        // Ensure default pin is added:\n        console.log('setupImages', this.defaultPlaceIconID);\n        if (config?.icon) {\n            // If we have custom icons, ensure they're added to the map style:\n            for (const customIcon of config.icon.categoryIcons ?? []) {\n                addOrUpdateImage(\n                    'if-not-in-sprite',\n                    imageIDWithInstanceSuffix(customIcon.id, this.instanceIndex),\n                    customIcon.image as string | HTMLImageElement,\n                    this.mapLibreMap,\n                    {\n                        pixelRatio: customIcon.pixelRatio ?? 2,\n                    },\n                );\n            }\n\n            if (config.icon.default) {\n                if (config.icon.default.image) {\n                    addOrUpdateImage(\n                        'if-not-in-sprite',\n                        this.defaultPlaceIconID,\n                        config.icon.default.image.image as string | HTMLImageElement,\n                        this.mapLibreMap,\n                        {\n                            pixelRatio: config.icon.default.image.pixelRatio ?? 2,\n                        },\n                    );\n                }\n                if (config.icon.default.style) {\n                    addOrUpdateImage(\n                        'if-not-in-sprite',\n                        this.defaultPlaceIconID,\n                        defaultPin(config.icon.default.style),\n                        this.mapLibreMap,\n                        { pixelRatio: 2 },\n                    );\n                }\n            }\n        } else {\n            // Ensure default pin is added:\n            console.log('Adding default pin icon for places module', this.defaultPlaceIconID);\n            addOrUpdateImage('if-not-in-sprite', this.defaultPlaceIconID, defaultPin(), this.mapLibreMap, {\n                pixelRatio: 2,\n            });\n        }\n    }\n\n    private updateData(config: PlacesModuleConfig | undefined): void {\n        this.sourcesWithLayers.places.source.runtimeSource?.setData(\n            preparePlacesForDisplay(this.sourcesWithLayers.places.shownFeatures, this.instanceIndex, config),\n        );\n    }\n\n    /**\n     * Displays the given places on the map.\n     *\n     * @param places - Place data to display. Can be a single Place, array of Places,\n     * or a Places FeatureCollection.\n     *\n     * @remarks\n     * **Behavior:**\n     * - Replaces any previously shown places\n     * - Applies current module styling configuration\n     * - Automatically generates labels if text config is set\n     * - Waits for module to be ready before displaying\n     *\n     * **Data Sources:**\n     * - TomTom Search API results\n     * - Custom place objects matching the Place interface\n     * - GeoJSON Point features\n     *\n     * @example\n     * Display search results:\n     * ```typescript\n     * import { search } from '@tomtom-international/maps-sdk-js/services';\n     *\n     * const results = await search.search({ query: 'coffee' });\n     * await places.show(results.results);\n     * ```\n     *\n     * @example\n     * Display single place:\n     * ```typescript\n     * await places.show({\n     *   type: 'Feature',\n     *   geometry: { type: 'Point', coordinates: [4.9041, 52.3676] },\n     *   properties: {\n     *     address: { freeformAddress: 'Amsterdam' },\n     *     poi: { name: 'Amsterdam Central' }\n     *   }\n     * });\n     * ```\n     *\n     * @example\n     * Display multiple places:\n     * ```typescript\n     * await places.show([place1, place2, place3]);\n     * ```\n     */\n    async show(places: Place | Place[] | Places) {\n        await this.waitUntilModuleReady();\n        this.sourcesWithLayers.places.show(preparePlacesForDisplay(places, this.instanceIndex, this.config));\n    }\n\n    /**\n     * Removes all places from the map.\n     *\n     * @remarks\n     * - Clears all displayed places\n     * - Does not reset styling configuration\n     * - Module remains initialized and ready for new data\n     *\n     * @example\n     * ```typescript\n     * await places.clear();\n     * ```\n     */\n    async clear() {\n        await this.waitUntilModuleReady();\n        this.sourcesWithLayers.places.clear();\n    }\n\n    /**\n     * Programmatically sets an event state on a specific place.\n     *\n     * @param options - Configuration for the event state to apply.\n     *\n     * @remarks\n     * Use this to make places appear clicked or hovered programmatically.\n     *\n     * @example\n     * ```typescript\n     * // Make first place appear clicked\n     * places.putEventState({\n     *   index: 0,\n     *   state: 'click',\n     *   mode: 'put'\n     * });\n     * ```\n     */\n    putEventState(options: PutEventStateOptions) {\n        this.sourcesWithLayers.places.putEventState(options);\n    }\n\n    /**\n     * Removes an event state from a specific place.\n     *\n     * @param options - Configuration for which event state to remove.\n     *\n     * @example\n     * ```typescript\n     * places.cleanEventState({ index: 0 });\n     * ```\n     */\n    cleanEventState(options: CleanEventStateOptions): void {\n        this.sourcesWithLayers.places.cleanEventState(options);\n    }\n\n    /**\n     * Removes event states from multiple places.\n     *\n     * @param options - Optional filter for which states to remove.\n     *\n     * @example\n     * ```typescript\n     * // Remove all event states\n     * places.cleanEventStates();\n     *\n     * // Remove only hover states\n     * places.cleanEventStates({ states: ['hover'] });\n     * ```\n     */\n    cleanEventStates(options?: CleanEventStatesOptions) {\n        this.sourcesWithLayers.places.cleanEventStates(options);\n    }\n\n    /**\n     * Create the events on/off for this module\n     * @returns An instance of EventsModule\n     */\n    get events() {\n        return new EventsModule<Place<DisplayPlaceProps>>(this.eventsProxy, this.sourcesWithLayers.places);\n    }\n}\n","import type { ExpressionFilterSpecification, FilterSpecification, LegacyFilterSpecification } from 'maplibre-gl';\nimport type { FilterShowMode, FilterSyntaxVersion, MultiSyntaxFilter, ValuesFilter } from './types';\n\n/**\n * @ignore\n */\nconst isExpressionFilter = (filter: FilterSpecification): filter is ExpressionFilterSpecification => {\n    if (filter === true || filter === false) {\n        return true;\n    }\n\n    if (!Array.isArray(filter) || filter.length === 0) {\n        return false;\n    }\n    switch (filter[0]) {\n        case 'has':\n            return filter.length >= 2 && filter[1] !== '$id' && filter[1] !== '$type';\n\n        case 'in':\n            return filter.length >= 3 && (typeof filter[1] !== 'string' || Array.isArray(filter[2]));\n\n        case '!in':\n        case '!has':\n        case 'none':\n            return false;\n\n        case '==':\n        case '!=':\n        case '>':\n        case '>=':\n        case '<':\n        case '<=':\n            return filter.length !== 3 || Array.isArray(filter[1]) || Array.isArray(filter[2]);\n\n        case 'any':\n        case 'all':\n            for (const f of filter.slice(1)) {\n                if (!isExpressionFilter(f as FilterSpecification) && typeof f !== 'boolean') {\n                    return false;\n                }\n            }\n            return true;\n\n        default:\n            return true;\n    }\n};\n\n/**\n * @ignore\n */\nexport const getSyntaxVersion = (expression: FilterSpecification): FilterSyntaxVersion =>\n    isExpressionFilter(expression) ? 'expression' : 'legacy';\n\n/**\n * @ignore\n */\nexport const getMergedAnyFilter = (filters: MultiSyntaxFilter[]): MultiSyntaxFilter | null => {\n    if (!filters?.length) {\n        return null;\n    }\n    if (filters.length === 1) {\n        return filters[0];\n    }\n    return {\n        expression: ['any', ...filters.map((filter) => filter?.expression)],\n        legacy: ['any', ...filters.map((filter) => filter?.legacy)],\n    };\n};\n\n/**\n * @ignore\n */\nexport const getMergedAllFilter = (\n    filterToAdd: MultiSyntaxFilter,\n    originalFilter: FilterSpecification | undefined,\n): FilterSpecification => {\n    if (originalFilter) {\n        return ['all', filterToAdd[getSyntaxVersion(originalFilter)], originalFilter] as FilterSpecification;\n    }\n    return filterToAdd.expression;\n};\n\n/**\n * @ignore\n */\nexport const buildMappedValuesFilter = <T>(\n    propName: string,\n    showMode: FilterShowMode,\n    values: T[],\n): MultiSyntaxFilter => {\n    if (values.length === 1) {\n        const comparator = showMode === 'only' ? '==' : '!=';\n        return {\n            expression: [comparator, ['get', propName], values[0]] as ExpressionFilterSpecification,\n            legacy: [comparator, propName, values[0]] as LegacyFilterSpecification,\n        };\n    }\n    const filterArrayNew = ['in', ['get', propName], ['literal', values]];\n    if (showMode === 'only') {\n        return {\n            expression: filterArrayNew as ExpressionFilterSpecification,\n            legacy: ['in', propName, ...values] as LegacyFilterSpecification,\n        };\n    }\n    return {\n        expression: ['!', filterArrayNew as ExpressionFilterSpecification],\n        legacy: ['!in', propName, ...values] as LegacyFilterSpecification,\n    };\n};\n\n/**\n * @ignore\n */\nexport const buildValuesFilter = <T>(\n    propName: string,\n    filter: ValuesFilter<T>,\n    valuesMapping?: (value: T) => unknown,\n): MultiSyntaxFilter =>\n    buildMappedValuesFilter(propName, filter.show, valuesMapping ? filter.values.map(valuesMapping) : filter.values);\n","import type { MapStylePOICategory } from '../places';\n\n/**\n * Predefined groups of related POI categories for convenient filtering.\n *\n * @remarks\n * This object maps group names to arrays of {@link MapStylePOICategory} values.\n * Each group contains POI categories that share a common theme or purpose,\n * making it easier to filter multiple related POI types with a single identifier.\n *\n * **Available Groups:**\n * - `FOOD_DRINKS_GROUP` - Dining and beverage establishments (restaurants, cafes, pubs, etc.)\n * - `SHOPPING_GROUP` - Retail stores and shopping centers (shops, markets, supermarkets, etc.)\n * - `TRANSPORTATION_GROUP` - Transportation hubs and stops (airports, stations, terminals, etc.)\n * - `HEALTH_GROUP` - Healthcare facilities and services (hospitals, clinics, pharmacies, etc.)\n * - `PARKING_GROUP` - Parking facilities (garages and open parking areas)\n * - `HOLIDAY_TOURISM_GROUP` - Tourist attractions and recreational sites (museums, parks, beaches, etc.)\n * - `EV_CHARGING_STATIONS_GROUP` - Electric vehicle charging locations\n * - `GAS_STATIONS_GROUP` - Fuel stations for traditional vehicles\n * - `ACCOMMODATION_GROUP` - Lodging facilities (hotels, motels, camping grounds, etc.)\n * - `ENTERTAINMENT_GROUP` - Entertainment venues (cinemas, theaters, nightlife, casinos, etc.)\n * - `SPORTS_LEISURE_GROUP` - Sports and leisure facilities (stadiums, gyms, pools, golf courses, etc.)\n * - `EDUCATION_GROUP` - Educational institutions (schools, universities, libraries, etc.)\n * - `GOVERNMENT_GROUP` - Government and public safety facilities (offices, courts, embassies, police, fire stations)\n *\n * @example\n * Filter to show only food-related POIs:\n * ```ts\n * import { poiCategoryGroups } from '@tomtom-international/maps-sdk-js/map';\n *\n * const foodCategories = poiCategoryGroups.FOOD_DRINKS_GROUP;\n * console.log(foodCategories);\n * // ['RESTAURANT', 'FAST_FOOD', 'CAFE_PUB', 'PUB', 'WINERY', ...]\n * ```\n *\n * @example\n * Use with POI module filtering:\n * ```ts\n * poisModule.configure({\n *   categoryFilter: {\n *     mode: 'show',\n *     values: ['FOOD_DRINKS_GROUP', 'ENTERTAINMENT_GROUP']\n *   }\n * });\n * ```\n *\n * @see {@link POICategoryGroup} - Type representing all available group names\n * @see {@link MapStylePOICategory} - Individual POI category identifiers\n *\n * @group POIs\n */\nexport const poiCategoryGroups: Record<string, MapStylePOICategory[]> = {\n    FOOD_DRINKS_GROUP: [\n        'RESTAURANT',\n        'FAST_FOOD',\n        'CAFE_PUB',\n        'PUB',\n        'WINERY',\n        'PUB_FOOD',\n        'SOUL_FOOD',\n        'DELICATESSEN',\n    ],\n    SHOPPING_GROUP: [\n        'SHOP',\n        'SHOPPING_CENTER',\n        'CLOTHING_SHOP',\n        'MARKET',\n        'FOOD_MARKET',\n        'SUPERMARKETS_HYPERMARKETS',\n        'DEPARTMENT_STORE',\n        'CONVENIENCE_STORE',\n        'GROCERY_STORE',\n        'HARDWARE_STORE',\n        'ELECTRICAL_APPLIANCES_SHOP',\n    ],\n    TRANSPORTATION_GROUP: [\n        'AIRPORT',\n        'FERRY_TERMINAL',\n        'HELIPAD_HELICOPTER_LANDING',\n        'PUBLIC_TRANSPORT_STOP',\n        'RAILWAY_STATION',\n        'BUS_STOP',\n        'TAXI_STAND',\n    ],\n    HEALTH_GROUP: [\n        'DOCTOR',\n        'EMERGENCY_MEDICAL_SERVICE',\n        'EMERGENCY_ROOM',\n        'HEALTH_CARE_SERVICE',\n        'HOSPITAL',\n        'HOSPITAL_POLYCLINIC',\n        'PHARMACY',\n        'DENTIST',\n        'WELFARE_ORGANIZATION',\n    ],\n    PARKING_GROUP: ['PARKING_GARAGE', 'OPEN_PARKING_AREA'],\n    HOLIDAY_TOURISM_GROUP: [\n        'AMUSEMENT_PARK',\n        'BEACH',\n        'HOLIDAY_RENTAL',\n        'GEOGRAPHIC_FEATURE',\n        'IMPORTANT_TOURIST_ATTRACTION',\n        'LEISURE_CENTER',\n        'MOUNTAIN_PASS',\n        'MOUNTAIN_PEAK',\n        'MUSEUM',\n        'SCENIC_PANORAMIC_VIEW',\n        'TOURIST_INFORMATION_OFFICE',\n    ],\n    EV_CHARGING_STATIONS_GROUP: ['ELECTRIC_VEHICLE_STATION'],\n    GAS_STATIONS_GROUP: ['GAS_STATION', 'PETROL_STATION'],\n    ACCOMMODATION_GROUP: ['CAMPING_GROUND', 'HOTEL_MOTEL', 'HOLIDAY_RENTAL'],\n    ENTERTAINMENT_GROUP: [\n        'CINEMA',\n        'THEATER',\n        'MOVIE_THEATER',\n        'NIGHTLIFE',\n        'CONCERT_HALL',\n        'ENTERTAINMENT',\n        'CLUB_ASSOCIATION',\n        'CASINO',\n    ],\n    SPORTS_LEISURE_GROUP: [\n        'SPORTS_CENTER',\n        'WATER_SPORT',\n        'SWIMMING_POOL',\n        'GOLF_COURSE',\n        'STADIUM',\n        'BEACH',\n        'ICE_SKATING_RINK',\n        'LEISURE_CENTER',\n        'MOUNTAIN_PASS',\n        'MOUNTAIN_PEAK',\n    ],\n    EDUCATION_GROUP: ['SCHOOL', 'COLLEGE_UNIVERSITY', 'LIBRARY', 'CULTURAL_CENTER'],\n    GOVERNMENT_GROUP: ['GOVERNMENT_OFFICE', 'COURTHOUSE', 'EMBASSY', 'FIRE_STATION_BRIGADE', 'POLICE_STATION'],\n};\n\n/**\n * POI category group type.\n *\n * @remarks\n * Represents predefined groups of related POI categories for convenient filtering.\n * Each group contains multiple {@link MapStylePOICategory} values that share a common theme.\n *\n * Using category groups simplifies filtering by allowing you to show or hide\n * multiple related POI types with a single filter value.\n *\n * **Available groups:**\n * - `FOOD_DRINKS_GROUP` - Restaurants, cafes, fast food, wineries, etc.\n * - `SHOPPING_GROUP` - Stores, malls, markets, supermarkets, etc.\n * - `TRANSPORTATION_GROUP` - Airports, train stations, bus stops, ferry terminals, etc.\n * - `HEALTH_GROUP` - Hospitals, clinics, pharmacies, doctors, dentists, etc.\n * - `PARKING_GROUP` - Parking garages and open parking areas\n * - `HOLIDAY_TOURISM_GROUP` - Tourist attractions, museums, beaches, scenic views, etc.\n * - `EV_CHARGING_STATIONS_GROUP` - Electric vehicle charging stations\n * - `GAS_STATIONS_GROUP` - Gas and petrol stations\n * - `ACCOMMODATION_GROUP` - Hotels, motels, camping grounds, etc.\n * - `ENTERTAINMENT_GROUP` - Cinemas, theaters, nightlife, casinos, etc.\n * - `SPORTS_LEISURE_GROUP` - Stadiums, sports centers, swimming pools, golf courses, etc.\n * - `EDUCATION_GROUP` - Schools, universities, libraries, cultural centers\n * - `GOVERNMENT_GROUP` - Government offices, courthouses, embassies, police, fire stations\n *\n * @example\n * Filter to show only food-related POIs:\n * ```ts\n * poisModule.configure({\n *   categoryFilter: {\n *     mode: 'show',\n *     values: ['FOOD_DRINKS_GROUP']\n *   }\n * });\n * ```\n *\n * @example\n * Hide parking and gas stations:\n * ```ts\n * poisModule.configure({\n *   categoryFilter: {\n *     mode: 'hide',\n *     values: ['PARKING_GROUP', 'GAS_STATIONS_GROUP']\n *   }\n * });\n * ```\n *\n * @example\n * Combine multiple groups for tourism use case:\n * ```ts\n * const tourismFilter = {\n *   mode: 'show',\n *   values: [\n *     'HOLIDAY_TOURISM_GROUP',\n *     'ACCOMMODATION_GROUP',\n *     'FOOD_DRINKS_GROUP',\n *     'ENTERTAINMENT_GROUP'\n *   ]\n * };\n * ```\n *\n * @see {@link poiCategoryGroups} - The object containing all group definitions\n * @see {@link MapStylePOICategory} - For individual POI categories\n *\n * @group POIs\n */\nexport type POICategoryGroup = keyof typeof poiCategoryGroups;\n","import { isNil } from 'lodash-es';\nimport type { FilterSpecification } from 'maplibre-gl';\nimport type { MapStylePOICategory } from '../places';\nimport { toMapDisplayPOICategory } from '../places';\nimport type { ValuesFilter } from '../shared';\nimport { AbstractMapModule, EventsModule, POI_SOURCE_ID, StyleSourceWithLayers } from '../shared';\nimport { notInTheStyle } from '../shared/errorMessages';\nimport { buildMappedValuesFilter, getMergedAllFilter } from '../shared/mapLibreFilterUtils';\nimport { waitUntilMapIsReady } from '../shared/mapUtils';\nimport type { TomTomMap } from '../TomTomMap';\nimport { poiLayerIDs } from './layers/poisLayers';\nimport { poiCategoryGroups } from './poiCategoryGroups';\nimport type { FilterablePOICategory, POIsModuleConfig, POIsModuleFeature } from './types/poisModuleConfig';\n\n/**\n * Gets the specified filtered categories icon IDs to be used in map filtering.\n * @param categories list of filtered categories.\n * @ignore\n */\nexport const getStyleCategories = (categories: FilterablePOICategory[]): string[] => {\n    const categoryIds: string[] = [];\n    categories.forEach((category: FilterablePOICategory) => {\n        if (category in poiCategoryGroups) {\n            categoryIds.push(...poiCategoryGroups[category].map(toMapDisplayPOICategory));\n        } else {\n            categoryIds.push(toMapDisplayPOICategory(category as MapStylePOICategory));\n        }\n    });\n    return [...new Set(categoryIds)];\n};\n\n/**\n * IDs of sources and layers for places of interest module.\n */\ntype PoIsSourcesAndLayers = {\n    /**\n     * Places of interest with corresponding layer ids.\n     * TODO: technically source ID is vectorTiles if POIs stay included in base map for Orbis\n     */\n    poi: StyleSourceWithLayers;\n};\n\n/**\n * POIs Module for controlling Points of Interest displayed in the map style.\n *\n * This module manages the built-in POI layer from the vector map, allowing you to\n * show/hide POIs and filter them by category. POIs are already part of the map style\n * and include businesses, landmarks, and other points of interest.\n *\n * @remarks\n * **Features:**\n * - Toggle POI visibility on/off\n * - Filter by POI categories or category groups\n * - Event handling for POI interactions\n * - Based on vector tile data in the map style\n *\n * **POI Categories:**\n * - Individual categories (e.g., RESTAURANT, HOTEL_MOTEL, PARKING_GARAGE)\n * - Category groups (e.g., FOOD_DRINKS_GROUP, SHOPPING_GROUP, TRANSPORTATION_GROUP)\n *\n * **Difference from PlacesModule:**\n * - POIsModule: Controls existing POIs in the map style\n * - PlacesModule: Displays custom place data from Search API or other sources\n *\n * @example\n * Basic usage:\n * ```typescript\n * import { POIsModule } from '@tomtom-international/maps-sdk-js/map';\n *\n * // Get module\n * const pois = await POIsModule.get(map);\n *\n * // Toggle visibility\n * pois.setVisible(false);\n * pois.setVisible(true);\n * ```\n *\n * @example\n * Filter specific categories:\n * ```typescript\n * // Show only restaurants and hotels\n * pois.filterCategories({\n *   show: 'only',\n *   values: ['RESTAURANT', 'HOTEL_MOTEL']\n * });\n *\n * // Hide parking garages\n * pois.filterCategories({\n *   show: 'all_except',\n *   values: ['PARKING_GARAGE', 'OPEN_PARKING_AREA']\n * });\n * ```\n *\n * @example\n * Filter using category groups:\n * ```typescript\n * // Show only food and shopping POIs\n * pois.filterCategories({\n *   show: 'only',\n *   values: ['FOOD_DRINKS_GROUP', 'SHOPPING_GROUP']\n * });\n *\n * // Hide transportation POIs\n * pois.filterCategories({\n *   show: 'all_except',\n *   values: ['TRANSPORTATION_GROUP']\n * });\n * ```\n *\n * @example\n * Event handling:\n * ```typescript\n * pois.events.on('click', (feature, lngLat) => {\n *   console.log('Clicked POI:', feature.properties.name);\n *   console.log('Category:', feature.properties.category);\n * });\n * ```\n *\n * @see [POIs Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/pois)\n *\n * @group POIs\n */\nexport class POIsModule extends AbstractMapModule<PoIsSourcesAndLayers, POIsModuleConfig> {\n    private categoriesFilter?: ValuesFilter<FilterablePOICategory> | null;\n    private originalFilter?: FilterSpecification;\n\n    /**\n     * Retrieves a POIsModule instance for the given map.\n     *\n     * @param map - The TomTomMap instance to attach this module to.\n     * @param config - Optional initial configuration for visibility and filters.\n     *\n     * @returns A promise that resolves to the initialized POIsModule.\n     *\n     * @remarks\n     * **Configuration:**\n     * - `visible`: Initial visibility state\n     * - `filters.categories`: Category filter to apply on initialization\n     *\n     * @throws Error if the POI source is not found in the map style\n     *\n     * @example\n     * Default initialization:\n     * ```typescript\n     * const pois = await POIsModule.get(map);\n     * ```\n     *\n     * @example\n     * With initial filter:\n     * ```typescript\n     * const pois = await POIsModule.get(map, {\n     *   visible: true,\n     *   filters: {\n     *     categories: {\n     *       show: 'only',\n     *       values: ['RESTAURANT', 'CAFE_PUB']\n     *     }\n     *   }\n     * });\n     * ```\n     */\n    static async get(map: TomTomMap, config?: POIsModuleConfig): Promise<POIsModule> {\n        await waitUntilMapIsReady(map);\n        return new POIsModule(map, config);\n    }\n\n    private constructor(map: TomTomMap, config?: POIsModuleConfig) {\n        super('style', map, config);\n    }\n\n    /**\n     * @ignore\n     */\n    protected _initSourcesWithLayers() {\n        const poiRuntimeSource = this.mapLibreMap.getSource(POI_SOURCE_ID);\n        if (!poiRuntimeSource) {\n            throw notInTheStyle(`init ${POIsModule.name} with source ID ${POI_SOURCE_ID}`);\n        }\n        const poi = new StyleSourceWithLayers(this.mapLibreMap, poiRuntimeSource, (layer) =>\n            poiLayerIDs.includes(layer.id),\n        );\n        // TODO: check if the layers are present in the style, and if not, throw exception?\n        const mainLayer = poi.sourceAndLayerIDs.layerIDs[0];\n        if (this.mapLibreMap.getLayer(mainLayer)) {\n            this.originalFilter = this.mapLibreMap.getFilter(mainLayer) as FilterSpecification;\n        }\n        return { poi };\n    }\n\n    /**\n     * @ignore\n     */\n    protected _applyConfig(config: POIsModuleConfig | undefined) {\n        if (config && !isNil(config.visible)) {\n            this.setVisible(config.visible);\n        } else if (!this._initializing && !this.isVisible()) {\n            // applying default:\n            this.setVisible(true);\n        }\n\n        this.filterCategories(config?.filters?.categories);\n        return config;\n    }\n\n    /**\n     * Checks if POI layers are currently visible.\n     *\n     * @returns `true` if at least one POI layer is visible, `false` if all are hidden.\n     *\n     * @example\n     * ```typescript\n     * if (pois.isVisible()) {\n     *   console.log('POIs are displayed');\n     * }\n     * ```\n     */\n    isVisible(): boolean {\n        return this.sourcesWithLayers.poi.isAnyLayerVisible();\n    }\n\n    /**\n     * Sets the visibility of POI layers.\n     *\n     * @param visible - `true` to show POIs, `false` to hide them.\n     *\n     * @remarks\n     * Changes are applied immediately if the map is ready.\n     *\n     * @example\n     * ```typescript\n     * pois.setVisible(false); // Hide all POIs\n     * pois.setVisible(true);  // Show all POIs\n     * ```\n     */\n    setVisible(visible: boolean): void {\n        this.config = {\n            ...this.config,\n            visible,\n        };\n\n        if (this.tomtomMap.mapReady) {\n            this.sourcesWithLayers.poi.setLayersVisible(visible);\n        }\n    }\n\n    /**\n     * Filters POIs by category or category group.\n     *\n     * @param categoriesFilter - Filter configuration specifying which categories to show/hide.\n     * Pass `undefined` to reset to default (show all).\n     *\n     * @remarks\n     * **Filter Modes:**\n     * - `only`: Show only the specified categories, hide all others\n     * - `all_except`: Show all categories except the specified ones\n     *\n     * **Category Types:**\n     * - Individual categories (e.g., 'RESTAURANT', 'HOTEL_MOTEL')\n     * - Category groups (e.g., 'FOOD_DRINKS_GROUP', 'SHOPPING_GROUP')\n     *\n     * **Available Category Groups:**\n     * - FOOD_DRINKS_GROUP\n     * - SHOPPING_GROUP\n     * - TRANSPORTATION_GROUP\n     * - HEALTH_GROUP\n     * - PARKING_GROUP\n     * - HOLIDAY_TOURISM_GROUP\n     * - EV_CHARGING_STATIONS_GROUP\n     * - GAS_STATIONS_GROUP\n     * - ACCOMMODATION_GROUP\n     * - ENTERTAINMENT_GROUP\n     * - SPORTS_LEISURE_GROUP\n     * - EDUCATION_GROUP\n     * - GOVERNMENT_GROUP\n     *\n     * @example\n     * Show only restaurants:\n     * ```typescript\n     * pois.filterCategories({\n     *   show: 'only',\n     *   values: ['RESTAURANT']\n     * });\n     * ```\n     *\n     * @example\n     * Hide parking:\n     * ```typescript\n     * pois.filterCategories({\n     *   show: 'all_except',\n     *   values: ['PARKING_GROUP']\n     * });\n     * ```\n     *\n     * @example\n     * Reset filter (show all):\n     * ```typescript\n     * pois.filterCategories(undefined);\n     * ```\n     */\n    filterCategories(categoriesFilter?: ValuesFilter<FilterablePOICategory> | undefined): void {\n        if (categoriesFilter) {\n            if (this.tomtomMap.mapReady) {\n                const poiFilter = buildMappedValuesFilter(\n                    'category',\n                    categoriesFilter.show,\n                    getStyleCategories(categoriesFilter.values),\n                );\n\n                this.mapLibreMap.setFilter('POI', getMergedAllFilter(poiFilter, this.originalFilter));\n            }\n            this.config = {\n                ...this.config,\n                filters: {\n                    categories: categoriesFilter,\n                },\n            };\n        } else if (this.categoriesFilter) {\n            // reset categories config to default\n            this.config = {\n                ...this.config,\n                filters: {\n                    categories: {\n                        show: 'all_except',\n                        values: [],\n                    },\n                },\n            };\n            if (this.tomtomMap.mapReady) {\n                // Applies default:\n                this.mapLibreMap.setFilter('POI', this.originalFilter);\n            }\n        }\n\n        this.categoriesFilter = categoriesFilter;\n    }\n\n    /**\n     * Gets the events interface for handling user interactions with POIs.\n     *\n     * @returns An EventsModule instance for registering event handlers.\n     *\n     * @remarks\n     * **Supported Events:**\n     * - `click`: User clicks on a POI\n     * - `contextmenu`: User right-clicks on a POI\n     * - `hover`: Mouse enters a POI\n     * - `long-hover`: Mouse hovers over POI for extended time\n     *\n     * **Event Feature Properties:**\n     * - `id`: Unique POI identifier\n     * - `name`: POI name in native language\n     * - `category`: POI category\n     * - `iconID`: Icon sprite ID\n     * - `group`: Category group\n     * - `priority`: Importance level (lower = more important)\n     *\n     * @example\n     * ```typescript\n     * pois.events.on('click', (feature, lngLat) => {\n     *   console.log('POI:', feature.properties.name);\n     *   console.log('Category:', feature.properties.category);\n     *   console.log('ID:', feature.properties.id);\n     * });\n     *\n     * pois.events.on('hover', (feature) => {\n     *   showTooltip(feature.properties.name);\n     * });\n     * ```\n     */\n    get events() {\n        return new EventsModule<POIsModuleFeature>(this.tomtomMap._eventsProxy, this.sourcesWithLayers.poi);\n    }\n}\n","import type { LayerSpecification } from 'maplibre-gl';\nimport { poiLayerIDs } from '../pois';\nimport type { LayerSpecFilter } from '../shared';\nimport type { BaseMapLayerGroupName, BaseMapLayerGroups } from './types/baseMapModuleConfig';\n\ntype LayerGroupMapping = {\n    layerIDMatches: string[];\n    layerTypes: LayerSpecification['type'][];\n};\n\nconst layerGroupMappings: Record<BaseMapLayerGroupName, LayerGroupMapping> = {\n    land: {\n        layerIDMatches: ['lulc'],\n        layerTypes: ['fill'],\n    },\n    borders: {\n        layerIDMatches: ['borders'],\n        layerTypes: ['line'],\n    },\n    water: {\n        layerIDMatches: ['water'],\n        layerTypes: ['fill', 'line'],\n    },\n    buildings2D: {\n        layerIDMatches: ['building'],\n        layerTypes: ['fill', 'line'],\n    },\n    buildings3D: {\n        layerIDMatches: ['building'],\n        layerTypes: ['fill-extrusion'],\n    },\n    houseNumbers: {\n        layerIDMatches: ['house number'],\n        layerTypes: ['symbol'],\n    },\n    roadLines: {\n        layerIDMatches: ['road', 'tunnel', 'bridge', 'surface'],\n        layerTypes: ['fill', 'line'],\n    },\n    roadLabels: {\n        layerIDMatches: ['road', 'tunnel', 'bridge', 'surface'],\n        layerTypes: ['symbol'],\n    },\n    roadShields: {\n        layerIDMatches: ['shield'],\n        layerTypes: ['symbol'],\n    },\n    placeLabels: {\n        layerIDMatches: ['places'],\n        layerTypes: ['symbol'],\n    },\n    smallerTownLabels: {\n        layerIDMatches: ['town', 'village', 'neighbourhood'],\n        layerTypes: ['symbol'],\n    },\n    cityLabels: {\n        layerIDMatches: ['city', 'capital'],\n        layerTypes: ['symbol'],\n    },\n    capitalLabels: {\n        layerIDMatches: ['capital'],\n        layerTypes: ['symbol'],\n    },\n    stateLabels: {\n        layerIDMatches: ['state'],\n        layerTypes: ['symbol'],\n    },\n    countryLabels: {\n        layerIDMatches: ['places - country'],\n        layerTypes: ['symbol'],\n    },\n};\n\nconst isMatching = (group: BaseMapLayerGroupName, layer: LayerSpecification) => {\n    const mapping = layerGroupMappings[group];\n    return (\n        mapping.layerIDMatches.some((part) => layer.id.toLowerCase().includes(part)) &&\n        mapping.layerTypes.includes(layer.type)\n    );\n};\n\n/**\n * @ignore\n */\nexport const buildLayerGroupFilter = (layerGroups: BaseMapLayerGroups): LayerSpecFilter => {\n    const mode = layerGroups.mode;\n    const groups = layerGroups.names;\n    if (mode === 'include') {\n        return (layer) => groups.some((group) => isMatching(group, layer));\n    }\n    if (mode === 'exclude') {\n        return (layer) => !groups.some((group) => isMatching(group, layer));\n    }\n    // No filtering if we don't recognize the mode:\n    console.error('Unrecognized layer group mode:', mode);\n    return () => true;\n};\n\n/**\n * @ignore\n */\nexport const filterLayerByGroups = (layer: LayerSpecification, layerGroups?: BaseMapLayerGroups): boolean => {\n    const mode = layerGroups?.mode;\n    const groups = layerGroups?.names;\n    if (mode && groups?.length) {\n        if (mode === 'include') {\n            return groups.some((group) => isMatching(group, layer));\n        }\n        if (mode === 'exclude') {\n            return !groups.some((group) => isMatching(group, layer));\n        }\n    }\n    return true;\n};\n\n/**\n * @ignore\n */\nexport const buildBaseMapLayerGroupFilter =\n    (layerGroupsFilter?: BaseMapLayerGroups): LayerSpecFilter =>\n    (layer: LayerSpecification): boolean =>\n        (!layerGroupsFilter || filterLayerByGroups(layer, layerGroupsFilter)) && !poiLayerIDs.includes(layer.id);\n","import { isNil } from 'lodash-es';\n\nimport { AbstractMapModule, BASE_MAP_SOURCE_ID, EventsModule, StyleSourceWithLayers } from '../shared';\nimport { notInTheStyle } from '../shared/errorMessages';\nimport { waitUntilMapIsReady } from '../shared/mapUtils';\nimport { TomTomMap } from '../TomTomMap';\nimport { buildBaseMapLayerGroupFilter, buildLayerGroupFilter } from './layerGroups';\nimport type { BaseMapLayerGroups, BaseMapModuleConfig, BaseMapModuleInitConfig } from './types/baseMapModuleConfig';\n\ntype BaseSourceAndLayers = {\n    vectorTiles: StyleSourceWithLayers;\n};\n\n/**\n * Base Map Module for controlling standard map layers and their visibility.\n *\n * This module manages the fundamental map layers including background, water, land, roads,\n * buildings, labels, and other vector tile layers from the base map style.\n *\n * @remarks\n * **Managed Layers:**\n * - Background and terrain\n * - Water bodies and coastlines\n * - Country and administrative borders\n * - Buildings (2D and 3D)\n * - Road lines, labels, and shields\n * - Place labels at various zoom levels\n * - House numbers\n *\n * **Does NOT Include:**\n * - Traffic flow/incidents (use {@link TrafficFlowModule} or {@link TrafficIncidentsModule})\n * - Points of Interest/POIs (use {@link POIsModule})\n * - Hillshade/terrain shading (use {@link HillshadeModule})\n *\n * **Use Cases:**\n * - Toggle base map visibility on/off\n * - Show only specific layer groups (e.g., roads only)\n * - Create custom map appearances by hiding certain elements\n * - Build overlay maps with selective base layers\n *\n * @example\n * Basic usage:\n * ```typescript\n * // Get module with default configuration\n * const baseMap = await BaseMapModule.get(map);\n *\n * // Toggle visibility\n * baseMap.setVisible(false); // Hide all base layers\n * baseMap.setVisible(true);  // Show all base layers\n *\n * // Check current state\n * if (baseMap.isVisible()) {\n *   console.log('Base map is visible');\n * }\n * ```\n *\n * @example\n * Working with layer groups:\n * ```typescript\n * // Show only roads and borders\n * const baseMap = await BaseMapModule.get(map, {\n *   layerGroupsFilter: {\n *     mode: 'include',\n *     names: ['roadLines', 'roadLabels', 'borders']\n *   }\n * });\n *\n * // Hide buildings and labels\n * baseMap.setVisible(false, {\n *   layerGroups: {\n *     mode: 'include',\n *     names: ['buildings2D', 'buildings3D', 'placeLabels']\n *   }\n * });\n *\n * // Show only water and land\n * baseMap.setVisible(true, {\n *   layerGroups: {\n *     mode: 'include',\n *     names: ['water', 'land']\n *   }\n * });\n * ```\n *\n * @example\n * Event handling:\n * ```typescript\n * const baseMap = await BaseMapModule.get(map);\n *\n * // Listen for clicks on base map features\n * baseMap.events.on('click', (feature, lngLat) => {\n *   console.log('Clicked base map feature:', feature);\n * });\n *\n * // Remove event listeners\n * baseMap.events.off('click');\n * ```\n *\n * @see [Base Map Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/base-map)\n * @see [Map Styles Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/map-styles)\n *\n * @group Base Map\n */\nexport class BaseMapModule extends AbstractMapModule<BaseSourceAndLayers, BaseMapModuleConfig> {\n    /**\n     * Asynchronously retrieves a BaseMapModule instance for the given map.\n     *\n     * This is the recommended way to create a BaseMapModule. It ensures the map\n     * is fully loaded before initializing the module.\n     *\n     * @param tomtomMap - The TomTomMap instance to attach this module to.\n     * @param config - Optional configuration for module initialization.\n     *\n     * @returns A promise that resolves to the initialized BaseMapModule.\n     *\n     * @remarks\n     * **Initialization:**\n     * - Waits for map to be ready before creating module\n     * - Validates that required sources exist in the map style\n     * - Applies initial configuration if provided\n     *\n     * **Configuration Options:**\n     * - `visible`: Initial visibility state\n     * - `layerGroupsFilter`: Which layer groups to include/exclude\n     * - `layerGroupsVisibility`: Fine-grained visibility per group\n     *\n     * @throws Error if the base map source is not found in the style\n     *\n     * @example\n     * Default initialization:\n     * ```typescript\n     * const baseMap = await BaseMapModule.get(map);\n     * ```\n     *\n     * @example\n     * With configuration:\n     * ```typescript\n     * const baseMap = await BaseMapModule.get(map, {\n     *   visible: true,\n     *   layerGroupsFilter: {\n     *     mode: 'exclude',\n     *     names: ['buildings3D', 'houseNumbers']\n     *   }\n     * });\n     * ```\n     *\n     * @example\n     * Show only specific groups:\n     * ```typescript\n     * const baseMap = await BaseMapModule.get(map, {\n     *   layerGroupsFilter: {\n     *     mode: 'include',\n     *     names: ['water', 'land', 'borders']\n     *   },\n     *   visible: true\n     * });\n     * ```\n     */\n    static async get(tomtomMap: TomTomMap, config?: BaseMapModuleInitConfig): Promise<BaseMapModule> {\n        await waitUntilMapIsReady(tomtomMap);\n        return new BaseMapModule(tomtomMap, config);\n    }\n\n    private constructor(map: TomTomMap, config?: BaseMapModuleConfig) {\n        super('style', map, config);\n    }\n\n    /**\n     * @ignore\n     */\n    protected _initSourcesWithLayers(config: BaseMapModuleInitConfig | undefined) {\n        const source = this.mapLibreMap.getSource(BASE_MAP_SOURCE_ID);\n        if (!source) {\n            throw notInTheStyle(`init ${BaseMapModule.name} with source ID ${BASE_MAP_SOURCE_ID}`);\n        }\n\n        return {\n            vectorTiles: new StyleSourceWithLayers(\n                this.mapLibreMap,\n                source,\n                buildBaseMapLayerGroupFilter(config?.layerGroupsFilter),\n            ),\n        };\n    }\n\n    /**\n     * @ignore\n     */\n    protected _applyConfig(config: BaseMapModuleConfig | undefined) {\n        if (config && !isNil(config.visible)) {\n            this.setVisible(config.visible);\n        } else if (!this._initializing && !this.isVisible()) {\n            // applying default:\n            this.setVisible(true);\n        }\n\n        if (config?.layerGroupsVisibility) {\n            this.setVisible(config.layerGroupsVisibility.visible, { layerGroups: config.layerGroupsVisibility });\n        }\n\n        // We merge the given config with the previous one to ensure init config parameters are kept:\n        // (the init config can have more parameters than the runtime one)\n        return { ...this.config, ...config };\n    }\n\n    /**\n     * Checks if any base map layers are currently visible.\n     *\n     * @returns `true` if at least one base map layer is visible, `false` if all are hidden.\n     *\n     * @remarks\n     * This checks the actual visibility state of layers in the map, not just the\n     * module's configuration setting.\n     *\n     * @example\n     * ```typescript\n     * if (baseMap.isVisible()) {\n     *   console.log('Base map is rendered');\n     * } else {\n     *   console.log('Base map is hidden');\n     * }\n     * ```\n     */\n    isVisible(): boolean {\n        return this.sourcesWithLayers.vectorTiles.isAnyLayerVisible();\n    }\n\n    /**\n     * Sets the visibility of base map layers.\n     *\n     * @param visible - `true` to show layers, `false` to hide them.\n     * @param options - Optional settings for fine-grained control.\n     * @param options.layerGroups - Target specific layer groups instead of all layers.\n     *\n     * @remarks\n     * **Behavior:**\n     * - Without `options.layerGroups`: Affects all base map layers\n     * - With `options.layerGroups`: Affects only specified layer groups\n     * - Changes are applied immediately if map is ready\n     *\n     * **Layer Groups:**\n     * Available groups: `land`, `water`, `borders`, `buildings2D`, `buildings3D`,\n     * `houseNumbers`, `roadLines`, `roadLabels`, `roadShields`, `placeLabels`,\n     * `smallerTownLabels`, `cityLabels`, `capitalLabels`, `stateLabels`, `countryLabels`\n     *\n     * @example\n     * Show/hide all layers:\n     * ```typescript\n     * baseMap.setVisible(false); // Hide everything\n     * baseMap.setVisible(true);  // Show everything\n     * ```\n     *\n     * @example\n     * Control specific groups:\n     * ```typescript\n     * // Hide only buildings\n     * baseMap.setVisible(false, {\n     *   layerGroups: {\n     *     mode: 'include',\n     *     names: ['buildings2D', 'buildings3D']\n     *   }\n     * });\n     *\n     * // Show everything except labels\n     * baseMap.setVisible(true, {\n     *   layerGroups: {\n     *     mode: 'exclude',\n     *     names: ['placeLabels', 'cityLabels', 'countryLabels']\n     *   }\n     * });\n     * ```\n     *\n     * @example\n     * Toggle visibility:\n     * ```typescript\n     * const isVisible = baseMap.isVisible();\n     * baseMap.setVisible(!isVisible); // Toggle\n     * ```\n     */\n    setVisible(visible: boolean, options?: { layerGroups?: BaseMapLayerGroups }): void {\n        if (!options?.layerGroups) {\n            // We remove the layer groups visibility from the config if it was there:\n            delete this.config?.layerGroupsVisibility;\n            this.config = { ...this.config, visible };\n        } else {\n            this.config = { ...this.config, layerGroupsVisibility: { ...options.layerGroups, visible } };\n        }\n\n        if (this.tomtomMap.mapReady) {\n            this.sourcesWithLayers.vectorTiles.setLayersVisible(\n                visible,\n                options?.layerGroups && buildLayerGroupFilter(options.layerGroups),\n            );\n        }\n    }\n\n    /**\n     * Gets the events interface for this module to handle user interactions.\n     *\n     * @returns An EventsModule instance for registering event handlers.\n     *\n     * @remarks\n     * **Supported Events:**\n     * - `click`: User clicks on a base map feature\n     * - `contextmenu`: User right-clicks on a feature\n     * - `hover`: Mouse enters a feature\n     * - `long-hover`: Mouse hovers over a feature for extended time\n     *\n     * **Event Handler Signature:**\n     * ```typescript\n     * (feature: MapGeoJSONFeature, lngLat: LngLat, allFeatures: MapGeoJSONFeature[]) => void\n     * ```\n     *\n     * @example\n     * Register click handler:\n     * ```typescript\n     * baseMap.events.on('click', (feature, lngLat) => {\n     *   console.log('Clicked on:', feature.properties);\n     *   console.log('At coordinates:', lngLat);\n     * });\n     * ```\n     *\n     * @example\n     * Multiple event types:\n     * ```typescript\n     * // Show tooltip on hover\n     * baseMap.events.on('hover', (feature) => {\n     *   showTooltip(feature.properties.name);\n     * });\n     *\n     * // Handle clicks\n     * baseMap.events.on('click', (feature) => {\n     *   selectFeature(feature.id);\n     * });\n     *\n     * // Clean up\n     * baseMap.events.off('hover');\n     * baseMap.events.off('click');\n     * ```\n     */\n    get events() {\n        return new EventsModule(this.tomtomMap._eventsProxy, this.sourcesWithLayers.vectorTiles);\n    }\n}\n","/**\n * Available base map layer group identifiers.\n *\n * @remarks\n * Use these names with {@link BaseMapModule} to control layer visibility.\n *\n * @see {@link BaseMapLayerGroupName}\n * @see {@link BaseMapModuleInitConfig.layerGroupsFilter}\n *\n * @group Base Map\n */\nexport const baseMapLayerGroupNames = [\n    'land',\n    'water',\n    'borders',\n    'buildings2D',\n    'buildings3D',\n    'houseNumbers',\n    'roadLines',\n    'roadLabels',\n    'roadShields',\n    'placeLabels',\n    'smallerTownLabels',\n    'cityLabels',\n    'capitalLabels',\n    'stateLabels',\n    'countryLabels',\n] as const;\n\n/**\n * Name of a base map layer group.\n *\n * Identifies specific categories of base map layers that can be controlled together.\n *\n * @remarks\n * **Available Layer Groups:**\n * - `land` - Land areas and terrain\n * - `water` - Water bodies (oceans, lakes, rivers)\n * - `borders` - Country and administrative boundaries\n * - `buildings2D` - 2D building footprints\n * - `buildings3D` - 3D building models\n * - `houseNumbers` - House number labels\n * - `roadLines` - Road line geometries\n * - `roadLabels` - Street name labels\n * - `roadShields` - Highway shields (e.g., I-95, A1)\n * - `placeLabels` - General place labels\n * - `smallerTownLabels` - Small town/village labels\n * - `cityLabels` - City labels\n * - `capitalLabels` - Capital city labels\n * - `stateLabels` - State/province labels\n * - `countryLabels` - Country name labels\n *\n * @example\n * ```typescript\n * const group: BaseMapLayerGroupName = 'roadLines';\n * const labels: BaseMapLayerGroupName[] = ['cityLabels', 'countryLabels'];\n * ```\n *\n * @group Base Map\n */\nexport type BaseMapLayerGroupName = (typeof baseMapLayerGroupNames)[number];\n\n/**\n * Layer group visibility configuration with explicit visible state.\n *\n * Extends {@link BaseMapLayerGroups} to include a visibility flag, allowing\n * you to show or hide specific groups of base map layers.\n *\n * @example\n * ```typescript\n * // Hide all buildings\n * const config: BaseMapLayerGroupsVisibility = {\n *   mode: 'include',\n *   names: ['buildings2D', 'buildings3D'],\n *   visible: false\n * };\n *\n * // Show only roads\n * const roadsOnly: BaseMapLayerGroupsVisibility = {\n *   mode: 'include',\n *   names: ['roadLines', 'roadLabels'],\n *   visible: true\n * };\n * ```\n *\n * @group Base Map\n */\nexport type BaseMapLayerGroupsVisibility = BaseMapLayerGroups & { visible: boolean };\n\n/**\n * Layer group filter for selective base map display.\n *\n * Defines which layer groups to include or exclude from the base map module.\n * Can be expressed as explicit inclusions (show only these) or exclusions\n * (show all except these).\n *\n * @remarks\n * **Filter Modes:**\n * - `include`: Only the specified groups are shown, all others are hidden\n * - `exclude`: All groups are shown except the specified ones\n *\n * **Common Use Cases:**\n * - Show only roads and labels (minimal map)\n * - Hide buildings for cleaner appearance\n * - Show only water and land (base terrain)\n * - Remove labels for overlay maps\n *\n * @example\n * ```typescript\n * // Show only roads and borders\n * const roadsOnly: BaseMapLayerGroups = {\n *   mode: 'include',\n *   names: ['roadLines', 'roadLabels', 'borders']\n * };\n *\n * // Show everything except buildings\n * const noBuildings: BaseMapLayerGroups = {\n *   mode: 'exclude',\n *   names: ['buildings2D', 'buildings3D']\n * };\n *\n * // Show only terrain (no labels, no roads)\n * const terrainOnly: BaseMapLayerGroups = {\n *   mode: 'include',\n *   names: ['land', 'water']\n * };\n * ```\n *\n * @group Base Map\n */\nexport type BaseMapLayerGroups = {\n    /**\n     * Filter mode determining whether groups are included or excluded.\n     *\n     * @remarks\n     * - `include`: Only the specified groups are considered, all others are ignored\n     * - `exclude`: All base map groups except the specified ones are considered\n     *\n     * @example\n     * ```typescript\n     * mode: 'include'  // Whitelist approach\n     * mode: 'exclude'  // Blacklist approach\n     * ```\n     */\n    mode: 'include' | 'exclude';\n\n    /**\n     * Names of the layer groups to include or exclude.\n     *\n     * @remarks\n     * The meaning depends on the `mode`:\n     * - In `include` mode: Only these groups will be shown\n     * - In `exclude` mode: These groups will be hidden, all others shown\n     *\n     * @example\n     * ```typescript\n     * // Show only these\n     * names: ['roadLines', 'roadLabels', 'water']\n     *\n     * // Hide these\n     * names: ['buildings2D', 'buildings3D', 'houseNumbers']\n     * ```\n     */\n    names: BaseMapLayerGroupName[];\n};\n\n/**\n * Configuration for the BaseMapModule (initialization or runtime).\n *\n * Controls visibility and behavior of base map layer groups. Can be used both\n * during module initialization and for runtime updates.\n *\n * @remarks\n * This configuration allows fine-grained control over which base map elements\n * are displayed, enabling you to create custom map appearances for different\n * use cases.\n *\n * @example\n * ```typescript\n * // Hide specific layer groups\n * const config: BaseMapModuleConfig = {\n *   layerGroupsVisibility: {\n *     mode: 'include',\n *     names: ['buildings2D', 'buildings3D'],\n *     visible: false\n *   }\n * };\n *\n * // Show only certain groups\n * const minimalConfig: BaseMapModuleConfig = {\n *   visible: true,\n *   layerGroupsVisibility: {\n *     mode: 'include',\n *     names: ['roadLines', 'water', 'land'],\n *     visible: true\n *   }\n * };\n * ```\n *\n * @group Base Map\n */\nexport type BaseMapModuleConfig = {\n    /**\n     * Controls the visibility of all layers associated with this module.\n     *\n     * @default true\n     */\n    visible?: boolean;\n\n    /**\n     * Optional visibility configuration for specific layer groups.\n     *\n     * @remarks\n     * **Important:** The layer groups specified here must be included in the\n     * module (not excluded by `layerGroupsFilter` during initialization).\n     *\n     * Use this to control visibility of layer groups at runtime without\n     * reinitializing the module.\n     *\n     * @example\n     * ```typescript\n     * // Hide all building layers\n     * layerGroupsVisibility: {\n     *   mode: 'include',\n     *   names: ['buildings2D', 'buildings3D'],\n     *   visible: false\n     * }\n     *\n     * // Show only labels\n     * layerGroupsVisibility: {\n     *   mode: 'include',\n     *   names: ['placeLabels', 'cityLabels', 'countryLabels'],\n     *   visible: true\n     * }\n     * ```\n     */\n    layerGroupsVisibility?: BaseMapLayerGroupsVisibility;\n};\n\n/**\n * Initialization configuration for the BaseMapModule.\n *\n * Extends {@link BaseMapModuleConfig} with additional options available only\n * during module initialization.\n *\n * @remarks\n * **Initialization vs Runtime:**\n * - `layerGroupsFilter`: Only available at init - determines which groups to load\n * - `layerGroupsVisibility`: Available at init and runtime - controls visibility\n *\n * **Use Cases:**\n * - Create minimal maps with only essential layers\n * - Build custom map styles by excluding certain features\n * - Optimize performance by not loading unnecessary layers\n *\n * @example\n * ```typescript\n * // Initialize with only roads and water\n * const initConfig: BaseMapModuleInitConfig = {\n *   layerGroupsFilter: {\n *     mode: 'include',\n *     names: ['roadLines', 'roadLabels', 'water', 'land']\n *   },\n *   visible: true\n * };\n *\n * // Exclude buildings from initialization\n * const noBuildingsConfig: BaseMapModuleInitConfig = {\n *   layerGroupsFilter: {\n *     mode: 'exclude',\n *     names: ['buildings2D', 'buildings3D', 'houseNumbers']\n *   }\n * };\n *\n * // Minimal map for data overlay\n * const overlayBaseConfig: BaseMapModuleInitConfig = {\n *   layerGroupsFilter: {\n *     mode: 'include',\n *     names: ['water', 'land', 'borders']\n *   },\n *   visible: true\n * };\n * ```\n *\n * @group Base Map\n */\nexport type BaseMapModuleInitConfig = BaseMapModuleConfig & {\n    /**\n     * Layer groups to include/exclude during module initialization.\n     *\n     * @remarks\n     * **One-time configuration:** This can only be set during initialization.\n     * Once the module is created, you cannot change which groups are loaded,\n     * only their visibility via `layerGroupsVisibility`.\n     *\n     * @example\n     * ```typescript\n     * // Load only essential layers\n     * layerGroupsFilter: {\n     *   mode: 'include',\n     *   names: ['land', 'water', 'roadLines', 'borders']\n     * }\n     *\n     * // Load everything except 3D buildings\n     * layerGroupsFilter: {\n     *   mode: 'exclude',\n     *   names: ['buildings3D']\n     * }\n     *\n     * // Minimal overlay map\n     * layerGroupsFilter: {\n     *   mode: 'include',\n     *   names: ['water', 'land']\n     * }\n     * ```\n     */\n    layerGroupsFilter?: BaseMapLayerGroups;\n};\n","import type { Anything, CommonPlaceProps } from '@tomtom-org/maps-sdk/core';\nimport type { SupportsEvents } from '../../shared';\n\n/**\n * Extra properties to display color and title for a geometry on the map.\n *\n * Provides customization options for rendering polygon geometries, including\n * visual styling and labeling.\n *\n * @remarks\n * **Use Cases:**\n * - Search result boundaries (e.g., city limits, postal codes)\n * - Reachable range polygons\n * - Delivery zones\n * - Custom area highlights\n *\n * These properties override default styling and allow per-feature customization.\n *\n * @example\n * ```typescript\n * const geometryProps: ExtraGeometryDisplayProps = {\n *   title: 'Amsterdam City Center',\n *   color: '#FF5733',\n *   eventState: 'click'\n * };\n *\n * // With custom properties\n * const customProps: ExtraGeometryDisplayProps = {\n *   title: 'Delivery Zone A',\n *   color: '#00FF00',\n *   zoneId: 'zone-a',\n *   capacity: 100\n * };\n * ```\n *\n * @group Geometries\n */\nexport type ExtraGeometryDisplayProps = {\n    /**\n     * Display title for the geometry.\n     *\n     * @remarks\n     * Optional text label displayed at the center of the polygon.\n     * If not provided, no label will be shown.\n     *\n     * **Common Uses:**\n     * - Area names (e.g., \"Downtown\", \"Zone A\")\n     * - Statistics (e.g., \"30 min reachable\")\n     * - Custom labels\n     *\n     * @example\n     * ```typescript\n     * title: 'Amsterdam City Center'\n     * title: 'Zone A'\n     * title: '30 min driving range'\n     * title: undefined  // No label\n     * ```\n     */\n    title?: string;\n\n    /**\n     * Fill color for the geometry.\n     *\n     * @remarks\n     * Overrides the default fill color from the module configuration.\n     * Accepts any valid CSS color value.\n     *\n     * **Color Formats:**\n     * - Hex: '#FF5733'\n     * - RGB: 'rgb(255, 87, 51)'\n     * - RGBA: 'rgba(255, 87, 51, 0.5)'\n     * - Named: 'red', 'blue', 'green'\n     *\n     * @example\n     * ```typescript\n     * color: '#FF5733'\n     * color: 'rgb(0, 128, 255)'\n     * color: 'rgba(255, 0, 0, 0.5)'\n     * color: 'red'\n     * ```\n     */\n    color?: string;\n} & SupportsEvents &\n    Anything;\n\n/**\n * Geometry base and display properties.\n *\n * Combines complete place information with geometry-specific display properties\n * for rendering polygon features on the map.\n *\n * @remarks\n * Used by the GeometriesModule for rendering:\n * - Search API geometry results\n * - Reachable range polygons\n * - Custom polygon overlays\n * - Administrative boundaries\n *\n * Includes both geographic/metadata and visual styling properties.\n *\n * @example\n * ```typescript\n * const geometry: DisplayGeometryProps = {\n *   type: 'Polygon',\n *   id: 'geom-123',\n *   title: 'Amsterdam',\n *   color: '#0080FF',\n *   address: {\n *     municipalitySubdivision: 'Amsterdam',\n *     countryCode: 'NL'\n *   }\n * };\n * ```\n *\n * @group Geometries\n */\nexport type DisplayGeometryProps = CommonPlaceProps & ExtraGeometryDisplayProps;\n\n/**\n * @ignore\n */\nexport const GEOMETRY_TITLE_PROP = 'title';\n\n/**\n * @ignore\n */\nexport const GEOMETRY_COLOR_PROP = 'color';\n","import type { FillLayerSpecification, LineLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { GEOMETRY_COLOR_PROP } from '../types/geometryDisplayProps';\n\nexport const colorPalettes = {\n    warm: [\n        '#793F0D',\n        '#AC703D',\n        '#C38E63',\n        '#E49969',\n        '#E5AE86',\n        '#EEC5A9',\n        '#6E7649',\n        '#9D9754',\n        '#C7C397',\n        '#B4A851',\n        '#DFD27C',\n        '#E7E3B5',\n        '#846D74',\n        '#B7A6AD',\n        '#D3C9CE',\n    ],\n    browns: [\n        '#edc4b3',\n        '#e6b8a2',\n        '#deab90',\n        '#d69f7e',\n        '#cd9777',\n        '#c38e70',\n        '#b07d62',\n        '#9d6b53',\n        '#8a5a44',\n        '#774936',\n    ],\n    cold: ['#344464', '#548ca4', '#549cac', '#2c445c', '#a4ccd4', '#acbccc', '#b4c4d4', '#acd4cc', '#5c8ca4'],\n    fadedBlues: [\n        '#152033',\n        '#1d2d44',\n        '#2e455d',\n        '#3e5c76',\n        '#4c6884',\n        '#597491',\n        '#67809e',\n        '#6e86a5',\n        '#7b91ad',\n        '#879bb4',\n    ],\n    blues: ['#03045e', '#023e8a', '#0077b6', '#0096c7', '#00b4d8', '#48cae4', '#90e0ef', '#ade8f4', '#caf0f8'],\n    greens: ['#004b23', '#006400', '#007200', '#008000', '#38b000', '#70e000', '#9ef01a', '#ccff33'],\n    fadedGreenToBlue: [\n        '#d9ed92',\n        '#b5e48c',\n        '#99d98c',\n        '#76c893',\n        '#52b69a',\n        '#34a0a4',\n        '#168aad',\n        '#1a759f',\n        '#1e6091',\n        '#184e77',\n    ],\n    blueToRed: [\n        '#033270',\n        '#1368aa',\n        '#4091c9',\n        '#9dcee2',\n        '#fedfd4',\n        '#f29479',\n        '#f26a4f',\n        '#ef3c2d',\n        '#cb1b16',\n        '#65010c',\n    ],\n    greenToYellow: [\n        '#007f5f',\n        '#2b9348',\n        '#55a630',\n        '#80b918',\n        '#aacc00',\n        '#bfd200',\n        '#d4d700',\n        '#dddf00',\n        '#eeef20',\n        '#ffff3f',\n    ],\n    pastel: [\n        '#fec5bb',\n        '#fcd5ce',\n        '#fae1dd',\n        '#f8edeb',\n        '#e8e8e4',\n        '#d8e2dc',\n        '#ece4db',\n        '#ffe5d9',\n        '#ffd7ba',\n        '#fec89a',\n    ],\n    retro: [\n        '#f94144',\n        '#f3722c',\n        '#f8961e',\n        '#f9844a',\n        '#f9c74f',\n        '#90be6d',\n        '#43aa8b',\n        '#4d908e',\n        '#577590',\n        '#277da1',\n    ],\n    contrastRetro: [\n        '#001219',\n        '#005f73',\n        '#0a9396',\n        '#94d2bd',\n        '#e9d8a6',\n        '#ee9b00',\n        '#ca6702',\n        '#bb3e03',\n        '#ae2012',\n        '#9b2226',\n    ],\n    fadedRainbow: ['#ffadad', '#ffd6a5', '#fdffb6', '#caffbf', '#9bf6ff', '#a0c4ff', '#bdb2ff', '#ffc6ff', '#fffffc'],\n    pastelRainbow: [\n        '#54478c',\n        '#2c699a',\n        '#048ba8',\n        '#0db39e',\n        '#16db93',\n        '#83e377',\n        '#b9e769',\n        '#efea5a',\n        '#f1c453',\n        '#f29e4c',\n    ],\n};\n\nexport type ColorPaletteOptions = keyof typeof colorPalettes;\n\nconst defaultColor = '#0A3653';\n\n/**\n * @ignore\n */\nexport const geometryFillSpec: LayerSpecTemplate<FillLayerSpecification> = {\n    type: 'fill',\n    paint: {\n        'fill-color': ['coalesce', ['get', GEOMETRY_COLOR_PROP], defaultColor],\n        'fill-opacity': 0.15,\n        'fill-antialias': false,\n    },\n};\n\n/**\n * @ignore\n */\nexport const geometryOutlineSpec: LayerSpecTemplate<LineLayerSpecification> = {\n    type: 'line',\n    paint: {\n        'line-color': defaultColor,\n        'line-opacity': 0.45,\n        'line-width': 2,\n    },\n};\n","import type { PolygonFeatures } from '@tomtom-org/maps-sdk/core';\nimport { bboxCenter, bboxFromCoordsArray } from '@tomtom-org/maps-sdk/core';\nimport type { Feature, FeatureCollection, GeoJsonProperties, MultiPolygon, Point, Polygon, Position } from 'geojson';\nimport { isNil } from 'lodash-es';\nimport type { DataDrivenPropertyValueSpecification, SymbolLayerSpecification } from 'maplibre-gl';\nimport type { SymbolLayerSpecWithoutSource } from '../shared';\nimport { MAP_BOLD_FONT } from '../shared/layers/commonLayerProps';\nimport type { ColorPaletteOptions } from './layers/geometryLayers';\nimport { colorPalettes, geometryFillSpec, geometryOutlineSpec } from './layers/geometryLayers';\nimport type { GeometriesModuleConfig } from './types/geometriesModuleConfig';\nimport type { DisplayGeometryProps, ExtraGeometryDisplayProps } from './types/geometryDisplayProps';\nimport { GEOMETRY_TITLE_PROP } from './types/geometryDisplayProps';\n\n/**\n * Builds Geometry layer specifications for fill and outline layers.\n * @ignore\n */\nexport const buildGeometryLayerSpecs = (\n    fillLayerId: string,\n    outlineLayerId: string,\n    config?: GeometriesModuleConfig,\n): [SymbolLayerSpecWithoutSource, SymbolLayerSpecWithoutSource] => {\n    const colorConfig = config?.colorConfig;\n    const lineConfig = config?.lineConfig;\n\n    const fillLayerSpec = {\n        ...geometryFillSpec,\n        id: fillLayerId,\n        paint: {\n            ...geometryFillSpec.paint,\n            ...(!isNil(colorConfig?.fillOpacity) && { 'fill-opacity': colorConfig?.fillOpacity }),\n            ...(colorConfig?.fillColor && { 'fill-color': ['get', 'color'] }),\n        },\n    } as unknown as SymbolLayerSpecWithoutSource;\n\n    const outlineLayerSpec = {\n        ...geometryOutlineSpec,\n        id: outlineLayerId,\n        paint: {\n            ...geometryOutlineSpec.paint,\n            ...(!isNil(lineConfig?.lineColor) && { 'line-color': lineConfig?.lineColor }),\n            ...(!isNil(lineConfig?.lineWidth) && { 'line-width': lineConfig?.lineWidth }),\n            ...(!isNil(lineConfig?.lineOpacity) && { 'line-opacity': lineConfig?.lineOpacity }),\n        },\n    } as unknown as SymbolLayerSpecWithoutSource;\n\n    return [fillLayerSpec, outlineLayerSpec];\n};\n\n/**\n * Build geometry Title. The type can be a string or a Maplibre expression.\n * @param feature - Geometry\n * @param config - Geometry module configuration\n * @returns\n */\nconst buildTitle = (\n    feature: Feature<Polygon | MultiPolygon, DisplayGeometryProps | GeoJsonProperties>,\n    config: GeometriesModuleConfig,\n): DataDrivenPropertyValueSpecification<string> | string | undefined => {\n    if (config.textConfig?.textField) {\n        return config.textConfig.textField;\n    }\n\n    return feature.properties?.address?.freeformAddress;\n};\n\n/**\n * Builds a geometry color string or MapLibre expression.\n * @param config - Geometry module configuration\n * @param index - Number to use as index to pick color from palette option\n */\nconst buildColor = (\n    config: GeometriesModuleConfig,\n    index: number,\n): DataDrivenPropertyValueSpecification<string> | string | undefined => {\n    const color = config?.colorConfig?.fillColor;\n\n    if (typeof color === 'string' && colorPalettes[color as ColorPaletteOptions]) {\n        const palette = colorPalettes[color as ColorPaletteOptions];\n        return palette[index % palette.length];\n    }\n\n    return color;\n};\n\n/**\n * Build geometry layer specification for title\n * @param layerID\n * @param config\n * @returns\n * @ignore\n */\nexport const buildGeometryTitleLayerSpec = (\n    layerId: string,\n    config?: GeometriesModuleConfig,\n): Omit<SymbolLayerSpecification, 'source'> => {\n    const textConfig = config?.textConfig;\n\n    return {\n        type: 'symbol',\n        id: layerId,\n        layout: {\n            'text-field': ['get', GEOMETRY_TITLE_PROP],\n            ...(textConfig?.textField && { 'text-field': textConfig.textField }),\n            'text-padding': 5,\n            'text-size': 12,\n            'text-font': [MAP_BOLD_FONT],\n            'symbol-placement': 'point',\n        },\n        paint: {\n            'text-color': '#333333',\n            'text-halo-color': '#FFFFFF',\n            'text-halo-width': ['interpolate', ['linear'], ['zoom'], 6, 1, 10, 1.5],\n            'text-translate-anchor': 'viewport',\n        },\n    };\n};\n\n/**\n * Prepare geometry for display.\n * If colorConfig is set, it will apply the property \"color\" to \"properties\" in each feature.\n * @param geometry\n * @param config\n * @returns\n * @ignore\n */\nexport const prepareGeometryForDisplay = (\n    geometry: PolygonFeatures<GeoJsonProperties | DisplayGeometryProps>,\n    config: GeometriesModuleConfig = {},\n): PolygonFeatures<ExtraGeometryDisplayProps> => ({\n    ...geometry,\n    features: geometry.features.map((feature, index) => {\n        const title = feature.properties?.title ? feature.properties.title : buildTitle(feature, config);\n        const color = feature.properties?.color ? feature.properties.color : buildColor(config, index);\n        return { ...feature, properties: { ...feature.properties, title, color } };\n    }),\n});\n\n/**\n * Find the biggest array length inside an array.\n * Used to find the biggest array in a Multi-Polygon feature.\n * @param coordinates\n * @returns\n */\nconst getLongestArray = (coordinates: Position[][][]) =>\n    coordinates.flat().reduce((result, coord) => (coord.length > result.length ? coord : result), []);\n\n/**\n * Create a Feature<Point> with coordinates where title will be placed.\n * If feature properties contains a coordinates value, it will use it.\n * In case there is not coordinates value, it will get the biggest Polygon inside a feature and calculate\n * the bounding box for those coordinates and finally calculate the bounding box center to place the title.\n * @param geometries\n * @returns\n * @ignore\n */\nexport const prepareTitleForDisplay = (geometries: PolygonFeatures<GeoJsonProperties>): FeatureCollection<Point> => {\n    const features = geometries.features.map((feature) => {\n        let coordinates: Position[] | Position | null;\n\n        if (feature.properties?.placeCoordinates) {\n            coordinates = feature.properties?.placeCoordinates;\n        } else if (feature.geometry.type === 'MultiPolygon') {\n            const biggestPolygon = getLongestArray(feature.geometry.coordinates);\n            const bbox = bboxFromCoordsArray(biggestPolygon);\n            coordinates = (bbox && bboxCenter(bbox)) || null;\n        } else {\n            coordinates = feature.geometry.coordinates.flat();\n        }\n\n        return {\n            type: 'Feature',\n            geometry: { type: 'Point', coordinates },\n            properties: feature.properties,\n        } as Feature<Point>;\n    });\n\n    return { type: 'FeatureCollection', bbox: geometries.bbox, features };\n};\n","import type { PolygonFeatures } from '@tomtom-org/maps-sdk/core';\nimport type { FeatureCollection, Point } from 'geojson';\nimport type { SymbolLayerSpecification } from 'maplibre-gl';\nimport type { SymbolLayerSpecWithoutSource, ToBeAddedLayerSpec } from '../shared';\nimport { AbstractMapModule, EventsModule, GeoJSONSourceWithLayers, mapStyleLayerIDs } from '../shared';\nimport { changeLayerProps, waitUntilMapIsReady } from '../shared/mapUtils';\nimport type { TomTomMap } from '../TomTomMap';\nimport {\n    buildGeometryLayerSpecs,\n    buildGeometryTitleLayerSpec,\n    prepareGeometryForDisplay,\n    prepareTitleForDisplay,\n} from './prepareGeometryForDisplay';\nimport type {\n    GeometriesModuleConfig,\n    GeometryBeforeLayerConfig,\n    GeometryTextConfig,\n} from './types/geometriesModuleConfig';\n\n/**\n * IDs of sources and layers from a geometry module.\n */\ntype GeometrySourcesWithLayers = {\n    geometry: GeoJSONSourceWithLayers<PolygonFeatures>;\n    geometryLabel: GeoJSONSourceWithLayers<FeatureCollection<Point>>;\n};\n\n/**\n * Geometries Module for displaying polygon areas with custom styling on the map.\n *\n * This module enables visualization of geographic areas (polygons) with customizable\n * colors, borders, and labels. Ideal for displaying search results, administrative\n * boundaries, service areas, or any polygon-based geographic data.\n *\n * @remarks\n * **Features:**\n * - Display single or multiple polygon geometries\n * - Customizable fill colors and opacity\n * - Configurable borders (color, width, opacity)\n * - Optional text labels for geometries\n * - Support for data-driven styling via MapLibre expressions\n * - Layer ordering control\n * - Event handling for user interactions\n *\n * **Data Format:**\n * - Accepts GeoJSON Polygon and MultiPolygon features\n * - Supports FeatureCollection for multiple geometries\n * - Compatible with TomTom Search API geometry results\n *\n * **Styling:**\n * - Use predefined color palettes or custom colors\n * - Apply MapLibre expressions for dynamic styling\n * - Per-feature styling via feature properties\n *\n * @example\n * Basic usage:\n * ```typescript\n * import { GeometriesModule } from '@tomtom-international/maps-sdk-js/map';\n *\n * // Initialize module\n * const geometries = await GeometriesModule.get(map);\n *\n * // Display a polygon\n * await geometries.show({\n *   type: 'Feature',\n *   geometry: {\n *     type: 'Polygon',\n *     coordinates: [[[4.88, 52.37], [4.89, 52.37], [4.89, 52.38], [4.88, 52.38], [4.88, 52.37]]]\n *   },\n *   properties: {\n *     title: 'Area of Interest'\n *   }\n * });\n * ```\n *\n * @example\n * Custom styling:\n * ```typescript\n * const geometries = await GeometriesModule.get(map, {\n *   colorConfig: {\n *     fillColor: '#FF5733',\n *     fillOpacity: 0.3\n *   },\n *   lineConfig: {\n *     lineColor: '#C70039',\n *     lineWidth: 3\n *   },\n *   textConfig: {\n *     textField: ['get', 'name']\n *   }\n * });\n *\n * await geometries.show(polygonFeatures);\n * ```\n *\n * @example\n * Multiple geometries with different colors:\n * ```typescript\n * await geometries.show({\n *   type: 'FeatureCollection',\n *   features: [\n *     {\n *       type: 'Feature',\n *       geometry: { type: 'Polygon', coordinates: [...] },\n *       properties: { color: '#FF0000', title: 'Red Zone' }\n *     },\n *     {\n *       type: 'Feature',\n *       geometry: { type: 'Polygon', coordinates: [...] },\n *       properties: { color: '#00FF00', title: 'Green Zone' }\n *     }\n *   ]\n * });\n * ```\n *\n * @example\n * Event handling:\n * ```typescript\n * geometries.events.on('click', (feature, lngLat) => {\n *   console.log('Clicked geometry:', feature.properties.title);\n *   console.log('At coordinates:', lngLat);\n * });\n *\n * geometries.events.on('hover', (feature) => {\n *   showTooltip(feature.properties.title);\n * });\n * ```\n *\n * @see [Geometries Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/geometries)\n *\n * @group Geometries\n */\nexport class GeometriesModule extends AbstractMapModule<GeometrySourcesWithLayers, GeometriesModuleConfig> {\n    private static lastInstanceIndex = -1;\n\n    private titleLayerSpecs!: SymbolLayerSpecWithoutSource;\n    private geometryFillLayerSpecs!: SymbolLayerSpecWithoutSource;\n    private geometryOutlineLayerSpecs!: SymbolLayerSpecWithoutSource;\n\n    private sourceID!: string;\n    private fillLayerID!: string;\n    private outlineLayerID!: string;\n\n    private titleSourceID!: string;\n    private titleLayerID!: string;\n\n    /**\n     * Make sure the map is ready before create an instance of the module and any other interaction with the map\n     * @param tomtomMap The TomTomMap instance.\n     * @param config  The module optional configuration\n     * @returns {Promise} Returns a promise with a new instance of this module\n     *\n     * @remarks\n     * **Configuration Options:**\n     * - `colorConfig`: Fill color and opacity settings\n     * - `lineConfig`: Border/outline styling\n     * - `textConfig`: Label display configuration\n     * - `beforeLayerConfig`: Layer ordering (place above/below other layers)\n     *\n     * **Multiple Instances:**\n     * You can create multiple GeometriesModule instances on the same map,\n     * each managing different sets of geometries with different styles.\n     *\n     * @example\n     * Default initialization:\n     * ```typescript\n     * const geometries = await GeometriesModule.get(map);\n     * ```\n     *\n     * @example\n     * With custom styling:\n     * ```typescript\n     * const geometries = await GeometriesModule.get(map, {\n     *   colorConfig: {\n     *     fillColor: 'blue',\n     *     fillOpacity: 0.25\n     *   },\n     *   lineConfig: {\n     *     lineColor: 'darkblue',\n     *     lineWidth: 2,\n     *     lineOpacity: 0.8\n     *   },\n     *   textConfig: {\n     *     textField: ['get', 'title']\n     *   },\n     *   beforeLayerConfig: 'top'\n     * });\n     * ```\n     *\n     * @example\n     * Data-driven styling:\n     * ```typescript\n     * const geometries = await GeometriesModule.get(map, {\n     *   colorConfig: {\n     *     // Color based on feature properties\n     *     fillColor: [\n     *       'match',\n     *       ['get', 'type'],\n     *       'residential', '#FFEB3B',\n     *       'commercial', '#2196F3',\n     *       'industrial', '#9E9E9E',\n     *       '#E0E0E0' // default\n     *     ],\n     *     fillOpacity: 0.4\n     *   }\n     * });\n     * ```\n     */\n    static async get(tomtomMap: TomTomMap, config?: GeometriesModuleConfig): Promise<GeometriesModule> {\n        await waitUntilMapIsReady(tomtomMap);\n        return new GeometriesModule(tomtomMap, config);\n    }\n\n    private constructor(map: TomTomMap, config?: GeometriesModuleConfig) {\n        super('geojson', map, config);\n    }\n\n    /**\n     * @ignore\n     */\n    protected _initSourcesWithLayers(config?: GeometriesModuleConfig, restore?: boolean): GeometrySourcesWithLayers {\n        if (!restore) {\n            GeometriesModule.lastInstanceIndex++;\n            this.sourceID = `geometry-${GeometriesModule.lastInstanceIndex}`;\n            this.titleSourceID = `geometryTitle-${GeometriesModule.lastInstanceIndex}`;\n            const layerIdPrefix = `geometry-${GeometriesModule.lastInstanceIndex}`;\n            this.fillLayerID = `${layerIdPrefix}_Fill`;\n            this.outlineLayerID = `${layerIdPrefix}_Outline`;\n            this.titleLayerID = `${layerIdPrefix}_Title`;\n        }\n\n        const [geometryFillSpec, geometryOutlineSpec] = buildGeometryLayerSpecs(\n            this.fillLayerID,\n            this.outlineLayerID,\n            config,\n        );\n        const titleLayerSpec = buildGeometryTitleLayerSpec(this.titleLayerID, config);\n        this.titleLayerSpecs = titleLayerSpec;\n        this.geometryFillLayerSpecs = geometryFillSpec;\n        this.geometryOutlineLayerSpecs = geometryOutlineSpec;\n\n        return {\n            geometry: new GeoJSONSourceWithLayers(this.mapLibreMap, this.sourceID, [\n                { ...geometryFillSpec },\n                { ...geometryOutlineSpec },\n            ]),\n            geometryLabel: new GeoJSONSourceWithLayers(this.mapLibreMap, this.titleSourceID, [\n                titleLayerSpec as ToBeAddedLayerSpec<SymbolLayerSpecification>,\n            ]),\n        };\n    }\n\n    /**\n     * @ignore\n     */\n    protected _applyConfig(config: GeometriesModuleConfig | undefined) {\n        if (config?.textConfig || config?.colorConfig || config?.lineConfig) {\n            this.updateLayerAndData(config);\n        }\n        if (config?.beforeLayerConfig) {\n            this.moveBeforeLayer(config.beforeLayerConfig);\n        }\n        return config;\n    }\n\n    private moveBeforeLayerID(beforeLayerId?: string) {\n        for (const layer of this.sourcesWithLayers.geometry.sourceAndLayerIDs.layerIDs) {\n            this.mapLibreMap.moveLayer(layer, beforeLayerId);\n        }\n    }\n\n    /**\n     * Positions the geometry layers relative to other map layers.\n     *\n     * @param layerConfig - Layer positioning configuration.\n     * Can be `'top'` to place above all layers, or a specific layer ID.\n     *\n     * @remarks\n     * **Use Cases:**\n     * - Place geometries above base map but below labels\n     * - Ensure geometries appear above/below specific features\n     * - Control visual hierarchy of multiple data layers\n     *\n     * **Available Layer IDs:**\n     * Use predefined layer IDs from `mapStyleLayerIDs` or custom layer IDs.\n     *\n     * @example\n     * ```typescript\n     * import { mapStyleLayerIDs } from '@tomtom-international/maps-sdk-js/map';\n     *\n     * // Place below labels\n     * geometries.moveBeforeLayer(mapStyleLayerIDs.lowestLabel);\n     *\n     * // Place on top\n     * geometries.moveBeforeLayer('top');\n     * ```\n     */\n    moveBeforeLayer(layerConfig: GeometryBeforeLayerConfig) {\n        this.config = { ...this.config, beforeLayerConfig: layerConfig };\n        this.moveBeforeLayerID(layerConfig === 'top' ? this.titleLayerID : mapStyleLayerIDs[layerConfig]);\n    }\n\n    /**\n     * Updates the text/label configuration for displayed geometries.\n     *\n     * @param textConfig - New text configuration settings.\n     *\n     * @remarks\n     * **Configuration:**\n     * - `textField`: MapLibre expression for label text content\n     * - Supports dynamic text based on feature properties\n     * - Changes apply to currently shown and future geometries\n     *\n     * @example\n     * ```typescript\n     * // Show feature property as label\n     * geometries.applyTextConfig({\n     *   textField: ['get', 'name']\n     * });\n     *\n     * // Conditional labels\n     * geometries.applyTextConfig({\n     *   textField: [\n     *     'case',\n     *     ['has', 'label'],\n     *     ['get', 'label'],\n     *     ['get', 'title']\n     *   ]\n     * });\n     * ```\n     */\n    applyTextConfig(textConfig: GeometryTextConfig) {\n        const config = { ...this.config, textConfig };\n        this.updateLayerAndData(config);\n        // TODO: is this consistent with _applyConfig?\n        this.sourcesWithLayers.geometryLabel.show(\n            prepareTitleForDisplay(this.sourcesWithLayers.geometry.shownFeatures),\n        );\n        this.config = config;\n    }\n\n    private updateLayerAndData(config: GeometriesModuleConfig) {\n        const [geometryFillSpec, geometryOutlineSpec] = buildGeometryLayerSpecs(\n            this.fillLayerID,\n            this.outlineLayerID,\n            config,\n        );\n        const newTitleLayerSpecs = buildGeometryTitleLayerSpec(this.titleLayerID, config);\n\n        changeLayerProps(geometryFillSpec, this.geometryFillLayerSpecs, this.mapLibreMap);\n        changeLayerProps(geometryOutlineSpec, this.geometryOutlineLayerSpecs, this.mapLibreMap);\n        changeLayerProps(newTitleLayerSpecs, this.titleLayerSpecs, this.mapLibreMap);\n\n        this.geometryFillLayerSpecs = geometryFillSpec;\n        this.geometryOutlineLayerSpecs = geometryOutlineSpec;\n        this.titleLayerSpecs = newTitleLayerSpecs;\n    }\n\n    /**\n     * @ignore\n     */\n    protected restoreDataAndConfigImpl() {\n        const previousShownFeatures = this.sourcesWithLayers.geometry.shownFeatures;\n        this.initSourcesWithLayers(this.config, true);\n        this.config && this._applyConfig(this.config);\n        this.show(previousShownFeatures);\n    }\n\n    /**\n     * Displays the given polygon geometries on the map.\n     *\n     * @param geometries - Polygon features to display. Can be a single Feature,\n     * array of Features, or a FeatureCollection.\n     *\n     * @remarks\n     * **Behavior:**\n     * - Replaces any previously shown geometries\n     * - Applies current module styling configuration\n     * - Waits for module to be ready before displaying\n     * - Automatically handles both Polygon and MultiPolygon types\n     *\n     * **Feature Properties:**\n     * - `title`: Used for labels if text config is set\n     * - `color`: Override fill color per feature\n     * - Custom properties accessible in styling expressions\n     *\n     * @example\n     * Single polygon:\n     * ```typescript\n     * await geometries.show({\n     *   type: 'Feature',\n     *   geometry: {\n     *     type: 'Polygon',\n     *     coordinates: [[[4.88, 52.37], [4.89, 52.37], [4.89, 52.38], [4.88, 52.37]]]\n     *   },\n     *   properties: {\n     *     title: 'Amsterdam Center',\n     *     color: '#FF5733'\n     *   }\n     * });\n     * ```\n     *\n     * @example\n     * Multiple polygons:\n     * ```typescript\n     * await geometries.show({\n     *   type: 'FeatureCollection',\n     *   features: [\n     *     { type: 'Feature', geometry: {...}, properties: {...} },\n     *     { type: 'Feature', geometry: {...}, properties: {...} }\n     *   ]\n     * });\n     * ```\n     *\n     * @example\n     * From search API response:\n     * ```typescript\n     * import { search } from '@tomtom-international/maps-sdk-js/services';\n     *\n     * const result = await search.geometrySearch({\n     *   query: 'Amsterdam',\n     *   geometryList: [{ type: 'CIRCLE', position: [52.37, 4.89], radius: 5000 }]\n     * });\n     *\n     * if (result.results[0].dataSources?.geometry) {\n     *   await geometries.show(result.results[0].dataSources.geometry);\n     * }\n     * ```\n     */\n    async show(geometries: PolygonFeatures) {\n        await this.waitUntilModuleReady();\n        const geometry = this.sourcesWithLayers.geometry;\n        geometry.show(prepareGeometryForDisplay(geometries, this.config));\n        this.sourcesWithLayers.geometryLabel.show(prepareTitleForDisplay(geometry.shownFeatures));\n    }\n\n    /**\n     * Removes all geometries from the map.\n     *\n     * @remarks\n     * - Clears both geometry layers and labels\n     * - Does not reset styling configuration\n     * - Module remains initialized and ready for new data\n     *\n     * @example\n     * ```typescript\n     * // Clear displayed geometries\n     * await geometries.clear();\n     *\n     * // Show new geometries\n     * await geometries.show(newGeometries);\n     * ```\n     */\n    async clear() {\n        await this.waitUntilModuleReady();\n        this.sourcesWithLayers.geometry.clear();\n    }\n\n    /**\n     * Gets the events interface for handling user interactions with geometries.\n     *\n     * @returns An EventsModule instance for registering event handlers.\n     *\n     * @remarks\n     * **Supported Events:**\n     * - `click`: User clicks on a geometry\n     * - `contextmenu`: User right-clicks on a geometry\n     * - `hover`: Mouse enters a geometry\n     * - `long-hover`: Mouse hovers over geometry for extended time\n     *\n     * **Event Features:**\n     * - Receive the original feature data passed to `show()`\n     * - Access feature properties and geometry\n     * - Get click/hover coordinates\n     *\n     * @example\n     * Basic event handling:\n     * ```typescript\n     * geometries.events.on('click', (feature, lngLat) => {\n     *   console.log('Clicked:', feature.properties);\n     *   console.log('Location:', lngLat);\n     * });\n     * ```\n     *\n     * @example\n     * Multiple handlers:\n     * ```typescript\n     * // Highlight on hover\n     * geometries.events.on('hover', (feature) => {\n     *   highlightGeometry(feature.id);\n     * });\n     *\n     * // Show details on click\n     * geometries.events.on('click', (feature) => {\n     *   showDetailPanel(feature.properties);\n     * });\n     *\n     * // Context menu\n     * geometries.events.on('contextmenu', (feature, lngLat) => {\n     *   showContextMenu(lngLat, feature);\n     * });\n     * ```\n     */\n    get events() {\n        return new EventsModule(this.tomtomMap._eventsProxy, this.sourcesWithLayers.geometry);\n    }\n}\n","import { AbstractMapModule, EventsModule, HILLSHADE_SOURCE_ID, StyleSourceWithLayers } from '../shared';\nimport { notInTheStyle } from '../shared/errorMessages';\nimport { ensureAddedToStyle, waitUntilMapIsReady } from '../shared/mapUtils';\nimport type { TomTomMap } from '../TomTomMap';\nimport type { HillshadeModuleConfig } from '.';\n\n/**\n * IDs of sources and layers for hillshade module.\n */\ntype HillshadeSourcesWithLayers = {\n    hillshade: StyleSourceWithLayers;\n};\n\n/**\n * Map module for displaying terrain shading (hillshade).\n *\n * The HillshadeModule adds realistic terrain depth perception to the map by rendering\n * shadow and highlight effects based on elevation data. This enhances the 3D appearance\n * of mountainous and hilly terrain.\n *\n * @remarks\n * **Features:**\n * - Realistic terrain shading\n * - Uses vector tile elevation data\n * - Lightweight performance impact\n * - Seamlessly integrates with other map layers\n * - Toggle visibility on/off\n *\n * **Common Use Cases:**\n * - Outdoor recreation maps (hiking, skiing)\n * - Geographic/topographic applications\n * - Environmental visualization\n * - Landscape planning tools\n *\n * @example\n * ```typescript\n * // Create the module with hillshade visible\n * const hillshade = await HillshadeModule.getInstance(map, {\n *   visible: true\n * });\n *\n * // Toggle visibility\n * hillshade.setVisible(false);\n *\n * // Listen to events\n * hillshade.events.on('click', (feature, lngLat) => {\n *   console.log('Clicked hillshade at:', lngLat);\n * });\n * ```\n *\n * @see [Hillshade Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/hillshade)\n *\n * @group Hillshade\n */\nexport class HillshadeModule extends AbstractMapModule<HillshadeSourcesWithLayers, HillshadeModuleConfig> {\n    /**\n     * Retrieves a HillshadeModule instance for the given map.\n     *\n     * @param map - The TomTomMap instance to attach this module to.\n     * @param config - Optional configuration for initialization and visibility.\n     *\n     * @returns A promise that resolves to the initialized HillshadeModule.\n     *\n     * @remarks\n     * **Configuration:**\n     * - `visible`: Initial visibility state\n     * - `ensureAddedToStyle`: Auto-add hillshade to style if missing\n     *\n     * **Style Requirement:**\n     * - Hillshade must be included in the map style or added via `ensureAddedToStyle`\n     * - Some styles may not support hillshade (e.g., satellite)\n     *\n     * @throws Error if hillshade source is not in style and `ensureAddedToStyle` is false\n     *\n     * @example\n     * Default initialization:\n     * ```typescript\n     * const hillshade = await HillshadeModule.get(map);\n     * ```\n     *\n     * @example\n     * Auto-add to style if missing:\n     * ```typescript\n     * const hillshade = await HillshadeModule.get(map, {\n     *   visible: true\n     * });\n     * ```\n     *\n     * @example\n     * Start hidden:\n     * ```typescript\n     * const hillshade = await HillshadeModule.get(map, {\n     *   visible: false\n     * });\n     * ```\n     */\n    static async get(map: TomTomMap, config?: HillshadeModuleConfig): Promise<HillshadeModule> {\n        await waitUntilMapIsReady(map);\n        await ensureAddedToStyle(map, HILLSHADE_SOURCE_ID, 'hillshade');\n        return new HillshadeModule(map, config);\n    }\n\n    private constructor(map: TomTomMap, config?: HillshadeModuleConfig) {\n        super('style', map, config);\n    }\n\n    /**\n     * @ignore\n     */\n    protected _initSourcesWithLayers() {\n        const hillshadeSource = this.mapLibreMap.getSource(HILLSHADE_SOURCE_ID);\n        if (!hillshadeSource) {\n            throw notInTheStyle(`init ${HillshadeModule.name} with source ID ${HILLSHADE_SOURCE_ID}`);\n        }\n        return { hillshade: new StyleSourceWithLayers(this.mapLibreMap, hillshadeSource) };\n    }\n\n    /**\n     * @ignore\n     */\n    protected _applyConfig(config: HillshadeModuleConfig | undefined) {\n        this.setVisible(config?.visible ?? false);\n        return config;\n    }\n\n    /**\n     * Sets the visibility of the hillshade layer.\n     *\n     * @param visible - `true` to show hillshade, `false` to hide it.\n     *\n     * @remarks\n     * Changes are applied immediately if the map is ready.\n     *\n     * @example\n     * ```typescript\n     * hillshade.setVisible(true);  // Show terrain shading\n     * hillshade.setVisible(false); // Hide terrain shading\n     * ```\n     */\n    setVisible(visible: boolean): void {\n        this.config = {\n            ...this.config,\n            visible,\n        };\n\n        if (this.tomtomMap.mapReady) {\n            this.sourcesWithLayers.hillshade.setLayersVisible(visible);\n        }\n    }\n\n    /**\n     * Checks if the hillshade layer is currently visible.\n     *\n     * @returns `true` if visible, `false` if hidden.\n     *\n     * @example\n     * ```typescript\n     * if (hillshade.isVisible()) {\n     *   console.log('Terrain shading is active');\n     * }\n     * ```\n     */\n    isVisible(): boolean {\n        return this.sourcesWithLayers.hillshade.isAnyLayerVisible();\n    }\n\n    /**\n     * Gets the events interface for handling user interactions with hillshade.\n     *\n     * @returns An EventsModule instance for registering event handlers.\n     *\n     * @remarks\n     * **Supported Events:**\n     * - `click`: User clicks on the hillshade layer\n     * - `contextmenu`: User right-clicks\n     * - `hover`: Mouse enters hillshade area\n     * - `long-hover`: Extended hover\n     *\n     * @example\n     * ```typescript\n     * hillshade.events.on('click', (feature, lngLat) => {\n     *   console.log('Clicked terrain at:', lngLat);\n     * });\n     * ```\n     */\n    get events() {\n        return new EventsModule(this.tomtomMap._eventsProxy, this.sourcesWithLayers.hillshade);\n    }\n}\n","import type { GlobalConfig } from '@tomtom-org/maps-sdk/core';\nimport type { MapOptions, StyleSpecification } from 'maplibre-gl';\nimport type { MapEventsConfig } from './mapEventsConfig';\n\n/**\n * Array of all available standard style identifiers.\n *\n * This constant provides the complete list of TomTom-hosted standard map styles\n * that can be used when initializing a map. It serves as the source of truth for\n * valid style IDs and is used to derive the {@link StandardStyleID} type.\n *\n * @remarks\n * Use this array when you need to:\n * - Iterate over all available styles (e.g., building a style picker UI)\n * - Validate if a style ID is a standard style\n * - Display available options to users\n *\n * The array is defined as `const` with `as const` assertion to ensure type safety\n * and prevent modifications at runtime.\n *\n * @example\n * ```typescript\n * import { standardStyleIDs } from '@tomtom-org/maps-sdk/map';\n *\n * // Build a dropdown menu with all standard styles\n * const styleSelector = document.getElementById('style-selector');\n * standardStyleIDs.forEach((styleId) => {\n *   const option = new Option(styleId);\n *   styleSelector.add(option);\n * });\n *\n * // Check if a style ID is valid\n * const isValidStyle = (id: string): boolean => {\n *   return standardStyleIDs.includes(id as any);\n * };\n * ```\n *\n * @see {@link StandardStyleID} - The type derived from this array\n *\n * @group Map Style\n */\nexport const standardStyleIDs = [\n    'standardLight',\n    'standardDark',\n    // TODO: driving styles not supported in Orbis for now\n    'drivingLight',\n    'drivingDark',\n    'monoLight',\n    'monoDark',\n    'satellite',\n] as const;\n\n/**\n * Identifier for a TomTom-hosted standard map style.\n *\n * Standard styles are officially maintained by TomTom and provide consistent,\n * professionally designed map appearances.\n *\n * @remarks\n * Available styles:\n * - `standardLight`: Default light theme with full detail\n * - `standardDark`: Dark theme for low-light environments\n * - `drivingLight`: Optimized for in-car navigation (light)\n * - `drivingDark`: Optimized for in-car navigation (dark)\n * - `monoLight`: Minimalist monochrome light theme\n * - `monoDark`: Minimalist monochrome dark theme\n * - `satellite`: Satellite imagery basemap\n *\n * @example\n * ```typescript\n * const styleId: StandardStyleID = 'standardLight';\n * ```\n *\n * @group Map Style\n */\nexport type StandardStyleID = (typeof standardStyleIDs)[number];\n\n/**\n * Configuration for a TomTom standard map style.\n *\n * Provides options to customize which modules are included and which style version to use.\n *\n * @example\n * ```typescript\n * // Standard style with all default modules\n * const style: StandardStyle = {\n *   id: 'standardLight'\n * };\n *\n * // Exclude traffic modules\n * const styleNoTraffic: StandardStyle = {\n *   id: 'standardLight',\n *   include: ['hillshade']  // Only include hillshade, exclude traffic\n * };\n *\n * // Use specific style version\n * const versionedStyle: StandardStyle = {\n *   id: 'standardDark',\n *   version: '1.0.0'\n * };\n * ```\n *\n * @group Map Style\n */\nexport type StandardStyle = {\n    /**\n     * Standard style identifier.\n     *\n     * Determines the visual appearance of the map.\n     */\n    id?: StandardStyleID;\n    /**\n     * Modules to include when loading the style.\n     * * Use this to selectively enable only needed modules for better performance.\n     *\n     * If not specified, all available modules are included by default.\n     * If an empty array is provided, no optional modules will be included.\n     *\n     * @default All available modules\n     *\n     * @remarks\n     * Available modules:\n     * - `trafficIncidents`: Real-time traffic incidents (accidents, closures)\n     * - `trafficFlow`: Real-time traffic flow visualization\n     * - `hillshade`: Terrain elevation shading\n     *\n     * @example\n     * ```typescript\n     * // Include only traffic modules\n     * include: ['trafficIncidents', 'trafficFlow']\n     *\n     * // Include only hillshade\n     * include: ['hillshade']\n     *\n     * // Include no optional modules\n     * include: []\n     * ```\n     */\n    include?: StyleModule[];\n    /**\n     * Style version to load.\n     *\n     * Allows pinning to a specific style version for consistency.\n     * If not specified, uses the latest SDK-supported version.\n     *\n     * @default Latest SDK-supported version\n     *\n     * @example\n     * ```typescript\n     * version: '1.0.0'\n     * ```\n     */\n    version?: string;\n};\n\n/**\n * Configuration for a custom map style.\n *\n * Allows using your own map style either via URL or direct JSON specification.\n *\n * @remarks\n * Use custom styles for:\n * - Branded map appearances\n * - Specialized use cases (indoor maps, thematic maps)\n * - Integration with custom tile servers\n *\n * @example\n * ```typescript\n * // Load from URL\n * const urlStyle: CustomStyle = {\n *   url: 'https://example.com/my-custom-style.json'\n * };\n *\n * // Direct JSON specification\n * const jsonStyle: CustomStyle = {\n *   json: {\n *     version: 8,\n *     sources: { ... },\n *     layers: [ ... ]\n *   }\n * };\n * ```\n *\n * @group Map Style\n */\nexport type CustomStyle = {\n    /**\n     * URL to a MapLibre/Mapbox style JSON.\n     *\n     * The URL should not include the API key - it will be automatically added.\n     * Mutually exclusive with the `json` property.\n     *\n     * @example\n     * ```typescript\n     * url: 'https://api.tomtom.com/style/1/style/my-custom-style'\n     * ```\n     */\n    url?: string;\n    /**\n     * Direct style specification as JSON.\n     *\n     * Provide the complete MapLibre Style Specification object.\n     * Mutually exclusive with the `url` property.\n     *\n     * @see [MapLibre Style Specification](https://maplibre.org/maplibre-style-spec/)\n     *\n     * @example\n     * ```typescript\n     * json: {\n     *   version: 8,\n     *   sources: {\n     *     'my-source': { type: 'vector', url: '...' }\n     *   },\n     *   layers: [\n     *     { id: 'background', type: 'background', paint: { 'background-color': '#f0f0f0' } }\n     *   ]\n     * }\n     * ```\n     */\n    json?: StyleSpecification;\n};\n\n/**\n * Array of all available style modules.\n *\n * @group Map Style\n */\nexport const styleModules = ['trafficIncidents', 'trafficFlow', 'hillshade'] as const;\n\n/**\n * Optional map modules that can be included with a style.\n *\n * @remarks\n * - `trafficIncidents`: Shows real-time traffic incidents on the map\n * - `trafficFlow`: Shows real-time traffic flow with color-coded speeds\n * - `hillshade`: Adds terrain elevation shading for topographic context\n *\n * @group Map Style\n */\nexport type StyleModule = (typeof styleModules)[number];\n\n/**\n * Map style specification for initialization.\n *\n * Defines which map style to load and how it should be configured.\n * Supports standard TomTom styles or custom styles.\n *\n * @remarks\n * Three input formats:\n * 1. **Simple ID**: Just pass a standard style ID string\n * 2. **Standard style object**: Use a TomTom style with custom configuration\n * 3. **Custom style object**: Load your own style from URL or JSON\n *\n * @example\n * ```typescript\n * // 1. Simple standard style\n * style: 'standardLight'\n *\n * // 2. Standard style with configuration\n * style: {\n *   type: 'standard',\n *   id: 'standardLight',\n *   include: ['trafficFlow', 'hillshade']\n * }\n *\n * // 3. Custom style from URL\n * style: {\n *   type: 'custom',\n *   url: 'https://example.com/style.json'\n * }\n *\n * // 4. Custom style from JSON\n * style: {\n *   type: 'custom',\n *   json: { version: 8, sources: {...}, layers: [...] }\n * }\n * ```\n *\n * @group Map Style\n */\nexport type StyleInput = StandardStyleID | (StandardStyle & { type: 'standard' }) | (CustomStyle & { type: 'custom' });\n\n/**\n * Parameters for initializing a TomTom map instance.\n *\n * Combines global SDK configuration with map-specific settings like style and events.\n *\n * @example\n * ```typescript\n * const mapParams: TomTomMapParams = {\n *   key: 'your-api-key',\n *   container: 'map-container',\n *   center: [4.9041, 52.3676],\n *   zoom: 12,\n *   style: 'standardLight',\n *   eventsConfig: {\n *     onClick: (event) => console.log('Map clicked', event)\n *   }\n * };\n * ```\n *\n * @group Map\n */\nexport type TomTomMapParams = GlobalConfig & {\n    /**\n     * Map style to load.\n     *\n     * If not specified, defaults to 'standardLight'.\n     *\n     * @default 'standardLight'\n     *\n     * @example\n     * ```typescript\n     * // Use dark theme\n     * style: 'standardDark'\n     *\n     * // Custom configuration\n     * style: {\n     *   type: 'standard',\n     *   id: 'standardLight',\n     *   include: ['trafficFlow']\n     * }\n     * ```\n     */\n    style?: StyleInput;\n\n    /**\n     * Event handler configuration for map interactions.\n     *\n     * Define callbacks for various map events like clicks, hovers, and movements.\n     *\n     * @example\n     * ```typescript\n     * eventsConfig: {\n     *   onClick: (event) => {\n     *     console.log('Clicked at', event.lngLat);\n     *   },\n     *   onMoveEnd: () => {\n     *     console.log('Map moved to', map.getCenter());\n     *   }\n     * }\n     * ```\n     */\n    eventsConfig?: MapEventsConfig;\n};\n\n/**\n * MapLibre-specific options for advanced map configuration.\n *\n * Extends MapLibre GL JS MapOptions, excluding style and attribution control\n * which are handled by the TomTom SDK.\n *\n * @remarks\n * Includes options for:\n * - Initial viewport (center, zoom, bearing, pitch)\n * - Interaction controls (zoom, rotation, drag)\n * - Rendering options (antialiasing, terrain)\n * - Localization and accessibility\n *\n * @see [MapLibre MapOptions](https://maplibre.org/maplibre-gl-js-docs/api/map/)\n *\n * @group Map\n */\nexport type MapLibreOptions = Omit<MapOptions, 'style' | 'attributionControl'>;\n","import type { ExpressionSpecification } from 'maplibre-gl';\n\n/**\n * Main route line foreground color.\n * @ignore\n */\nexport const ROUTE_LINE_FOREGROUND_COLOR = '#36A8F0';\n\n/**\n * Main route outline color.\n */\nexport const ROUTE_LINE_OUTLINE_COLOR = '#105287';\n\n/**\n * Deselected route line foreground color.\n * @ignore\n */\nexport const DESELECTED_FOREGROUND_COLOR = '#ABAFB3';\n\n/**\n * Deselected route line outline color.\n * @ignore\n */\nexport const DESELECTED_OUTLINE_COLOR = '#3C4956';\n\n/**\n * @ignore\n */\nexport const DESELECTED_SECONDARY_COLOR = '#727C85';\n\n/**\n * Main route line width based on zoom level.\n * @ignore\n */\nexport const ROUTE_LINE_FOREGROUND_WIDTH: ExpressionSpecification = [\n    'interpolate',\n    ['linear'],\n    ['zoom'],\n    1,\n    3,\n    5,\n    4,\n    10,\n    7,\n    18,\n    10,\n];\n\n/**\n * Used for showing/hiding layer depending on layer being part of selected route or not.\n *\n * @remarks\n * Add this to layers that depend on whether they are part of the selected route or not.\n *\n * @example:\n * filter: SELECTED_ROUTE_FILTER\n\n * @group Routing\n */\nexport const SELECTED_ROUTE_FILTER: ExpressionSpecification = ['==', ['get', 'routeState'], 'selected'];\n\n/**\n * Used for showing/hiding layer depending on layer being part of deselected route or not.\n *\n * @remarks\n * Add this to layers that depend on whether they are part of the deselected route or not.\n *\n * @example:\n * filter: DESELECTED_ROUTE_FILTER\n\n * @group Routing\n */\nexport const DESELECTED_ROUTE_FILTER: ExpressionSpecification = ['==', ['get', 'routeState'], 'deselected'];\n\n/**\n * @ignore\n */\nexport const MAJOR_DELAY_COLOR = '#AD0000';\n/**\n * @ignore\n */\nexport const MODERATE_DELAY_COLOR = '#FB2D09';\n/**\n * @ignore\n */\nexport const MINOR_DELAY_LABEL_COLOR = '#f58240';\n/**\n * @ignore\n */\nexport const UNKNOWN_DELAY_COLOR = '#000000';\n","import type {\n    DataDrivenPropertyValueSpecification,\n    FormattedSpecification,\n    SymbolLayerSpecification,\n} from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { pinLayerBaseSpec } from '../../shared/layers/symbolLayers';\nimport { ChargingStopsConfig, ChargingStopTextConfig } from '../types/routeModuleConfig';\nimport { SELECTED_ROUTE_FILTER } from './shared';\n\nconst chargingStopTextField = (\n    config: ChargingStopTextConfig | undefined,\n): DataDrivenPropertyValueSpecification<FormattedSpecification> => {\n    if (config?.visible === false) {\n        return '';\n    }\n\n    return (\n        config?.title ?? [\n            'format',\n            ['get', 'title'],\n            '\\n',\n            ['get', 'chargingPower'],\n            '    ',\n            ['get', 'chargingDuration'],\n        ]\n    );\n};\n\n/**\n * @ignore\n * @see toDisplayChargingStops\n */\nexport const chargingStopSymbol = (\n    config: ChargingStopsConfig | undefined,\n): LayerSpecTemplate<SymbolLayerSpecification> => {\n    return {\n        ...pinLayerBaseSpec,\n        filter: SELECTED_ROUTE_FILTER,\n        minzoom: 4,\n        layout: {\n            ...pinLayerBaseSpec.layout,\n            'text-field': chargingStopTextField(config?.text),\n        },\n        paint: {\n            ...pinLayerBaseSpec.paint,\n        },\n    };\n};\n","import type { LineLayerSpecification, SymbolLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { SELECTED_ROUTE_FILTER } from './shared';\n\nconst commonProps = {\n    filter: SELECTED_ROUTE_FILTER,\n    minzoom: 16,\n};\n\nconst commonLineProps: LayerSpecTemplate<LineLayerSpecification> = {\n    ...commonProps,\n    type: 'line',\n    layout: { 'line-cap': 'round' },\n};\n\n/**\n * @ignore\n */\nexport const instructionOutline: LayerSpecTemplate<LineLayerSpecification> = {\n    ...commonLineProps,\n    paint: {\n        'line-width': ['interpolate', ['linear'], ['zoom'], 16, 14, 22, 20],\n        'line-color': 'grey',\n    },\n};\n\n/**\n * @ignore\n */\nexport const instructionLine: LayerSpecTemplate<LineLayerSpecification> = {\n    ...commonLineProps,\n    paint: {\n        'line-width': ['interpolate', ['linear'], ['zoom'], 16, 12, 22, 17],\n        'line-color': 'white',\n    },\n};\n\n/**\n * @ignore\n */\nexport const INSTRUCTION_ARROW_IMAGE_ID = 'instruction-arrow';\n\n/**\n * @ignore\n */\nexport const instructionArrow: LayerSpecTemplate<SymbolLayerSpecification> = {\n    ...commonProps,\n    type: 'symbol',\n    layout: {\n        'icon-allow-overlap': true,\n        'icon-image': INSTRUCTION_ARROW_IMAGE_ID,\n        'icon-rotation-alignment': 'map',\n        'icon-rotate': ['get', 'lastPointBearingDegrees'],\n        'icon-size': ['interpolate', ['linear'], ['zoom'], 16, 1, 22, 2],\n    },\n};\n","import type { LineLayerSpecification, SymbolLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { ROUTE_LINE_FOREGROUND_WIDTH, SELECTED_ROUTE_FILTER } from './shared';\n\n/**\n * @ignore\n */\nexport const routeFerriesLine: LayerSpecTemplate<LineLayerSpecification> = {\n    filter: SELECTED_ROUTE_FILTER,\n    type: 'line',\n    layout: {\n        'line-join': 'round',\n    },\n    paint: {\n        'line-width': ROUTE_LINE_FOREGROUND_WIDTH,\n        'line-color': '#6dc4ed',\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeFerriesSymbol: LayerSpecTemplate<SymbolLayerSpecification> = {\n    filter: SELECTED_ROUTE_FILTER,\n    type: 'symbol',\n    minzoom: 6,\n    // zoom where the map POI naturally appears:\n    maxzoom: 16.5,\n    layout: {\n        'symbol-placement': 'point',\n        'symbol-avoid-edges': true,\n        'icon-image': 'poi-ferry_terminal',\n        'icon-size': ['interpolate', ['linear'], ['zoom'], 6, 0.8, 16.5, 1],\n        // helps smooth the transition from along-route to map-poi, which also has a label in it:\n        'icon-ignore-placement': true,\n    },\n};\n","import type { ExpressionSpecification, LineLayerSpecification, SymbolLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport {\n    DESELECTED_FOREGROUND_COLOR,\n    DESELECTED_OUTLINE_COLOR,\n    DESELECTED_ROUTE_FILTER,\n    ROUTE_LINE_FOREGROUND_COLOR,\n    ROUTE_LINE_FOREGROUND_WIDTH,\n    ROUTE_LINE_OUTLINE_COLOR,\n    SELECTED_ROUTE_FILTER,\n} from './shared';\n\n/**\n * @ignore\n */\nexport const routeLineBaseTemplate: LayerSpecTemplate<LineLayerSpecification> = {\n    type: 'line',\n    layout: {\n        'line-join': 'round',\n        'line-cap': 'round',\n        'line-sort-key': ['get', 'index'],\n    },\n};\n\nconst outlineLineWidth: ExpressionSpecification = ['interpolate', ['linear'], ['zoom'], 1, 5, 5, 6, 10, 10, 18, 14];\n\n/**\n * @ignore\n */\nexport const routeDeselectedOutline: LayerSpecTemplate<LineLayerSpecification> = {\n    ...routeLineBaseTemplate,\n    filter: DESELECTED_ROUTE_FILTER,\n    paint: {\n        'line-color': DESELECTED_OUTLINE_COLOR,\n        'line-width': outlineLineWidth,\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeDeselectedLine: LayerSpecTemplate<LineLayerSpecification> = {\n    ...routeLineBaseTemplate,\n    filter: DESELECTED_ROUTE_FILTER,\n    paint: {\n        'line-color': DESELECTED_FOREGROUND_COLOR,\n        'line-width': ROUTE_LINE_FOREGROUND_WIDTH,\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeOutline: LayerSpecTemplate<LineLayerSpecification> = {\n    ...routeLineBaseTemplate,\n    filter: SELECTED_ROUTE_FILTER,\n    paint: {\n        'line-color': ROUTE_LINE_OUTLINE_COLOR,\n        'line-width': outlineLineWidth,\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeMainLine = (props?: { color?: string }): LayerSpecTemplate<LineLayerSpecification> => ({\n    ...routeLineBaseTemplate,\n    filter: SELECTED_ROUTE_FILTER,\n    paint: {\n        'line-color': props?.color ?? ROUTE_LINE_FOREGROUND_COLOR,\n        'line-width': ROUTE_LINE_FOREGROUND_WIDTH,\n    },\n});\n\n/**\n * @ignore\n */\nexport const routeLineArrows: LayerSpecTemplate<SymbolLayerSpecification> = {\n    type: 'symbol',\n    layout: {\n        'symbol-placement': 'line',\n        'icon-image': 'roads-arrow-white',\n        // The current arrow icon seems to point backwards otherwise. Check with caution!\n        'icon-rotate': 180,\n    },\n};\n\n/**\n * @ignore\n */\nexport const SELECTED_SUMMARY_POPUP_IMAGE_ID = 'selected-route-summary-popup';\n/**\n * @ignore\n */\nexport const DESELECTED_SUMMARY_POPUP_IMAGE_ID = 'deselected-route-summary-popup';\n","import type { LineLayerSpecification, SymbolLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { SELECTED_ROUTE_FILTER } from './shared';\n\n/**\n * @ignore\n */\nexport const routeTollRoadsOutline: LayerSpecTemplate<LineLayerSpecification> = {\n    filter: SELECTED_ROUTE_FILTER,\n    type: 'line',\n    layout: {\n        'line-join': 'round',\n        'line-cap': 'round',\n    },\n    paint: {\n        'line-width': ['interpolate', ['linear'], ['zoom'], 1, 9, 5, 11, 10, 15, 18, 20],\n        'line-color': '#BEBFFA',\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeTollRoadsSymbol: LayerSpecTemplate<SymbolLayerSpecification> = {\n    filter: SELECTED_ROUTE_FILTER,\n    type: 'symbol',\n    minzoom: 4,\n    layout: {\n        'symbol-placement': 'point',\n        'symbol-avoid-edges': true,\n        'icon-image': 'poi-toll_gantry',\n        'icon-size': ['interpolate', ['linear'], ['zoom'], 4, 0.8, 16.5, 1],\n    },\n};\n","import type { ExpressionSpecification, LineLayerSpecification, SymbolLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { MAP_BOLD_FONT } from '../../shared/layers/commonLayerProps';\nimport {\n    MAJOR_DELAY_COLOR,\n    MINOR_DELAY_LABEL_COLOR,\n    MODERATE_DELAY_COLOR,\n    SELECTED_ROUTE_FILTER,\n    UNKNOWN_DELAY_COLOR,\n} from './shared';\n\nconst EXTRA_FOREGROUND_LINE_WIDTH: ExpressionSpecification = [\n    'interpolate',\n    ['linear'],\n    ['zoom'],\n    1,\n    2,\n    5,\n    3,\n    10,\n    4,\n    18,\n    6,\n];\n\n/**\n * @ignore\n */\nexport const routeIncidentsBGLine: LayerSpecTemplate<LineLayerSpecification> = {\n    type: 'line',\n    layout: { 'line-cap': 'round' },\n    paint: {\n        'line-width': EXTRA_FOREGROUND_LINE_WIDTH,\n        'line-color': [\n            'match',\n            ['get', 'magnitudeOfDelay'],\n            'minor',\n            '#FFC105',\n            'moderate',\n            MODERATE_DELAY_COLOR,\n            'major',\n            MAJOR_DELAY_COLOR,\n            // other\n            '#C7D2D8',\n        ],\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeIncidentsDashedLine: LayerSpecTemplate<LineLayerSpecification> = {\n    type: 'line',\n    filter: ['in', ['get', 'magnitudeOfDelay'], ['literal', ['unknown', 'indefinite']]],\n    layout: { 'line-join': 'round' },\n    paint: {\n        'line-width': EXTRA_FOREGROUND_LINE_WIDTH,\n        'line-color': [\n            'match',\n            ['get', 'magnitudeOfDelay'],\n            'unknown',\n            'rgba(190, 39, 27, 1)',\n            // other (undefined):\n            'rgba(137, 150, 168, 1)',\n        ],\n        'line-dasharray': [1.5, 1],\n    },\n};\n\n/**\n * @ignore\n */\nexport const magnitudeOfDelayTextColor: ExpressionSpecification = [\n    'match',\n    ['get', 'magnitudeOfDelay'],\n    'minor',\n    MINOR_DELAY_LABEL_COLOR,\n    'moderate',\n    MODERATE_DELAY_COLOR,\n    'major',\n    MAJOR_DELAY_COLOR,\n    'indefinite',\n    '#666666',\n    // other\n    UNKNOWN_DELAY_COLOR,\n];\n\nconst routeIncidentsSymbolBase: LayerSpecTemplate<SymbolLayerSpecification> = {\n    filter: SELECTED_ROUTE_FILTER,\n    type: 'symbol',\n    minzoom: 6,\n    layout: {\n        'symbol-placement': 'point',\n        'symbol-avoid-edges': true,\n        'icon-ignore-placement': true,\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeIncidentsJamSymbol: LayerSpecTemplate<SymbolLayerSpecification> = {\n    ...routeIncidentsSymbolBase,\n    filter: ['all', ['has', 'jamIconID'], routeIncidentsSymbolBase.filter as ExpressionSpecification],\n    layout: {\n        ...routeIncidentsSymbolBase.layout,\n        'icon-image': ['get', 'jamIconID'],\n        'icon-anchor': 'bottom-left',\n        'text-anchor': 'bottom-left',\n        // Jam symbols have delay labels in them:\n        'text-field': ['get', 'title'],\n        'text-font': [MAP_BOLD_FONT],\n        'text-offset': [3.9, -1.4],\n        'text-size': 13,\n    },\n    paint: {\n        ...routeIncidentsSymbolBase.paint,\n        'text-color': magnitudeOfDelayTextColor,\n        'text-halo-color': '#FFFFFF',\n        'text-halo-width': 1,\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeIncidentsCauseSymbol: LayerSpecTemplate<SymbolLayerSpecification> = {\n    ...routeIncidentsSymbolBase,\n    filter: ['all', ['has', 'causeIconID'], routeIncidentsSymbolBase.filter as ExpressionSpecification],\n    layout: {\n        ...routeIncidentsSymbolBase.layout,\n        'icon-image': ['get', 'causeIconID'],\n        'icon-anchor': 'bottom-right',\n        // Cause symbols have no label in them.\n    },\n    paint: { ...routeIncidentsSymbolBase.paint },\n};\n","import type { LineLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { ROUTE_LINE_FOREGROUND_WIDTH, SELECTED_ROUTE_FILTER } from './shared';\n\n/**\n * @ignore\n */\nexport const routeTunnelsLine: LayerSpecTemplate<LineLayerSpecification> = {\n    filter: SELECTED_ROUTE_FILTER,\n    type: 'line',\n    layout: {\n        'line-join': 'round',\n    },\n    paint: {\n        'line-width': ROUTE_LINE_FOREGROUND_WIDTH,\n        'line-color': '#000000',\n        'line-opacity': 0.3,\n    },\n};\n","import type { LineLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport {\n    ROUTE_LINE_FOREGROUND_COLOR,\n    ROUTE_LINE_FOREGROUND_WIDTH,\n    ROUTE_LINE_OUTLINE_COLOR,\n    SELECTED_ROUTE_FILTER,\n} from './shared';\n\n/**\n * @ignore\n */\nexport const routeVehicleRestrictedBackgroundLine: LayerSpecTemplate<LineLayerSpecification> = {\n    filter: SELECTED_ROUTE_FILTER,\n    type: 'line',\n    layout: {\n        'line-join': 'round',\n    },\n    paint: {\n        'line-color': ROUTE_LINE_OUTLINE_COLOR,\n        'line-width': ROUTE_LINE_FOREGROUND_WIDTH,\n    },\n};\n\n/**\n * @ignore\n */\nexport const routeVehicleRestrictedDottedLine: LayerSpecTemplate<LineLayerSpecification> = {\n    filter: SELECTED_ROUTE_FILTER,\n    type: 'line',\n    layout: {\n        'line-join': 'round',\n        'line-cap': 'round',\n    },\n    paint: {\n        'line-color': ROUTE_LINE_FOREGROUND_COLOR,\n        'line-width': ['interpolate', ['linear'], ['zoom'], 1, 2, 5, 3, 10, 5, 18, 7],\n        'line-dasharray': [0, 1.5],\n    },\n};\n","import type { ExpressionSpecification, SymbolLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { MAP_BOLD_FONT, MAP_MEDIUM_FONT } from '../../shared/layers/commonLayerProps';\nimport { DESELECTED_SUMMARY_POPUP_IMAGE_ID, SELECTED_SUMMARY_POPUP_IMAGE_ID } from './routeMainLineLayers';\nimport { magnitudeOfDelayTextColor } from './routeTrafficSectionLayers';\nimport { DESELECTED_SECONDARY_COLOR, SELECTED_ROUTE_FILTER } from './shared';\n\n/**\n * @ignore\n */\nexport const TRAFFIC_CLEAR_IMAGE_ID = 'traffic-clear';\n/**\n * @ignore\n */\nexport const TRAFFIC_MAJOR_IMAGE_ID = 'traffic-major';\n/**\n * @ignore\n */\nexport const TRAFFIC_MODERATE_IMAGE_ID = 'traffic-moderate';\n/**\n * @ignore\n */\nexport const TRAFFIC_MINOR_IMAGE_ID = 'traffic-minor';\n\nconst hasFormattedTraffic: ExpressionSpecification = ['has', 'formattedTraffic'];\n/**\n * @ignore\n */\nexport const summaryBubbleSymbolPoint: LayerSpecTemplate<SymbolLayerSpecification> = {\n    type: 'symbol',\n    layout: {\n        'icon-image': [\n            'case',\n            SELECTED_ROUTE_FILTER,\n            SELECTED_SUMMARY_POPUP_IMAGE_ID,\n            DESELECTED_SUMMARY_POPUP_IMAGE_ID,\n        ],\n        'symbol-placement': 'point',\n        'icon-rotation-alignment': 'viewport',\n        'text-rotation-alignment': 'viewport',\n        'symbol-sort-key': ['case', SELECTED_ROUTE_FILTER, 0, 1],\n        'icon-text-fit': 'both',\n        'icon-text-fit-padding': [10, 5, 5, 10],\n        'text-font': [MAP_MEDIUM_FONT],\n        'text-size': 13,\n        'icon-padding': 0,\n        'text-justify': 'left',\n        'text-line-height': 1.5,\n        'text-field': [\n            'format',\n            ['get', 'formattedDuration'],\n            {\n                'text-font': ['literal', [MAP_BOLD_FONT]],\n                'text-color': ['case', SELECTED_ROUTE_FILTER, 'black', DESELECTED_SECONDARY_COLOR],\n            },\n            ['concat', '\\t\\t', ['get', 'formattedDistance']],\n            { 'text-color': DESELECTED_SECONDARY_COLOR },\n            ['case', hasFormattedTraffic, '\\n', ''],\n            {},\n            [\n                'image',\n                [\n                    'case',\n                    hasFormattedTraffic,\n                    [\n                        'match',\n                        ['get', 'magnitudeOfDelay'],\n                        'major',\n                        TRAFFIC_MAJOR_IMAGE_ID,\n                        'moderate',\n                        TRAFFIC_MODERATE_IMAGE_ID,\n                        'minor',\n                        TRAFFIC_MINOR_IMAGE_ID,\n                        TRAFFIC_CLEAR_IMAGE_ID,\n                    ],\n                    '',\n                ],\n            ],\n            {},\n            ['case', hasFormattedTraffic, ['concat', '  ', ['get', 'formattedTraffic']], ''],\n            {\n                'text-font': ['literal', [MAP_BOLD_FONT]],\n                'text-color': magnitudeOfDelayTextColor,\n            },\n        ],\n    },\n    paint: {\n        'icon-translate': [0, -35],\n        'text-translate': [0, -35],\n    },\n};\n","import type { PlaceDisplayProps } from '../../places';\n\n/**\n * @group Routing\n */\nexport const START_INDEX = 'start';\n/**\n * @group Routing\n */\nexport const MIDDLE_INDEX = 'middle';\n/**\n * @group Routing\n */\nexport const FINISH_INDEX = 'finish';\n/**\n * @group Routing\n */\nexport type WaypointIndexType = typeof START_INDEX | typeof MIDDLE_INDEX | typeof FINISH_INDEX;\n\n/**\n * Display properties for a waypoint marker on the map.\n *\n * Extends location display properties with waypoint-specific information\n * including position in the route and stop numbering.\n *\n * @remarks\n * Waypoints are displayed differently based on their position:\n * - **Start**: Origin marker (often \"A\" or green pin)\n * - **Middle**: Numbered stop markers (1, 2, 3, etc.)\n * - **Finish**: Destination marker (often \"B\" or red pin)\n *\n * @example\n * ```typescript\n * // Start waypoint\n * const start: WaypointDisplayProps = {\n *   id: 'waypoint-0',\n *   iconID: 'waypoint-start',\n *   index: 0,\n *   indexType: 'start',\n *   title: 'Amsterdam Central Station'\n * };\n *\n * // Intermediate stop\n * const stop: WaypointDisplayProps = {\n *   id: 'waypoint-1',\n *   iconID: 'waypoint-stop',\n *   index: 1,\n *   indexType: 'middle',\n *   stopDisplayIndex: 1,\n *   title: 'Schiphol Airport'\n * };\n *\n * // Destination\n * const finish: WaypointDisplayProps = {\n *   id: 'waypoint-2',\n *   iconID: 'waypoint-finish',\n *   index: 2,\n *   indexType: 'finish',\n *   title: 'Rotterdam Central Station'\n * };\n * ```\n *\n * @group Routing\n */\nexport type WaypointDisplayProps = PlaceDisplayProps & {\n    /**\n     * The index of the waypoint in relation to the other waypoints.\n     *\n     * @remarks\n     * Zero-based index of this waypoint in the complete waypoints array,\n     * including start, all stops, and finish.\n     *\n     * @example\n     * ```typescript\n     * index: 0  // First waypoint (start)\n     * index: 1  // Second waypoint (first stop or finish)\n     * index: 2  // Third waypoint\n     * ```\n     */\n    index: number;\n\n    /**\n     * The type associated to the index, describing how the waypoint sits in the list of waypoints.\n     *\n     * @remarks\n     * Determines the waypoint's role and visual representation:\n     * - `start`: Origin point\n     * - `middle`: Intermediate stop\n     * - `finish`: Final destination\n     *\n     * This affects icon selection and labeling behavior.\n     */\n    indexType: WaypointIndexType;\n\n    /**\n     * The stop index to be displayed.\n     *\n     * @remarks\n     * Stops are the non-soft waypoints added between origin and destination,\n     * numbered starting from 1. Only present for middle waypoints.\n     *\n     * **Display Behavior:**\n     * - Start waypoint: undefined\n     * - First stop: 1\n     * - Second stop: 2\n     * - Finish waypoint: undefined\n     *\n     * Used for displaying stop numbers (e.g., \"Stop 1\", \"Stop 2\") in the UI.\n     *\n     * @example\n     * ```typescript\n     * stopDisplayIndex: 1  // First intermediate stop\n     * stopDisplayIndex: 2  // Second intermediate stop\n     * stopDisplayIndex: undefined  // Start or finish waypoint\n     * ```\n     */\n    stopDisplayIndex?: number;\n};\n\n/**\n * @ignore\n */\nexport const INDEX_TYPE = 'indexType';\n\n/**\n * @ignore\n */\nexport const STOP_DISPLAY_INDEX = 'stopDisplayIndex';\n","import type { ExpressionSpecification, SymbolLayerSpecification } from 'maplibre-gl';\nimport type { LayerSpecTemplate } from '../../shared';\nimport { MAP_BOLD_FONT } from '../../shared/layers/commonLayerProps';\nimport {\n    ICON_ID,\n    pinIconBaseLayout,\n    pinIconBasePaint,\n    pinTextBaseLayout,\n    pinTextBasePaint,\n} from '../../shared/layers/symbolLayers';\nimport { INDEX_TYPE, MIDDLE_INDEX, STOP_DISPLAY_INDEX } from '../types/waypointDisplayProps';\n\n/**\n * Waypoint start image ID.\n * @group Routing\n */\nexport const WAYPOINT_START_IMAGE_ID = 'waypointStart';\n/**\n * Waypoint stop image ID.\n *\n * @remarks\n * Used for intermediate waypoints in a route.\n *\n * @group Routing.\n */\nexport const WAYPOINT_STOP_IMAGE_ID = 'waypointStop';\n/**\n * Soft waypoint image ID.\n *\n * @remarks\n * This is currently unsupported in Orbis maps.\n *\n * @group Routing\n */\nexport const WAYPOINT_SOFT_IMAGE_ID = 'waypointSoft';\n/**\n * Waypoint finish image ID.\n *\n * @group Routing\n */\nexport const WAYPOINT_FINISH_IMAGE_ID = 'waypointFinish';\n\nconst isSoftWaypoint: ExpressionSpecification = [\n    'all',\n    ['==', ['get', INDEX_TYPE], MIDDLE_INDEX],\n    ['!', ['has', STOP_DISPLAY_INDEX]],\n];\n\nconst pinIndexLabelPaint: SymbolLayerSpecification['paint'] = {\n    'text-color': '#ffffff',\n};\n\nconst pinIndexLabelLayout: SymbolLayerSpecification['layout'] = {\n    // optional centered text to indicate stop numbers (1, 2 ...):\n    'text-field': ['get', STOP_DISPLAY_INDEX],\n    'text-font': [MAP_BOLD_FONT],\n    'text-size': ['interpolate', ['linear'], ['zoom'], 13, 14, 18, 16],\n    'text-offset': [0, -1.6],\n    // pin vs circle:\n    'icon-anchor': [\n        'case',\n        isSoftWaypoint,\n        'center',\n        // else\n        'bottom',\n    ],\n    'text-allow-overlap': true,\n};\n\n// TODO: reusable display of pins with indexes, not just waypoints\n/**\n * @ignore\n */\nexport const waypointSymbols: LayerSpecTemplate<SymbolLayerSpecification> = {\n    type: 'symbol',\n    paint: {\n        ...pinIconBasePaint,\n        ...pinIndexLabelPaint,\n    },\n    layout: {\n        ...pinIconBaseLayout,\n        ...pinIndexLabelLayout,\n        'symbol-sort-key': [\n            'case',\n            ['==', ['get', ICON_ID], WAYPOINT_SOFT_IMAGE_ID],\n            0,\n            ['abs', ['-', ['get', 'index'], 1000]],\n        ],\n    },\n};\n\n/**\n * @ignore\n */\nexport const waypointLabels: LayerSpecTemplate<SymbolLayerSpecification> = {\n    type: 'symbol',\n    paint: {\n        ...pinTextBasePaint,\n        'text-color': 'black',\n        'text-halo-width': 1.5,\n        'text-halo-color': '#ffffff',\n    },\n    layout: {\n        ...pinTextBaseLayout,\n        'text-anchor': 'top',\n        'text-offset': [0, 0.4],\n    },\n};\n","import { mapStyleLayerIDs } from '../../shared';\nimport type { RouteLayersConfig, RoutingModuleConfig } from '../types/routeModuleConfig';\nimport { chargingStopSymbol } from './chargingStopLayers';\nimport { instructionArrow, instructionLine, instructionOutline } from './guidanceLayers';\nimport { routeFerriesLine, routeFerriesSymbol } from './routeFerrySectionLayers';\nimport {\n    routeDeselectedLine,\n    routeDeselectedOutline,\n    routeLineArrows,\n    routeMainLine,\n    routeOutline,\n} from './routeMainLineLayers';\nimport { routeTollRoadsOutline, routeTollRoadsSymbol } from './routeTollRoadLayers';\nimport {\n    routeIncidentsBGLine,\n    routeIncidentsCauseSymbol,\n    routeIncidentsDashedLine,\n    routeIncidentsJamSymbol,\n} from './routeTrafficSectionLayers';\nimport { routeTunnelsLine } from './routeTunnelSectionLayers';\nimport { routeVehicleRestrictedBackgroundLine, routeVehicleRestrictedDottedLine } from './routeVehicleRestrictedLayers';\nimport { summaryBubbleSymbolPoint } from './summaryBubbleLayers';\nimport { waypointLabels, waypointSymbols } from './waypointLayers';\n\n/**\n * Generates the routing layers configuration for route visualization on the map.\n * @param config - Optional routing module configuration to customize layer properties.\n * @ignore\n */\nexport const buildRoutingLayers = (config: RoutingModuleConfig = {}): Required<RouteLayersConfig> => {\n    const configLayers = config.layers;\n    const configSectionLayers = configLayers?.sections;\n    const mainColor = config.theme?.mainColor;\n\n    return {\n        mainLines: {\n            routeLineArrows: {\n                ...routeLineArrows,\n                beforeID: mapStyleLayerIDs.lowestLabel,\n                ...configLayers?.mainLines?.routeLineArrows,\n            },\n            routeLine: {\n                ...routeMainLine({ color: mainColor }),\n                beforeID: 'routeIncidentBackgroundLine',\n                ...configLayers?.mainLines?.routeLine,\n            },\n            routeOutline: {\n                ...routeOutline,\n                beforeID: 'routeLine',\n                ...configLayers?.mainLines?.routeOutline,\n            },\n            routeDeselectedLine: {\n                ...routeDeselectedLine,\n                beforeID: 'routeOutline',\n                ...configLayers?.mainLines?.routeDeselectedLine,\n            },\n            routeDeselectedOutline: {\n                ...routeDeselectedOutline,\n                beforeID: 'routeDeselectedLine',\n                ...configLayers?.mainLines?.routeDeselectedOutline,\n            },\n            ...configLayers?.mainLines?.additional,\n        },\n        waypoints: {\n            routeWaypointSymbol: {\n                ...waypointSymbols,\n                beforeID: 'routeSummaryBubbleSymbol',\n                ...configLayers?.waypoints?.routeWaypointSymbol,\n            },\n            routeWaypointLabel: {\n                ...waypointLabels,\n                beforeID: 'routeWaypointSymbol',\n                ...configLayers?.waypoints?.routeWaypointLabel,\n            },\n            ...configLayers?.waypoints?.additional,\n        },\n        chargingStops: {\n            routeChargingStopSymbol: {\n                ...chargingStopSymbol(config.chargingStops),\n                beforeID: 'routeWaypointSymbol',\n                ...configLayers?.chargingStops?.routeChargingStopSymbol,\n            },\n            ...configLayers?.chargingStops?.additional,\n        },\n        sections: {\n            incident: {\n                routeIncidentJamSymbol: {\n                    ...routeIncidentsJamSymbol,\n                    beforeID: 'routeChargingStopSymbol',\n                    ...configSectionLayers?.incident?.routeIncidentJamSymbol,\n                },\n                routeIncidentCauseSymbol: {\n                    ...routeIncidentsCauseSymbol,\n                    beforeID: 'routeChargingStopSymbol',\n                    ...configSectionLayers?.incident?.routeIncidentCauseSymbol,\n                },\n                routeIncidentBackgroundLine: {\n                    ...routeIncidentsBGLine,\n                    beforeID: 'routeIncidentDashedLine',\n                    ...configSectionLayers?.incident?.routeIncidentBackgroundLine,\n                },\n                routeIncidentDashedLine: {\n                    ...routeIncidentsDashedLine,\n                    beforeID: 'routeTunnelLine',\n                    ...configSectionLayers?.incident?.routeIncidentDashedLine,\n                },\n            },\n            ferry: {\n                routeFerryLine: {\n                    ...routeFerriesLine,\n                    beforeID: 'routeLineArrows',\n                    ...configSectionLayers?.ferry?.routeFerryLine,\n                },\n                routeFerrySymbol: {\n                    ...routeFerriesSymbol,\n                    beforeID: 'routeIncidentJamSymbol',\n                    ...configSectionLayers?.ferry?.routeFerrySymbol,\n                },\n                ...configSectionLayers?.ferry?.additional,\n            },\n            tollRoad: {\n                routeTollRoadOutline: {\n                    ...routeTollRoadsOutline,\n                    beforeID: 'routeDeselectedOutline',\n                    ...configSectionLayers?.tollRoad?.routeTollRoadOutline,\n                },\n                routeTollRoadSymbol: {\n                    ...routeTollRoadsSymbol,\n                    beforeID: 'routeChargingStopSymbol',\n                    ...configSectionLayers?.tollRoad?.routeTollRoadSymbol,\n                },\n                ...configSectionLayers?.tollRoad?.additional,\n            },\n            tunnel: {\n                routeTunnelLine: {\n                    ...routeTunnelsLine,\n                    beforeID: 'routeLineArrows',\n                    ...configSectionLayers?.tunnel?.routeTunnelLine,\n                },\n                ...configSectionLayers?.tunnel?.additional,\n            },\n            vehicleRestricted: {\n                routeVehicleRestrictedBackgroundLine: {\n                    ...routeVehicleRestrictedBackgroundLine,\n                    beforeID: 'routeVehicleRestrictedForegroundLine',\n                    ...configSectionLayers?.vehicleRestricted?.routeVehicleRestrictedBackgroundLine,\n                },\n                routeVehicleRestrictedForegroundLine: {\n                    ...routeVehicleRestrictedDottedLine,\n                    beforeID: mapStyleLayerIDs.lowestLabel,\n                    ...configSectionLayers?.vehicleRestricted?.routeVehicleRestrictedForegroundLine,\n                },\n                ...configSectionLayers?.vehicleRestricted?.additional,\n            },\n        },\n        instructionLines: {\n            routeInstructionLine: {\n                ...instructionLine,\n                beforeID: mapStyleLayerIDs.lowestLabel,\n                ...configLayers?.instructionLines?.routeInstructionLine,\n            },\n            routeInstructionOutline: {\n                ...instructionOutline,\n                beforeID: 'routeInstructionLine',\n                ...configLayers?.instructionLines?.routeInstructionOutline,\n            },\n            ...configLayers?.instructionLines?.additional,\n        },\n        instructionArrows: {\n            routeInstructionArrowSymbol: {\n                ...instructionArrow,\n                beforeID: 'routeInstructionLine',\n                ...configLayers?.instructionArrows?.routeInstructionArrowSymbol,\n            },\n            ...configLayers?.instructionArrows?.additional,\n        },\n        summaryBubbles: {\n            routeSummaryBubbleSymbol: {\n                ...summaryBubbleSymbolPoint,\n                ...configLayers?.summaryBubbles?.routeSummaryBubbleSymbol,\n            },\n            ...configLayers?.summaryBubbles?.additional,\n        },\n    };\n};\n\n/**\n * Default routing layers configuration. Calls routingLayers with no parameters.\n *\n * @remarks\n * This configuration defines the complete visual styling for all route-related map layers,\n * including main route lines, waypoints, special road sections (ferries, tunnels, toll roads, etc.),\n * turn-by-turn guidance instructions, and route summary information.\n *\n * **Usage:**\n * - Automatically applied when initializing {@link RoutingModule} without custom layer configuration\n * - Can be used as a reference or starting point for creating custom layer configurations\n * - Individual properties can be selectively overridden while keeping defaults for others\n *\n * @see {@link buildRoutingLayers} for details.\n *\n * @see {@link RouteLayersConfig} for the configuration type definition\n * @see {@link RoutingModule.get} for initialization options\n * @see {@link RoutingModule.applyConfig} for runtime configuration updates\n *\n * @group Routing\n */\nexport const defaultRoutingLayers: Required<RouteLayersConfig> = buildRoutingLayers();\n","import type { StyleImageMetadata } from 'maplibre-gl';\nimport { SVGIconStyleOptions } from '../../shared';\nimport { isDOMImageSupported, svgToImg } from '../../shared/imageUtils';\nimport { parseSvg, pinSvg } from '../../shared/resources';\nimport circleSvgRaw from './circle.svg?raw';\nimport finishSvgRaw from './finish.svg?raw';\nimport instructionArrowSvgRaw from './instruction-line-arrow.svg?raw';\nimport startSvgRaw from './start.svg?raw';\nimport summaryMapBubbleSvgRaw from './summary-map-bubble.svg?raw';\nimport trafficSvgRaw from './traffic.svg?raw';\n\nlet instructionArrowIconImg: HTMLImageElement;\n\n// defensive check for SSR\nif (isDOMImageSupported()) {\n    instructionArrowIconImg = svgToImg(parseSvg(instructionArrowSvgRaw));\n}\n\n/**\n * @ignore\n */\nexport { instructionArrowIconImg };\n\n/**\n * @ignore\n */\nexport const summaryMapBubbleImg = (color: string): HTMLImageElement => {\n    // defensive check for SSR and node-test environments:\n    if (!isDOMImageSupported()) {\n        return undefined as never as HTMLImageElement;\n    }\n    const svg: SVGElement = parseSvg(summaryMapBubbleSvgRaw);\n    svg.querySelector('#bubble')?.setAttribute('fill', color);\n    svg.querySelector('#pin')?.setAttribute('fill', color);\n    return svgToImg(svg);\n};\n\n/**\n * Options to effectively stretch the summary bubble image to fit its text.\n * * They are tightly coupled with the SVG original dimensions.\n * @ignore\n */\nexport const summaryBubbleImageOptions: Partial<StyleImageMetadata> = {\n    pixelRatio: 2,\n    stretchX: [\n        [20, 45],\n        [100, 130],\n    ],\n    stretchY: [[20, 35]],\n    content: [10, 10, 130, 45],\n};\n\n/**\n * @ignore\n * @param color\n */\nexport const trafficImg = (color: string): HTMLImageElement => {\n    // defensive check for SSR and node-test environments:\n    if (!isDOMImageSupported()) {\n        return undefined as never as HTMLImageElement;\n    }\n    const svg: SVGElement = parseSvg(trafficSvgRaw);\n    const main = svg.querySelector('#main') as Element;\n    main.setAttribute('transform', 'scale(2)');\n    main.setAttribute('fill', color);\n    return svgToImg(svg);\n};\n\n/**\n * @ignore\n */\nexport const waypointIcon = (\n    foregroundSvg: SVGElement | undefined,\n    svgOptions: SVGIconStyleOptions | undefined,\n): HTMLImageElement => {\n    // defensive check for SSR and node-test environments:\n    if (!isDOMImageSupported()) {\n        return undefined as never as HTMLImageElement;\n    }\n    const svg = pinSvg(svgOptions);\n    if (foregroundSvg) {\n        svg.appendChild(foregroundSvg);\n    }\n    return svgToImg(svg);\n};\n\n/**\n * @ignore\n */\nexport const waypointStartIcon = (svgOptions: SVGIconStyleOptions | undefined): HTMLImageElement => {\n    // defensive check for SSR and node-test environments:\n    if (!isDOMImageSupported()) {\n        return undefined as never as HTMLImageElement;\n    }\n    return waypointIcon(parseSvg(startSvgRaw), svgOptions);\n};\n\n/**\n * @ignore\n */\nexport const waypointFinishIcon = (svgOptions: SVGIconStyleOptions | undefined): HTMLImageElement => {\n    // defensive check for SSR and node-test environments:\n    if (!isDOMImageSupported()) {\n        return undefined as never as HTMLImageElement;\n    }\n    return waypointIcon(parseSvg(finishSvgRaw), svgOptions);\n};\n\n/**\n * @ignore\n */\nexport const softWaypointIcon = (): HTMLImageElement => {\n    // defensive check for SSR and node-test environments:\n    if (!isDOMImageSupported()) {\n        return undefined as never as HTMLImageElement;\n    }\n    return svgToImg(parseSvg(circleSvgRaw));\n};\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"50\\\" height=\\\"50\\\">\\n    <path d=\\\"M1.562 40.569L25 1.562l23.438 39.007L25 27.566 1.562 40.569z\\\" fill=\\\"#fff\\\"/>\\n    <path d=\\\"M25.369.107c.782.429.506.167.917.682l23.438 39.007c.79 1.316-.671 2.829-2.014 2.085L25 29.281l-22.71 12.6c-1.343.744-2.804-.769-2.014-2.085L23.714.789c.461-.694.9-.682 1.656-.682zM25 1.562L1.562 40.569 25 27.566l23.438 13.003L25 1.562z\\\"\\n          fill=\\\"gray\\\"/>\\n</svg>\\n\"","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"160\\\" height=\\\"65\\\">\\n    <g filter=\\\"url(#A)\\\">\\n        <rect id=\\\"pin\\\" x=\\\"81.899\\\" y=\\\"47\\\" width=\\\"10\\\" height=\\\"10\\\" rx=\\\"2\\\" transform=\\\"rotate(45 81.899 47)\\\"/>\\n        <rect id=\\\"bubble\\\" x=\\\"10\\\" y=\\\"10\\\" width=\\\"140\\\" height=\\\"45\\\" rx=\\\"12\\\"/>\\n    </g>\\n    <defs>\\n        <filter id=\\\"A\\\">\\n            <feDropShadow dx=\\\"0\\\" dy=\\\"2\\\" stdDeviation=\\\"4\\\" flood-opacity=\\\".3\\\"/>\\n        </filter>\\n    </defs>\\n</svg>\\n\"","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"32\\\" height=\\\"32\\\">\\n    <g id=\\\"main\\\">\\n        <path fill-rule=\\\"evenodd\\\"\\n              d=\\\"M11.389 4H9.025a.86.86 0 0 0-.517.173l-.001-.001a.5.5 0 0 1-.464.059l-.028-.011a.5.5 0 0 1-.129-.83A1.86 1.86 0 0 1 9.025 3h2.364a2 2 0 0 1 1.789 1.106l1.02 2.04c.471.176.802.63.802 1.156v.803c0 .543 0 .815-.071 1.038a1.5 1.5 0 0 1-.914.953c-.219.08-.491.092-1.034.114l-1.481.062v-.166-.803a2.23 2.23 0 0 0-1.055-1.897l-.74-1.479 2.326.033h.955l-.703-1.406A1 1 0 0 0 11.389 4zM12 8.4a1 1 0 1 1 2 0 .5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z\\\"/>\\n        <path d=\\\"M11.833 11.115c0-.109.089-.198.198-.198h1.979c.109 0 .198.089.198.198 0 .328-.266.594-.594.594h-1.187c-.328 0-.594-.266-.594-.594z\\\"/>\\n        <path fill-rule=\\\"evenodd\\\"\\n              d=\\\"M1.802 8.146C1.331 8.321 1 8.776 1 9.302v.803c0 .543 0 .815.071 1.038a1.5 1.5 0 0 0 .914.953c.219.08.491.092 1.034.114l2.731.114 2.731-.114c.543-.023.814-.034 1.034-.114a1.5 1.5 0 0 0 .914-.953c.071-.223.071-.494.071-1.038v-.803c0-.526-.331-.98-.802-1.156l-1.02-2.04A2 2 0 0 0 6.889 5H4.611a2 2 0 0 0-1.789 1.106l-1.02 2.04zM6.889 6H4.611a1 1 0 0 0-.894.553l-.703 1.406h.955 3.563.955l-.703-1.406A1 1 0 0 0 6.889 6zM2 10.4a1 1 0 1 1 2 0 .5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm6.5-1a1 1 0 0 0-1 1 .5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5 1 1 0 0 0-1-1z\\\"/>\\n        <path d=\\\"M1.792 13.115c0-.109.089-.198.198-.198h1.979c.109 0 .198.089.198.198 0 .328-.266.594-.594.594H2.385c-.328 0-.594-.266-.594-.594zm5.739-.198c-.109 0-.198.089-.198.198 0 .328.266.594.594.594h1.188c.328 0 .594-.266.594-.594 0-.109-.089-.198-.198-.198h-1.98z\\\"/>\\n    </g>\\n</svg>\\n\"","import { TomTomConfig } from '@tomtom-org/maps-sdk/core';\nimport type { ToBeAddedLayerSpecTemplate, ToBeAddedLayerSpecWithoutSource } from '../../shared';\nimport { buildRoutingLayers } from '../layers/routingLayers';\nimport type { RouteLayersConfig, RoutingModuleConfig } from '../types/routeModuleConfig';\nimport type { RoutingLayersSpecs } from '../types/routingSourcesAndLayers';\n\n/**\n * @ignore\n */\nconst mapLayerSpecs = (\n    layerSpecs: Record<string, Partial<ToBeAddedLayerSpecTemplate>> = {},\n): ToBeAddedLayerSpecWithoutSource[] =>\n    // The key of the entry is the layer ID:\n    Object.entries(layerSpecs).map(([id, spec]) => ({ ...spec, id }) as ToBeAddedLayerSpecWithoutSource);\n\n/**\n * @ignore\n */\nexport const createLayersSpecs = (layerConfigs: RouteLayersConfig = {}): RoutingLayersSpecs => ({\n    mainLines: mapLayerSpecs(layerConfigs.mainLines),\n    waypoints: mapLayerSpecs(layerConfigs.waypoints),\n    chargingStops: mapLayerSpecs(layerConfigs?.chargingStops),\n    ferries: mapLayerSpecs(layerConfigs.sections?.ferry),\n    incidents: mapLayerSpecs(layerConfigs.sections?.incident),\n    tollRoads: mapLayerSpecs(layerConfigs.sections?.tollRoad),\n    tunnels: mapLayerSpecs(layerConfigs.sections?.tunnel),\n    vehicleRestricted: mapLayerSpecs(layerConfigs.sections?.vehicleRestricted),\n    instructionLines: mapLayerSpecs(layerConfigs.instructionLines),\n    instructionArrows: mapLayerSpecs(layerConfigs.instructionArrows),\n    summaryBubbles: mapLayerSpecs(layerConfigs.summaryBubbles),\n});\n\n/**\n * @ignore\n */\nexport const routeModuleConfigWithDefaults = (config: RoutingModuleConfig | undefined): RoutingModuleConfig => {\n    const globalDisplayUnits = TomTomConfig.instance.get().displayUnits;\n    const displayUnits = config?.displayUnits;\n    return {\n        // First apply the provided configuration not to lose any properties:\n        ...config,\n        ...(displayUnits ? {} : { displayUnits: globalDisplayUnits }),\n        layers: buildRoutingLayers(config),\n    };\n};\n","const e={commonBaseURL:\"https://api.tomtom.com\",apiKey:\"\",apiVersion:1},t=class{constructor(){this.config={...e}}put(e){this.config={...this.config,...e}}reset(){this.config={...e}}get(){return this.config}};t.instance=new t;let r=t;const n=(e={})=>({...r.instance.get(),...e}),a=[\"Public\",\"Authorized\",\"Restricted\",\"Private\",\"Unknown\"],o=[\"Available\",\"Reserved\",\"Occupied\",\"OutOfService\",\"Unknown\"],i=[\"ChargingProfileCapable\",\"ChargingPreferencesCapable\",\"ChipCardSupport\",\"ContactlessCardSupport\",\"CreditCardPayable\",\"DebitCardPayable\",\"PedTerminal\",\"RemoteStartStopCapable\",\"Reservable\",\"RfidReader\",\"StartSessionConnectorRequired\",\"TokenGroupCapable\",\"UnlockCapable\",\"PlugAndCharge\",\"Unknown\"],s=[\"EvOnly\",\"Plugged\",\"Disabled\",\"Customers\",\"Motorcycles\"],c=[\"StandardHouseholdCountrySpecific\",\"IEC62196Type1\",\"IEC62196Type1CCS\",\"IEC62196Type2CableAttached\",\"IEC62196Type2Outlet\",\"IEC62196Type2CCS\",\"IEC62196Type3\",\"Chademo\",\"GBT20234Part2\",\"GBT20234Part3\",\"IEC60309AC3PhaseRed\",\"IEC60309AC1PhaseBlue\",\"IEC60309DCWhite\",\"Tesla\"],u=[\"AC1\",\"AC3\",\"DC\"],d=[\"Country\",\"CountrySubdivision\",\"CountrySecondarySubdivision\",\"CountryTertiarySubdivision\",\"Municipality\",\"MunicipalitySubdivision\",\"Neighbourhood\",\"PostalCodeArea\"],l=[\"POI\",\"Street\",\"Geography\",\"Point Address\",\"Address Range\",\"Cross Street\"],_=[\"Small_Paddle_Inductive\",\"Large_Paddle_Inductive\",\"IEC_60309_1_Phase\",\"IEC_60309_3_Phase\",\"IEC_62196_Type_1_Outlet\",\"IEC_62196_Type_2_Outlet\",\"IEC_62196_Type_3_Outlet\",\"IEC_62196_Type_1_Connector_Cable_Attached\",\"IEC_62196_Type_2_Connector_Cable_Attached\",\"IEC_62196_Type_3_Connector_Cable_Attached\",\"Combo_to_IEC_62196_Type_1_Base\",\"Combo_to_IEC_62196_Type_2_Base\",\"Type_E_French_Standard_CEE_7_5\",\"Type_F_Schuko_CEE_7_4\",\"Type_G_British_Standard_BS_1363\",\"Type_J_Swiss_Standard_SEV_1011\",\"China_GB_Part_2\",\"China_GB_Part_3\",\"IEC_309_DC_Plug\",\"AVCON_Connector\",\"Tesla_Connector\",\"NEMA_5_20\",\"CHAdeMO\",\"SAE_J1772\",\"TEPCO\",\"Better_Place_Socket\",\"Marechal_Socket\",\"Standard_Household_Country_Specific\"],p=[\"No_Payment\",\"Subscription\",\"Direct\"],y=[\"tollRoads\",\"motorways\",\"ferries\",\"unpavedRoads\",\"carpools\",\"alreadyUsedRoads\",\"borderCrossings\",\"tunnels\",\"carTrains\",\"lowEmissionZones\"],C=[\"jam\",\"accident\",\"roadworks\",\"road-closed\",\"narrow-lanes\",\"danger\",\"animals-on-road\",\"broken-down-vehicle\",\"lane-closed\",\"wind\",\"fog\",\"rain\",\"frost\",\"flooding\",\"other\"],h=[\"carTrain\",\"ferry\",\"tunnel\",\"motorway\",\"pedestrian\",\"toll\",\"tollVignette\",\"country\",\"vehicleRestricted\",\"traffic\",\"carpool\",\"urban\",\"unpaved\",\"lowEmissionZone\",\"speedLimit\",\"roadShields\",\"importantRoadStretch\"],g=[...h,\"lanes\"],$=[...g,\"leg\"],m=[\"Unified\",\"AR\",\"IN\",\"PK\",\"IL\",\"MA\",\"RU\",\"TR\",\"CN\"],f=e=>!!e&&(e.length>=4&&e[3]!==e[1]&&e[2]!==e[0]),S=e=>f(e)?e:void 0,b=(e,t)=>{if(e&&!(e.length<2))return t?[t[0]>e[0]?e[0]:t[0],t[1]>e[1]?e[1]:t[1],t[2]<e[0]?e[0]:t[2],t[3]<e[1]?e[1]:t[3]]:[e[0],e[1],e[0],e[1]]},E=(e,t)=>t&&e?[t[0]>e[0]?e[0]:t[0],t[1]>e[1]?e[1]:t[1],t[2]<e[2]?e[2]:t[2],t[3]<e[3]?e[3]:t[3]]:e||t,M=e=>e?.length?e.reduce((e,t)=>E(t,e)):void 0,P=e=>{const t=e?.length;if(!t)return;let r;const n=Math.ceil(t/1e3);for(let a=0;a<t;a+=n)r=b(e[a],r);return 1===n?r:b(e[t-1],r)},T=e=>{if(e){if(Array.isArray(e))return\"number\"==typeof e[0]?e.length>=4?e:void 0:M(e.map(e=>T(e)));if(e.bbox)return e.bbox;switch(e.type){case\"Feature\":return T(e.geometry);case\"FeatureCollection\":return M(e.features.map(T));case\"GeometryCollection\":return M(e.geometries.map(T));case\"Point\":return b(e.coordinates);case\"LineString\":case\"MultiPoint\":return P(e.coordinates);case\"MultiLineString\":case\"Polygon\":return M(e.coordinates.map(P));case\"MultiPolygon\":return M(e.coordinates.flatMap(e=>e.map(P)));default:return}}},A=(e,t)=>E(T(e),t),I=e=>[(e[0]+e[2])/2,(e[1]+e[3])/2],v=()=>Date.now().toString(36)+Math.random().toString(36).substring(2),w=\"MapsSDKJS\",R=e=>{if(!/^[a-zA-Z0-9-]{1,100}$/.test(e))throw new TypeError(`a string matching regular expression ^[a-zA-Z0-9-]{1,100}$ is expected, but ${e} ['${typeof e}'] given`);return e},k=e=>({\"TomTom-User-Agent\":`${w}/0.34.0`,...e.trackingId&&{\"Tracking-ID\":R(e.trackingId)}}),O=(e,t)=>{if(e){if(Array.isArray(e))return e;if(e.coordinates)return e.coordinates;if(e.geometry){if(\"main-when-available\"===t?.useEntryPoint){const t=(r=e,r?.properties?.entryPoints?.find(e=>\"main\"===e.type));return t?.position??e.geometry.coordinates}return e.geometry.coordinates}}var r;return null},B=(e,t)=>{const r=O(e,t);if(!r)throw new Error(`The received object does not have lng-lat coordinates: ${JSON.stringify(e)}`);return r},U=e=>({type:\"Feature\",geometry:{type:\"Point\",coordinates:e},properties:{}}),D=(e,t)=>{let r;return r=Array.isArray(e)||\"Feature\"!==e.type?U(B(e)):e,{...r,properties:{...r.properties,radiusMeters:t}}},N=e=>Array.isArray(e)?Array.isArray(e[0])?\"path\":\"waypoint\":\"Feature\"===e.type&&\"LineString\"===e.geometry.type?\"path\":\"waypoint\",G=[\"unknown\",\"minor\",\"moderate\",\"major\",\"indefinite\"];const F=e=>e?.minutes??\"min\",L=(e,t)=>{if(e){const a=Math.abs(e)/3600;let o=Math.floor(a),i=Math.round(a%1*60);60===i&&(i=0,o++);const s={...r.instance.get().displayUnits?.time,...t};if(o)return`${o} ${n=s,n?.hours??\"hr\"} ${i.toString().padStart(2,\"0\")} ${F(s)}`;if(i)return`${i.toString()} ${F(s)}`}var n},x=1609.344,J=e=>e?.meters??\"m\",V=e=>e?.kilometers??\"km\",Z=(e,t,r)=>t<3?((e,t,r)=>{const n=Number.parseInt(t.toString()),a=t-n,o=e<0?\"-\":\"\";if(a<.125)return`${o}${n} ${r}`;const i=n>0?n:\"\";return a<.375?`${o}${i} ${r}`:a<.625?`${o}${i} ${r}`:a<.875?`${o}${i} ${r}`:`${o}${n+1} ${r}`})(e,t,r):t<10?((e,t,r)=>{const n=Number.parseInt(t.toString()),a=t-n,o=e<0?\"-\":\"\";return a<.25?`${o}${n} ${r}`:a<.75?`${o}${n} ${r}`:`${o}${n+1} ${r}`})(e,t,r):`${Math.round(e)} ${r}`,j=e=>e.miles??\"mi\",z=(e,t)=>{const r=e/x,n=Math.abs(r);return n<.125?((e,t)=>{const r=Math.round(e/.3048),n=Math.abs(r);return n<30?`${r} ${t}`:n<500?`${10*Math.round(r/10)} ${t}`:`${100*Math.round(r/100)} ${t}`})(e,t.feet??\"ft\"):Z(r,n,j(t))},H=(e,t)=>{const r=e/x,n=Math.abs(r);return n<.125?((e,t)=>{const r=Math.round(e/.9144);return Math.abs(r)<10?`${Math.round(r)} ${t}`:`${10*Math.round(r/10)} ${t}`})(e,t.yards??\"yd\"):Z(r,n,j(t))},K=(e,t)=>{if(null==e)return\"\";const n={...r.instance.get().displayUnits?.distance,...t};switch(n?.type??\"metric\"){case\"metric\":return((e,t)=>{const r=Math.abs(e);if(r<10)return`${e} ${J(t)}`;if(r<500)return`${10*Math.round(e/10)} ${J(t)}`;if(r<1e3){const r=100*Math.round(e/100);return 1e3===r||-1e3===r?`${e<0?\"-\":\"\"}1 ${V(t)}`:`${r} ${J(t)}`}return r<1e4?`${100*Math.round(e/100)/1e3} ${V(t)}`:`${Math.round(e/1e3)} ${V(t)}`})(e,n);case\"imperial_us\":return z(e,n);case\"imperial_uk\":return H(e,n)}};export{w as TOMTOM_USER_AGENT_SDK_NAME,r as TomTomConfig,D as asSoftWaypoint,y as avoidableTypes,I as bboxCenter,E as bboxExpandedWithBBox,A as bboxExpandedWithGeoJSON,b as bboxExpandedWithPosition,M as bboxFromBBoxes,P as bboxFromCoordsArray,T as bboxFromGeoJSON,S as bboxOnlyIfWithArea,i as chargingPointCapabilities,s as chargingPointRestrictions,o as chargingPointStatus,a as chargingStationAccessTypes,c as connectorTypes,u as currentTypes,e as defaultConfig,K as formatDistance,L as formatDuration,v as generateId,k as generateTomTomHeaders,d as geographyTypes,O as getPosition,B as getPositionStrict,N as getRoutePlanningLocationType,G as indexedMagnitudes,h as inputSectionTypes,g as inputSectionTypesWithGuidance,f as isBBoxWithArea,n as mergeFromGlobal,p as paymentMethods,l as placeTypes,_ as plugTypes,$ as sectionTypes,U as toPointFeature,C as trafficCategories,m as views};\n//# sourceMappingURL=core.es.js.map\n","import { ChargingStop, ChargingStopProps, formatDuration, type Place, type Routes } from 'core';\nimport { FeatureCollection, Point } from 'geojson';\nimport { PlaceDisplayProps } from '../../places';\nimport type { DisplayRouteProps, RouteStateProps } from '../types/displayRoutes';\nimport { RoutingModuleConfig } from '../types/routeModuleConfig';\n\nconst getIconID = (chargingStop: ChargingStop, config: RoutingModuleConfig | undefined): string => {\n    const iconConfig = config?.chargingStops?.icon;\n    if (iconConfig?.mapping) {\n        const mapping = iconConfig.mapping;\n        switch (mapping.basedOn) {\n            case 'chargingSpeed':\n                if (chargingStop.properties.chargingConnectionInfo?.chargingSpeed) {\n                    return mapping.value[chargingStop.properties.chargingConnectionInfo?.chargingSpeed];\n                }\n                break;\n            case 'custom':\n                return mapping.fn(chargingStop);\n        }\n    }\n\n    // default: (genesis-like) categorySet ID for \"EV Charging Station\" based on search\n    return '7309';\n};\n\nconst formatTitle = (chargingStop: ChargingStop): string => {\n    const properties = chargingStop.properties;\n    return properties.chargingParkName ?? (properties.chargingParkOperatorName as string);\n};\n\ntype DisplayChargingStopProps = PlaceDisplayProps &\n    ChargingStopProps &\n    RouteStateProps & {\n        chargingDuration: string;\n        chargingPower: string;\n    };\n\ntype DisplayChargingStops = FeatureCollection<Point, DisplayChargingStopProps>;\n\n/**\n * Generates display-ready charging stations for the given planning context ones.\n * @param routes The routes return for ldEV.\n * @param config The charging stops display configuration.\n * @see chargingStopLayers\n * @ignore\n */\nexport const toDisplayChargingStops = (\n    routes: Routes<DisplayRouteProps>,\n    config: RoutingModuleConfig | undefined,\n): DisplayChargingStops => {\n    const displayChargingStops: Place<DisplayChargingStopProps>[] = [];\n\n    if (config?.chargingStops?.visible !== false) {\n        for (const route of routes.features) {\n            for (const leg of route.properties.sections.leg) {\n                const chargingStop = leg.summary.chargingInformationAtEndOfLeg;\n\n                if (chargingStop) {\n                    const properties = chargingStop.properties;\n                    displayChargingStops.push({\n                        ...chargingStop,\n                        properties: {\n                            ...chargingStop.properties,\n                            id: chargingStop.properties.chargingParkId,\n                            iconID: getIconID(chargingStop, config),\n                            title: formatTitle(chargingStop),\n                            chargingPower: `${properties.chargingConnectionInfo?.chargingPowerInkW} kW`,\n                            chargingDuration: formatDuration(\n                                properties.chargingTimeInSeconds,\n                                config?.displayUnits?.time,\n                            ) as string,\n                            routeState: route.properties.routeState,\n                        },\n                    });\n                }\n            }\n        }\n    }\n    return { type: 'FeatureCollection', features: displayChargingStops };\n};\n","import type { TrafficSectionProps } from '@tomtom-org/maps-sdk/core';\nimport { formatDuration } from '@tomtom-org/maps-sdk/core';\nimport type { DisplayTrafficSectionProps } from '../types/routeSections';\n\nconst hasJam = (sectionProps: TrafficSectionProps): boolean => sectionProps.categories.includes('jam');\n\nconst buildTitle = (sectionProps: TrafficSectionProps): string | undefined => {\n    if (hasJam(sectionProps)) {\n        return formatDuration(sectionProps.delayInSeconds);\n    }\n    return undefined;\n};\n\nconst toTrafficJamIconSuffix = (title: string | undefined): 'collapsed' | 'small' | 'medium' | 'large' => {\n    if (!title?.length) {\n        return 'collapsed';\n    }\n    if (title.length < 6) {\n        // 1 digit minutes\n        return 'small';\n    }\n    if (title.length < 8) {\n        // 2 digit minutes\n        return 'medium';\n    }\n    // hours + minutes\n    return 'large';\n};\n\nconst toJamIconID = (sectionProps: TrafficSectionProps, title: string | undefined): string | null => {\n    if (!hasJam(sectionProps)) {\n        return null;\n    }\n    const magnitude = sectionProps.magnitudeOfDelay ?? 'unknown';\n    return `traffic-jam-${magnitude}-${toTrafficJamIconSuffix(title)}`;\n};\n\nconst toCauseIconID = (sectionProps: TrafficSectionProps): string | null => {\n    const firstNonJamCategory = sectionProps.categories.find((category) => category !== 'jam');\n    switch (firstNonJamCategory) {\n        case 'accident':\n            return 'traffic-incidents-accident';\n        case 'roadworks':\n            return 'traffic-incidents-roadworks';\n        case 'road-closed':\n            return 'traffic-incidents-road_closed';\n        case 'danger':\n        case 'animals-on-road':\n            return 'traffic-incidents-danger';\n        case 'broken-down-vehicle':\n            return 'traffic-incidents-broken_down_vehicle';\n        case 'lane-closed':\n        case 'narrow-lanes':\n            return 'traffic-incidents-lane_closed';\n        case 'wind':\n            return 'traffic-incidents-wind';\n        case 'fog':\n            return 'traffic-incidents-fog';\n        case 'rain':\n            return 'traffic-incidents-rain';\n        case 'frost':\n            return 'traffic-incidents-frost';\n        case 'flooding':\n            return 'traffic-incidents-flooding';\n        default:\n            return null;\n    }\n};\n\n/**\n * @ignore\n */\nexport const toDisplayTrafficSectionProps = (\n    sectionProps: TrafficSectionProps,\n): Omit<DisplayTrafficSectionProps, 'routeState' | 'routeIndex'> => {\n    const title = buildTitle(sectionProps);\n    const jamIconID = toJamIconID(sectionProps, title);\n    const causeIconID = toCauseIconID(sectionProps);\n    return {\n        ...sectionProps,\n        ...(jamIconID && { jamIconID }),\n        ...(causeIconID && { causeIconID }),\n        ...(title && { title }),\n    };\n};\n","import type { CommonPlaceProps, Waypoint, WaypointLike, Waypoints } from '@tomtom-org/maps-sdk/core';\nimport { generateId, getPosition } from '@tomtom-org/maps-sdk/core';\nimport type { Point, Position } from 'geojson';\nimport {\n    WAYPOINT_FINISH_IMAGE_ID,\n    WAYPOINT_SOFT_IMAGE_ID,\n    WAYPOINT_START_IMAGE_ID,\n    WAYPOINT_STOP_IMAGE_ID,\n} from '../layers/waypointLayers';\nimport type { PlanningWaypoint } from '../types/planningWaypoint';\nimport type { WaypointsConfig } from '../types/routeModuleConfig';\nimport type { WaypointDisplayProps, WaypointIndexType } from '../types/waypointDisplayProps';\nimport { FINISH_INDEX, MIDDLE_INDEX, START_INDEX } from '../types/waypointDisplayProps';\n\nconst indexTypeFor = (index: number, arrayLength: number): WaypointIndexType =>\n    index === 0 ? START_INDEX : index < arrayLength - 1 ? MIDDLE_INDEX : FINISH_INDEX;\n\n/**\n * Builds the title of the given waypoint.\n * @param waypoint The waypoint for which to build the title.\n */\nexport const buildWaypointTitle = (waypoint: Waypoint): string | undefined => {\n    const placeProperties = waypoint?.properties as CommonPlaceProps;\n    return placeProperties?.poi?.name ?? placeProperties?.address?.freeformAddress ?? undefined;\n};\n\nexport const getImageIDForWaypoint = (waypoint: Waypoint, indexType: WaypointIndexType): string => {\n    if (waypoint.properties.radiusMeters) {\n        return WAYPOINT_SOFT_IMAGE_ID;\n    }\n    switch (indexType) {\n        case 'start':\n            return WAYPOINT_START_IMAGE_ID;\n        case 'finish':\n            return WAYPOINT_FINISH_IMAGE_ID;\n        default:\n            return WAYPOINT_STOP_IMAGE_ID;\n    }\n};\n\nconst toWaypointFromPosition = (position: Position): Waypoint => ({\n    type: 'Feature',\n    geometry: {\n        type: 'Point',\n        coordinates: position,\n    },\n    properties: {},\n});\n\nconst toWaypointFromPoint = (point: Point): Waypoint => ({\n    type: 'Feature',\n    geometry: point,\n    properties: {},\n    ...(point.bbox && { bbox: point.bbox }),\n});\n\nconst asWaypoint = (waypointInput: WaypointLike): Waypoint => {\n    if (Array.isArray(waypointInput)) {\n        return toWaypointFromPosition(waypointInput);\n    }\n    if (waypointInput.type === 'Point') {\n        return toWaypointFromPoint(waypointInput);\n    }\n    return waypointInput as Waypoint;\n};\n\n/**\n * Determines whether the given waypoint is a regular start/stop/destination with guidance attached,\n * as opposed to a circle (soft) waypoint.\n * @param waypoint The waypoint to verify.\n */\nexport const isHardWaypoint = (waypoint: Waypoint): boolean => !waypoint.properties.radiusMeters;\n\n/**\n * Generates display-ready waypoints for the given planning context ones.\n * @param waypoints The planning context waypoints.\n * @param options\n */\nexport const toDisplayWaypoints = (\n    waypoints: PlanningWaypoint[],\n    options: WaypointsConfig | undefined,\n): Waypoints<WaypointDisplayProps> => {\n    // Since waypoints are of mixed types (hard and soft), we need to calculate the hard-only indexes\n    // in case we have stops with numbered icons:\n    let hardWaypointIndex = -1;\n    return {\n        type: 'FeatureCollection',\n        features: waypoints\n            .map((waypointInput, index) => {\n                if (!waypointInput) {\n                    // (we consider placeholder waypoints to be \"hard\", since they typically occupy a position in a planner panel)\n                    hardWaypointIndex++;\n                    // (will be filtered out below - we don't pre-filter it to keep the original input index)\n                    return null as unknown as Waypoint<WaypointDisplayProps>;\n                }\n                const waypoint: Waypoint = asWaypoint(waypointInput);\n                const indexType = indexTypeFor(index, waypoints.length);\n                const hardWaypoint = isHardWaypoint(waypoint);\n                if (hardWaypoint) {\n                    hardWaypointIndex++;\n                }\n                const title = buildWaypointTitle(waypoint);\n                const id = waypoint.id ?? generateId();\n                return {\n                    ...waypoint,\n                    id,\n                    ...(options?.entryPoints === 'main-when-available' && {\n                        geometry: {\n                            type: 'Point',\n                            // We replace the waypoint coordinates with their main entry point ones:\n                            coordinates: getPosition(waypoint, { useEntryPoint: 'main-when-available' }),\n                        } as Point,\n                    }),\n                    properties: {\n                        ...waypoint.properties,\n                        id, // adding id in display properties due to GeoJSONSourceWithLayers promoteID feature\n                        index,\n                        indexType,\n                        ...(title && { title }),\n                        iconID: getImageIDForWaypoint(waypoint, indexType),\n                        ...(hardWaypoint && indexType === MIDDLE_INDEX && { stopDisplayIndex: hardWaypointIndex }),\n                    },\n                };\n            })\n            .filter((feature) => feature),\n    };\n};\n","// index.ts\nvar earthRadius = 63710088e-1;\nvar factors = {\n  centimeters: earthRadius * 100,\n  centimetres: earthRadius * 100,\n  degrees: 360 / (2 * Math.PI),\n  feet: earthRadius * 3.28084,\n  inches: earthRadius * 39.37,\n  kilometers: earthRadius / 1e3,\n  kilometres: earthRadius / 1e3,\n  meters: earthRadius,\n  metres: earthRadius,\n  miles: earthRadius / 1609.344,\n  millimeters: earthRadius * 1e3,\n  millimetres: earthRadius * 1e3,\n  nauticalmiles: earthRadius / 1852,\n  radians: 1,\n  yards: earthRadius * 1.0936\n};\nvar areaFactors = {\n  acres: 247105e-9,\n  centimeters: 1e4,\n  centimetres: 1e4,\n  feet: 10.763910417,\n  hectares: 1e-4,\n  inches: 1550.003100006,\n  kilometers: 1e-6,\n  kilometres: 1e-6,\n  meters: 1,\n  metres: 1,\n  miles: 386e-9,\n  nauticalmiles: 29155334959812285e-23,\n  millimeters: 1e6,\n  millimetres: 1e6,\n  yards: 1.195990046\n};\nfunction feature(geom, properties, options = {}) {\n  const feat = { type: \"Feature\" };\n  if (options.id === 0 || options.id) {\n    feat.id = options.id;\n  }\n  if (options.bbox) {\n    feat.bbox = options.bbox;\n  }\n  feat.properties = properties || {};\n  feat.geometry = geom;\n  return feat;\n}\nfunction geometry(type, coordinates, _options = {}) {\n  switch (type) {\n    case \"Point\":\n      return point(coordinates).geometry;\n    case \"LineString\":\n      return lineString(coordinates).geometry;\n    case \"Polygon\":\n      return polygon(coordinates).geometry;\n    case \"MultiPoint\":\n      return multiPoint(coordinates).geometry;\n    case \"MultiLineString\":\n      return multiLineString(coordinates).geometry;\n    case \"MultiPolygon\":\n      return multiPolygon(coordinates).geometry;\n    default:\n      throw new Error(type + \" is invalid\");\n  }\n}\nfunction point(coordinates, properties, options = {}) {\n  if (!coordinates) {\n    throw new Error(\"coordinates is required\");\n  }\n  if (!Array.isArray(coordinates)) {\n    throw new Error(\"coordinates must be an Array\");\n  }\n  if (coordinates.length < 2) {\n    throw new Error(\"coordinates must be at least 2 numbers long\");\n  }\n  if (!isNumber(coordinates[0]) || !isNumber(coordinates[1])) {\n    throw new Error(\"coordinates must contain numbers\");\n  }\n  const geom = {\n    type: \"Point\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction points(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return point(coords, properties);\n    }),\n    options\n  );\n}\nfunction polygon(coordinates, properties, options = {}) {\n  for (const ring of coordinates) {\n    if (ring.length < 4) {\n      throw new Error(\n        \"Each LinearRing of a Polygon must have 4 or more Positions.\"\n      );\n    }\n    if (ring[ring.length - 1].length !== ring[0].length) {\n      throw new Error(\"First and last Position are not equivalent.\");\n    }\n    for (let j = 0; j < ring[ring.length - 1].length; j++) {\n      if (ring[ring.length - 1][j] !== ring[0][j]) {\n        throw new Error(\"First and last Position are not equivalent.\");\n      }\n    }\n  }\n  const geom = {\n    type: \"Polygon\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction polygons(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return polygon(coords, properties);\n    }),\n    options\n  );\n}\nfunction lineString(coordinates, properties, options = {}) {\n  if (coordinates.length < 2) {\n    throw new Error(\"coordinates must be an array of two or more positions\");\n  }\n  const geom = {\n    type: \"LineString\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction lineStrings(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return lineString(coords, properties);\n    }),\n    options\n  );\n}\nfunction featureCollection(features, options = {}) {\n  const fc = { type: \"FeatureCollection\" };\n  if (options.id) {\n    fc.id = options.id;\n  }\n  if (options.bbox) {\n    fc.bbox = options.bbox;\n  }\n  fc.features = features;\n  return fc;\n}\nfunction multiLineString(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiLineString\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction multiPoint(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiPoint\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction multiPolygon(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiPolygon\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction geometryCollection(geometries, properties, options = {}) {\n  const geom = {\n    type: \"GeometryCollection\",\n    geometries\n  };\n  return feature(geom, properties, options);\n}\nfunction round(num, precision = 0) {\n  if (precision && !(precision >= 0)) {\n    throw new Error(\"precision must be a positive number\");\n  }\n  const multiplier = Math.pow(10, precision || 0);\n  return Math.round(num * multiplier) / multiplier;\n}\nfunction radiansToLength(radians, units = \"kilometers\") {\n  const factor = factors[units];\n  if (!factor) {\n    throw new Error(units + \" units is invalid\");\n  }\n  return radians * factor;\n}\nfunction lengthToRadians(distance, units = \"kilometers\") {\n  const factor = factors[units];\n  if (!factor) {\n    throw new Error(units + \" units is invalid\");\n  }\n  return distance / factor;\n}\nfunction lengthToDegrees(distance, units) {\n  return radiansToDegrees(lengthToRadians(distance, units));\n}\nfunction bearingToAzimuth(bearing) {\n  let angle = bearing % 360;\n  if (angle < 0) {\n    angle += 360;\n  }\n  return angle;\n}\nfunction azimuthToBearing(angle) {\n  angle = angle % 360;\n  if (angle > 180) {\n    return angle - 360;\n  } else if (angle < -180) {\n    return angle + 360;\n  }\n  return angle;\n}\nfunction radiansToDegrees(radians) {\n  const normalisedRadians = radians % (2 * Math.PI);\n  return normalisedRadians * 180 / Math.PI;\n}\nfunction degreesToRadians(degrees) {\n  const normalisedDegrees = degrees % 360;\n  return normalisedDegrees * Math.PI / 180;\n}\nfunction convertLength(length, originalUnit = \"kilometers\", finalUnit = \"kilometers\") {\n  if (!(length >= 0)) {\n    throw new Error(\"length must be a positive number\");\n  }\n  return radiansToLength(lengthToRadians(length, originalUnit), finalUnit);\n}\nfunction convertArea(area, originalUnit = \"meters\", finalUnit = \"kilometers\") {\n  if (!(area >= 0)) {\n    throw new Error(\"area must be a positive number\");\n  }\n  const startFactor = areaFactors[originalUnit];\n  if (!startFactor) {\n    throw new Error(\"invalid original units\");\n  }\n  const finalFactor = areaFactors[finalUnit];\n  if (!finalFactor) {\n    throw new Error(\"invalid final units\");\n  }\n  return area / startFactor * finalFactor;\n}\nfunction isNumber(num) {\n  return !isNaN(num) && num !== null && !Array.isArray(num);\n}\nfunction isObject(input) {\n  return input !== null && typeof input === \"object\" && !Array.isArray(input);\n}\nfunction validateBBox(bbox) {\n  if (!bbox) {\n    throw new Error(\"bbox is required\");\n  }\n  if (!Array.isArray(bbox)) {\n    throw new Error(\"bbox must be an Array\");\n  }\n  if (bbox.length !== 4 && bbox.length !== 6) {\n    throw new Error(\"bbox must be an Array of 4 or 6 numbers\");\n  }\n  bbox.forEach((num) => {\n    if (!isNumber(num)) {\n      throw new Error(\"bbox must only contain numbers\");\n    }\n  });\n}\nfunction validateId(id) {\n  if (!id) {\n    throw new Error(\"id is required\");\n  }\n  if ([\"string\", \"number\"].indexOf(typeof id) === -1) {\n    throw new Error(\"id must be a number or a string\");\n  }\n}\nexport {\n  areaFactors,\n  azimuthToBearing,\n  bearingToAzimuth,\n  convertArea,\n  convertLength,\n  degreesToRadians,\n  earthRadius,\n  factors,\n  feature,\n  featureCollection,\n  geometry,\n  geometryCollection,\n  isNumber,\n  isObject,\n  lengthToDegrees,\n  lengthToRadians,\n  lineString,\n  lineStrings,\n  multiLineString,\n  multiPoint,\n  multiPolygon,\n  point,\n  points,\n  polygon,\n  polygons,\n  radiansToDegrees,\n  radiansToLength,\n  round,\n  validateBBox,\n  validateId\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { isNumber } from \"@turf/helpers\";\nfunction getCoord(coord) {\n  if (!coord) {\n    throw new Error(\"coord is required\");\n  }\n  if (!Array.isArray(coord)) {\n    if (coord.type === \"Feature\" && coord.geometry !== null && coord.geometry.type === \"Point\") {\n      return [...coord.geometry.coordinates];\n    }\n    if (coord.type === \"Point\") {\n      return [...coord.coordinates];\n    }\n  }\n  if (Array.isArray(coord) && coord.length >= 2 && !Array.isArray(coord[0]) && !Array.isArray(coord[1])) {\n    return [...coord];\n  }\n  throw new Error(\"coord must be GeoJSON Point or an Array of numbers\");\n}\nfunction getCoords(coords) {\n  if (Array.isArray(coords)) {\n    return coords;\n  }\n  if (coords.type === \"Feature\") {\n    if (coords.geometry !== null) {\n      return coords.geometry.coordinates;\n    }\n  } else {\n    if (coords.coordinates) {\n      return coords.coordinates;\n    }\n  }\n  throw new Error(\n    \"coords must be GeoJSON Feature, Geometry Object or an Array\"\n  );\n}\nfunction containsNumber(coordinates) {\n  if (coordinates.length > 1 && isNumber(coordinates[0]) && isNumber(coordinates[1])) {\n    return true;\n  }\n  if (Array.isArray(coordinates[0]) && coordinates[0].length) {\n    return containsNumber(coordinates[0]);\n  }\n  throw new Error(\"coordinates must only contain numbers\");\n}\nfunction geojsonType(value, type, name) {\n  if (!type || !name) {\n    throw new Error(\"type and name required\");\n  }\n  if (!value || value.type !== type) {\n    throw new Error(\n      \"Invalid input to \" + name + \": must be a \" + type + \", given \" + value.type\n    );\n  }\n}\nfunction featureOf(feature, type, name) {\n  if (!feature) {\n    throw new Error(\"No feature passed\");\n  }\n  if (!name) {\n    throw new Error(\".featureOf() requires a name\");\n  }\n  if (!feature || feature.type !== \"Feature\" || !feature.geometry) {\n    throw new Error(\n      \"Invalid input to \" + name + \", Feature with geometry required\"\n    );\n  }\n  if (!feature.geometry || feature.geometry.type !== type) {\n    throw new Error(\n      \"Invalid input to \" + name + \": must be a \" + type + \", given \" + feature.geometry.type\n    );\n  }\n}\nfunction collectionOf(featureCollection, type, name) {\n  if (!featureCollection) {\n    throw new Error(\"No featureCollection passed\");\n  }\n  if (!name) {\n    throw new Error(\".collectionOf() requires a name\");\n  }\n  if (!featureCollection || featureCollection.type !== \"FeatureCollection\") {\n    throw new Error(\n      \"Invalid input to \" + name + \", FeatureCollection required\"\n    );\n  }\n  for (const feature of featureCollection.features) {\n    if (!feature || feature.type !== \"Feature\" || !feature.geometry) {\n      throw new Error(\n        \"Invalid input to \" + name + \", Feature with geometry required\"\n      );\n    }\n    if (!feature.geometry || feature.geometry.type !== type) {\n      throw new Error(\n        \"Invalid input to \" + name + \": must be a \" + type + \", given \" + feature.geometry.type\n      );\n    }\n  }\n}\nfunction getGeom(geojson) {\n  if (geojson.type === \"Feature\") {\n    return geojson.geometry;\n  }\n  return geojson;\n}\nfunction getType(geojson, _name) {\n  if (geojson.type === \"FeatureCollection\") {\n    return \"FeatureCollection\";\n  }\n  if (geojson.type === \"GeometryCollection\") {\n    return \"GeometryCollection\";\n  }\n  if (geojson.type === \"Feature\" && geojson.geometry !== null) {\n    return geojson.geometry.type;\n  }\n  return geojson.type;\n}\nexport {\n  collectionOf,\n  containsNumber,\n  featureOf,\n  geojsonType,\n  getCoord,\n  getCoords,\n  getGeom,\n  getType\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { degreesToRadians, radiansToDegrees } from \"@turf/helpers\";\nimport { getCoord } from \"@turf/invariant\";\nfunction bearing(start, end, options = {}) {\n  if (options.final === true) {\n    return calculateFinalBearing(start, end);\n  }\n  const coordinates1 = getCoord(start);\n  const coordinates2 = getCoord(end);\n  const lon1 = degreesToRadians(coordinates1[0]);\n  const lon2 = degreesToRadians(coordinates2[0]);\n  const lat1 = degreesToRadians(coordinates1[1]);\n  const lat2 = degreesToRadians(coordinates2[1]);\n  const a = Math.sin(lon2 - lon1) * Math.cos(lat2);\n  const b = Math.cos(lat1) * Math.sin(lat2) - Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon2 - lon1);\n  return radiansToDegrees(Math.atan2(a, b));\n}\nfunction calculateFinalBearing(start, end) {\n  let bear = bearing(end, start);\n  bear = (bear + 180) % 360;\n  return bear;\n}\nvar index_default = bearing;\nexport {\n  bearing,\n  index_default as default\n};\n//# sourceMappingURL=index.js.map","import type { Routes } from '@tomtom-org/maps-sdk/core';\nimport calcBearing from '@turf/bearing';\nimport type { DisplayRouteProps } from '../types/displayRoutes';\nimport type {\n    DisplayInstruction,\n    DisplayInstructionArrow,\n    DisplayInstructionArrows,\n    DisplayInstructions,\n} from '../types/guidance';\n\n/**\n * @ignore\n */\nexport const toDisplayInstructions = (routes: Routes<DisplayRouteProps>): DisplayInstructions => ({\n    type: 'FeatureCollection',\n    features: routes.features.flatMap(\n        (route, routeIndex) =>\n            route.properties.guidance?.instructions\n                ?.filter((instruction) => instruction.routePath?.length)\n                .map(\n                    (instruction): DisplayInstruction => ({\n                        type: 'Feature',\n                        geometry: {\n                            type: 'LineString',\n                            coordinates: instruction.routePath.map((pathPoint) => pathPoint.point),\n                        },\n                        properties: { ...instruction, routeIndex, routeState: route.properties.routeState },\n                    }),\n                ) || [],\n    ),\n});\n\n/**\n * @ignore\n */\nexport const toDisplayInstructionArrows = (routes: Routes<DisplayRouteProps>): DisplayInstructionArrows => ({\n    type: 'FeatureCollection',\n    features: routes.features.flatMap(\n        (route, routeIndex) =>\n            route.properties.guidance?.instructions\n                ?.filter((instruction) => instruction.routePath?.length && instruction.routePath.length > 1)\n                .map((instruction): DisplayInstructionArrow => {\n                    const instructionLastSegment = [\n                        instruction.routePath[instruction.routePath.length - 2]?.point,\n                        instruction.routePath[instruction.routePath.length - 1]?.point,\n                    ];\n\n                    return {\n                        type: 'Feature',\n                        geometry: { type: 'Point', coordinates: instructionLastSegment[1] },\n                        properties: {\n                            ...instruction,\n                            routeIndex,\n                            routeState: route.properties.routeState,\n                            lastPointBearingDegrees: calcBearing(instructionLastSegment[0], instructionLastSegment[1]),\n                        },\n                    };\n                }) || [],\n    ),\n});\n","import type { Route, Routes, SectionProps, SectionType } from '@tomtom-org/maps-sdk/core';\nimport { isNil } from 'lodash-es';\nimport type { DisplayRouteProps } from '../types/displayRoutes';\nimport type { DisplaySectionProps, RouteSection, RouteSections } from '../types/routeSections';\n\nconst buildRouteSectionsFromRoute = <\n    S extends SectionProps = SectionProps,\n    D extends DisplaySectionProps = DisplaySectionProps,\n>(\n    route: Route<DisplayRouteProps>,\n    sectionType: SectionType,\n    displaySectionPropsBuilder?: (\n        sectionProps: S,\n        routeProps?: DisplayRouteProps,\n    ) => Omit<D, 'routeState' | 'routeIndex'>,\n): RouteSection<D>[] =>\n    (route.properties.sections[sectionType] as S[])?.map((sectionProps) => ({\n        type: 'Feature',\n        id: sectionProps.id,\n        geometry: {\n            type: 'LineString',\n            coordinates: route.geometry.coordinates.slice(sectionProps.startPointIndex, sectionProps.endPointIndex + 1),\n        },\n        properties: {\n            ...(displaySectionPropsBuilder ? displaySectionPropsBuilder(sectionProps, route.properties) : sectionProps),\n            routeState: route.properties.routeState,\n            ...(!isNil(route.properties.index) && { routeIndex: route.properties.index }),\n        } as D,\n    })) || [];\n\n/**\n * Builds display-ready LineString features to render the sections of a given type, from the given route.\n * @param routes The routes from which to extract the section props.\n * @param sectionType The type of the sections to extract.\n * @param displaySectionPropsBuilder An optional function which will convert each section props into an extended display-ready version.\n * @ignore\n */\nexport const toDisplayRouteSections = <\n    S extends SectionProps = SectionProps,\n    D extends DisplaySectionProps = DisplaySectionProps,\n>(\n    routes: Routes<DisplayRouteProps>,\n    sectionType: SectionType,\n    displaySectionPropsBuilder?: (\n        sectionProps: S,\n        routeProps?: DisplayRouteProps,\n    ) => Omit<D, 'routeState' | 'routeIndex'>,\n): RouteSections<D> => ({\n    type: 'FeatureCollection',\n    features: routes.features.flatMap((route) =>\n        buildRouteSectionsFromRoute<S, D>(route, sectionType, displaySectionPropsBuilder),\n    ),\n});\n","import type { Routes } from '@tomtom-org/maps-sdk/core';\nimport type { FeatureCollection, Geometry } from 'geojson';\nimport type { GeoJSONSourceWithLayers } from '../../shared';\nimport type { DisplayRouteProps, DisplayRouteRelatedProps } from '../types/displayRoutes';\n\n/**\n * Rebuilds route-related display features such as sections or instructions, with the updated route selection based on the given routes.\n * @ignore\n */\nexport const rebuildFeaturesWithRouteSelection = <T extends FeatureCollection<Geometry, DisplayRouteRelatedProps>>(\n    routes: Routes<DisplayRouteProps>,\n    featureCollection: T,\n): T => ({\n    ...featureCollection,\n    features: featureCollection.features.map((features) => ({\n        ...features,\n        properties: {\n            ...features.properties,\n            routeState: routes.features[features.properties.routeIndex || 0].properties.routeState,\n        },\n    })),\n});\n\n/**\n * @ignore\n */\nexport const showFeaturesWithRouteSelection = <T extends FeatureCollection<Geometry, DisplayRouteRelatedProps>>(\n    routesWithSelection: Routes<DisplayRouteProps>,\n    sourceWithLayers: GeoJSONSourceWithLayers<T>,\n): void =>\n    sourceWithLayers.show(rebuildFeaturesWithRouteSelection(routesWithSelection, sourceWithLayers.shownFeatures));\n","import type { DelayMagnitude, DisplayUnits, Route, Routes, TrafficSectionProps } from '@tomtom-org/maps-sdk/core';\nimport { formatDistance, formatDuration } from '@tomtom-org/maps-sdk/core';\nimport type { DisplayRouteProps, DisplayRouteSummaries } from '../types/displayRoutes';\n\n/**\n * Builds map display-ready routes, applying default style props.\n * @ignore\n */\nexport const toDisplayRoutes = (routes: Routes, selectedIndex = 0): Routes<DisplayRouteProps> => ({\n    ...routes,\n    features: routes.features.map((route, index) => ({\n        ...route,\n        properties: {\n            ...route.properties,\n            routeState: index === selectedIndex ? 'selected' : 'deselected',\n        },\n    })),\n});\n\nconst hasMagnitude = (sections: TrafficSectionProps[], magnitude: DelayMagnitude): boolean =>\n    sections.some((section) => section.magnitudeOfDelay === magnitude);\n\nconst summaryDelayMagnitude = (route: Route): DelayMagnitude | undefined => {\n    const trafficSections = route.properties.sections.traffic;\n    if (!trafficSections?.length) {\n        return undefined;\n    }\n    if (hasMagnitude(trafficSections, 'major')) {\n        return 'major';\n    }\n    if (hasMagnitude(trafficSections, 'moderate')) {\n        return 'moderate';\n    }\n    if (hasMagnitude(trafficSections, 'minor')) {\n        return 'minor';\n    }\n    return undefined;\n};\n\n/**\n * Builds map display-ready route summaries based on display routes.\n * @ignore\n */\nexport const toDisplayRouteSummaries = (\n    routes: Routes<DisplayRouteProps>,\n    displayUnits?: DisplayUnits,\n): DisplayRouteSummaries => ({\n    type: 'FeatureCollection',\n    features: routes.features.map((route) => {\n        const summary = route.properties.summary;\n        const routeCoordinates = route.geometry.coordinates;\n        const formattedTraffic = formatDuration(summary.trafficDelayInSeconds, displayUnits?.time);\n        const magnitudeOfDelay = summaryDelayMagnitude(route);\n        return {\n            type: 'Feature',\n            geometry: {\n                type: 'Point',\n                coordinates: routeCoordinates[Math.round(routeCoordinates.length / 2)],\n            },\n            properties: {\n                routeIndex: route.properties.index,\n                routeState: route.properties.routeState,\n                formattedDistance: formatDistance(summary.lengthInMeters, displayUnits?.distance),\n                formattedDuration: formatDuration(summary.travelTimeInSeconds, displayUnits?.time),\n                ...(magnitudeOfDelay && { magnitudeOfDelay }),\n                ...(formattedTraffic && { formattedTraffic }),\n            },\n        };\n    }),\n});\n","import type { Route, Routes, Waypoint, Waypoints } from '@tomtom-org/maps-sdk/core';\nimport { isEqual } from 'lodash-es';\nimport type { StyleImageMetadata } from 'maplibre-gl';\nimport {\n    AbstractMapModule,\n    EventsModule,\n    GeoJSONSourceWithLayers,\n    mapStyleLayerIDs,\n    SVGIconStyleOptions,\n} from '../shared';\nimport { addLayers, addOrUpdateImage, updateLayersAndSource, waitUntilMapIsReady } from '../shared/mapUtils';\nimport type { TomTomMap } from '../TomTomMap';\nimport { INSTRUCTION_ARROW_IMAGE_ID } from './layers/guidanceLayers';\nimport { DESELECTED_SUMMARY_POPUP_IMAGE_ID, SELECTED_SUMMARY_POPUP_IMAGE_ID } from './layers/routeMainLineLayers';\nimport { MAJOR_DELAY_COLOR, MINOR_DELAY_LABEL_COLOR, MODERATE_DELAY_COLOR, UNKNOWN_DELAY_COLOR } from './layers/shared';\nimport {\n    TRAFFIC_CLEAR_IMAGE_ID,\n    TRAFFIC_MAJOR_IMAGE_ID,\n    TRAFFIC_MINOR_IMAGE_ID,\n    TRAFFIC_MODERATE_IMAGE_ID,\n} from './layers/summaryBubbleLayers';\nimport {\n    WAYPOINT_FINISH_IMAGE_ID,\n    WAYPOINT_SOFT_IMAGE_ID,\n    WAYPOINT_START_IMAGE_ID,\n    WAYPOINT_STOP_IMAGE_ID,\n} from './layers/waypointLayers';\nimport {\n    instructionArrowIconImg,\n    softWaypointIcon,\n    summaryBubbleImageOptions,\n    summaryMapBubbleImg,\n    trafficImg,\n    waypointFinishIcon,\n    waypointIcon,\n    waypointStartIcon,\n} from './resources';\nimport type { DisplayRouteProps, DisplayRouteSummary } from './types/displayRoutes';\nimport type { DisplayInstruction } from './types/guidance';\nimport type { PlanningWaypoint } from './types/planningWaypoint';\nimport type { RoutingModuleConfig } from './types/routeModuleConfig';\nimport type { DisplayTrafficSectionProps, RouteSection, RouteSections } from './types/routeSections';\nimport type { RoutingLayersSpecs, RoutingSourcesWithLayers } from './types/routingSourcesAndLayers';\nimport type { ShowRoutesOptions } from './types/showOptions';\nimport type { WaypointDisplayProps } from './types/waypointDisplayProps';\nimport { createLayersSpecs, routeModuleConfigWithDefaults } from './util/config';\nimport { toDisplayChargingStops } from './util/displayChargingStops';\nimport { toDisplayTrafficSectionProps } from './util/displayTrafficSectionProps';\nimport { toDisplayWaypoints } from './util/displayWaypoints';\nimport { toDisplayInstructionArrows, toDisplayInstructions } from './util/guidance';\nimport { toDisplayRouteSections } from './util/routeSections';\nimport { showFeaturesWithRouteSelection } from './util/routeSelection';\nimport { toDisplayRouteSummaries, toDisplayRoutes } from './util/routes';\n\n/**\n * Map module for displaying and managing route visualizations.\n *\n * The RoutingModule provides comprehensive functionality for displaying routes on the map,\n * including route lines, alternative routes, turn-by-turn guidance, and interactive waypoints.\n * It integrates seamlessly with the TomTom Routing API.\n *\n * @remarks\n * **Features:**\n * - Display route lines with customizable styling\n * - Show alternative routes with different styling\n * - Interactive waypoint markers (drag, add, remove)\n * - Turn-by-turn guidance instructions\n * - Route section highlighting\n * - Distance and duration information\n * - Support for multiple routes simultaneously\n *\n * **Common Use Cases:**\n * - Turn-by-turn navigation displays\n * - Route planning and comparison\n * - Multi-stop route optimization\n * - Interactive route editing\n * - Fleet management route visualization\n *\n * @example\n * ```typescript\n * // Create the module\n * const routing = await RoutingModule.getInstance(map, {\n *   displayUnits: {\n *     distance: { type: 'metric' }\n *   }\n * });\n *\n * // Calculate and display a route\n * const result = await calculateRoute({\n *   key: 'your-api-key',\n *   locations: [\n *     [4.9041, 52.3676],  // Amsterdam\n *     [4.4777, 51.9244]   // Rotterdam\n *   ],\n *   routeOptions: {\n *     travelMode: 'car',\n *     routeType: 'fastest'\n *   }\n * });\n *\n * await routing.showRoutes(result);\n * ```\n *\n * @see [Routing Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/routing)\n *\n * @group Routing\n */\nexport class RoutingModule extends AbstractMapModule<RoutingSourcesWithLayers, RoutingModuleConfig> {\n    private layersSpecs!: RoutingLayersSpecs;\n\n    /**\n     * Make sure the map is ready before create an instance of the module and any other interaction with the map\n     * @param tomtomMap The TomTomMap instance.\n     * @param config  The module optional configuration\n     * @returns {Promise} Returns a promise with a new instance of this module\n     *\n     * @remarks\n     * **Configuration Options:**\n     * - `displayUnits`: Distance units (metric/imperial)\n     * - `waypointsSource`: Waypoint entry point options\n     * - `layers`: Complete layer styling configuration\n     *\n     * **Default Styling:**\n     * If no custom layers are provided, uses {@link defaultRoutingLayers}.\n     *\n     * @example\n     * Default initialization:\n     * ```typescript\n     * const routing = await RoutingModule.get(map);\n     * ```\n     *\n     * @example\n     * With custom configuration:\n     * ```typescript\n     * const routing = await RoutingModule.get(map, {\n     *   displayUnits: 'imperial',\n     *   waypointsSource: {\n     *     entryPoints: 'main-when-available'\n     *   }\n     * });\n     * ```\n     */\n    static async get(tomtomMap: TomTomMap, config?: RoutingModuleConfig): Promise<RoutingModule> {\n        await waitUntilMapIsReady(tomtomMap);\n        return new RoutingModule(tomtomMap, config);\n    }\n\n    private constructor(map: TomTomMap, config?: RoutingModuleConfig) {\n        super('geojson', map, config);\n    }\n\n    private createSourcesWithLayers(layersSpecs: RoutingLayersSpecs): RoutingSourcesWithLayers {\n        return {\n            mainLines: new GeoJSONSourceWithLayers(this.mapLibreMap, 'routeMainLines', layersSpecs.mainLines, false),\n            waypoints: new GeoJSONSourceWithLayers(this.mapLibreMap, 'routeWaypoints', layersSpecs.waypoints, false),\n            incidents: new GeoJSONSourceWithLayers(this.mapLibreMap, 'routeIncidents', layersSpecs.incidents, false),\n            ferries: new GeoJSONSourceWithLayers(this.mapLibreMap, 'routeFerries', layersSpecs.ferries, false),\n            chargingStops: new GeoJSONSourceWithLayers(\n                this.mapLibreMap,\n                'routeChargingStops',\n                layersSpecs.chargingStops,\n                false,\n            ),\n            tollRoads: new GeoJSONSourceWithLayers(this.mapLibreMap, 'routeTollRoads', layersSpecs.tollRoads, false),\n            tunnels: new GeoJSONSourceWithLayers(this.mapLibreMap, 'routeTunnels', layersSpecs.tunnels, false),\n            vehicleRestricted: new GeoJSONSourceWithLayers(\n                this.mapLibreMap,\n                'routeVehicleRestricted',\n                layersSpecs.vehicleRestricted,\n                false,\n            ),\n            instructionLines: new GeoJSONSourceWithLayers(\n                this.mapLibreMap,\n                'routeInstructionLines',\n                layersSpecs.instructionLines,\n                false,\n            ),\n            instructionArrows: new GeoJSONSourceWithLayers(\n                this.mapLibreMap,\n                'routeInstructionArrows',\n                layersSpecs.instructionArrows,\n                false,\n            ),\n            summaryBubbles: new GeoJSONSourceWithLayers(\n                this.mapLibreMap,\n                'routeSummaryBubbles',\n                layersSpecs.summaryBubbles,\n                false,\n            ),\n        };\n    }\n\n    /**\n     * @ignore\n     */\n    protected _initSourcesWithLayers(config?: RoutingModuleConfig): RoutingSourcesWithLayers {\n        this.layersSpecs = createLayersSpecs(routeModuleConfigWithDefaults(config).layers);\n        const routingSourcesWithLayers: RoutingSourcesWithLayers = this.createSourcesWithLayers(this.layersSpecs);\n        addLayers(\n            Object.values(routingSourcesWithLayers).flatMap((source) => source._layerSpecs),\n            this.mapLibreMap,\n        );\n\n        const svgIconOptions: SVGIconStyleOptions = {\n            // first comes the main theme fill color, if any:\n            fillColor: config?.theme?.mainColor,\n            // then come any icon style configs for the waypoint icons, if any:\n            ...config?.waypoints?.icon?.style,\n        };\n        const options: Partial<StyleImageMetadata> = { pixelRatio: 2 };\n\n        // loading of extra assets if not present in the map style:\n        this.addImageIfNotExisting(WAYPOINT_START_IMAGE_ID, waypointStartIcon(svgIconOptions), options);\n        this.addImageIfNotExisting(WAYPOINT_STOP_IMAGE_ID, waypointIcon(undefined, svgIconOptions), options);\n        this.addImageIfNotExisting(WAYPOINT_SOFT_IMAGE_ID, softWaypointIcon(), options);\n        this.addImageIfNotExisting(WAYPOINT_FINISH_IMAGE_ID, waypointFinishIcon(svgIconOptions), options);\n        this.addImageIfNotExisting(INSTRUCTION_ARROW_IMAGE_ID, instructionArrowIconImg, options);\n        this.addImageIfNotExisting(\n            SELECTED_SUMMARY_POPUP_IMAGE_ID,\n            summaryMapBubbleImg('white'),\n            summaryBubbleImageOptions,\n        );\n        this.addImageIfNotExisting(\n            DESELECTED_SUMMARY_POPUP_IMAGE_ID,\n            summaryMapBubbleImg('#EEEEEE'),\n            summaryBubbleImageOptions,\n        );\n        this.addImageIfNotExisting(TRAFFIC_CLEAR_IMAGE_ID, trafficImg(UNKNOWN_DELAY_COLOR), options);\n        this.addImageIfNotExisting(TRAFFIC_MAJOR_IMAGE_ID, trafficImg(MAJOR_DELAY_COLOR), options);\n        this.addImageIfNotExisting(TRAFFIC_MODERATE_IMAGE_ID, trafficImg(MODERATE_DELAY_COLOR), options);\n        this.addImageIfNotExisting(TRAFFIC_MINOR_IMAGE_ID, trafficImg(MINOR_DELAY_LABEL_COLOR), options);\n\n        // If we have custom icons, ensure they're added to the map style:\n        for (const customChargingStopIcon of config?.chargingStops?.icon?.customIcons ?? []) {\n            this.addImageIfNotExisting(customChargingStopIcon.id, customChargingStopIcon.image as string, {\n                pixelRatio: customChargingStopIcon.pixelRatio ?? 2,\n            });\n        }\n\n        return routingSourcesWithLayers;\n    }\n\n    /**\n     * @ignore\n     */\n    protected _applyConfig(config?: RoutingModuleConfig) {\n        const mergedConfig = routeModuleConfigWithDefaults(config);\n\n        // If there was already some config set, we must update the changes:\n        if (this.config) {\n            // replace existing configuration with new one\n            const newLayersSpecs = createLayersSpecs(mergedConfig.layers);\n\n            // here we assume that keys for layer specs and sources are the same, please keep it that way to simplify the logic\n            Object.keys(newLayersSpecs).forEach((layersSpecID) => {\n                const id = layersSpecID as keyof RoutingSourcesWithLayers;\n                updateLayersAndSource(\n                    newLayersSpecs[id],\n                    this.layersSpecs[id],\n                    this.sourcesWithLayers[id],\n                    this.mapLibreMap,\n                );\n            });\n            // we need to add layers correctly\n            const listOfSources = Object.values(this.sourcesWithLayers) as GeoJSONSourceWithLayers[];\n            addLayers(\n                listOfSources.flatMap((source) => source._layerSpecs),\n                this.mapLibreMap,\n            );\n            // set the correct visibility if there are new layers\n            listOfSources.forEach((source) => source.setLayersVisible(!!source.shownFeatures.features.length));\n            this.layersSpecs = newLayersSpecs;\n        }\n\n        // Summary bubbles have dedicated sources and contain distance-units dependent text ...\n        // ... so we need to re-show them if that config part changed:\n        if (\n            !isEqual(this.config?.displayUnits, mergedConfig.displayUnits) &&\n            this.sourcesWithLayers.summaryBubbles.shownFeatures.features.length\n        ) {\n            this.sourcesWithLayers.summaryBubbles.show(\n                toDisplayRouteSummaries(this.sourcesWithLayers.mainLines.shownFeatures, mergedConfig.displayUnits),\n            );\n        }\n\n        return mergedConfig;\n    }\n\n    /**\n     * @ignore\n     */\n    protected async restoreDataAndConfigImpl() {\n        const previouslyShown = Object.entries(this.sourcesWithLayers)\n            .map((entry) => ({\n                [entry[0]]: entry[1].shownFeatures,\n            }))\n            .reduce((acc, item) => ({ ...acc, ...item }), {}) as Record<keyof RoutingSourcesWithLayers, any>;\n\n        this.initSourcesWithLayers();\n        this._applyConfig(this.config);\n\n        for (const key of Object.keys(previouslyShown) as (keyof RoutingSourcesWithLayers)[]) {\n            this.sourcesWithLayers[key].show(previouslyShown[key]);\n        }\n    }\n\n    private addImageIfNotExisting(\n        imageId: string,\n        image: string | HTMLImageElement,\n        options: Partial<StyleImageMetadata> | undefined,\n    ) {\n        addOrUpdateImage('if-not-in-sprite', imageId, image, this.mapLibreMap, options);\n    }\n\n    /**\n     * Displays the given routes on the map.\n     *\n     * @param routes - Route data from Routing API or custom routes.\n     * @param options - Optional configuration for route selection and display.\n     * @param options.selectedIndex - Index of the route to display as selected (default: 0).\n     *\n     * @remarks\n     * **Behavior:**\n     * - Replaces any previously shown routes\n     * - Shows all route-related features: lines, sections, summaries, guidance\n     * - First route is selected by default (appears more prominent)\n     * - Waypoints are NOT shown automatically (use {@link showWaypoints})\n     *\n     * **Route Features:**\n     * - Main route lines (selected and deselected styles)\n     * - Traffic sections with delays\n     * - Ferry, tunnel, and toll sections\n     * - EV charging stations (for EV routes)\n     * - Turn-by-turn instruction lines and arrows\n     * - Summary bubbles with distance/time/traffic info\n     *\n     * @example\n     * Show single route:\n     * ```typescript\n     * await routing.showRoutes(response.routes);\n     * ```\n     *\n     * @example\n     * Show multiple routes with specific selection:\n     * ```typescript\n     * await routing.showRoutes(response.routes, { selectedIndex: 1 });\n     * ```\n     *\n     * @example\n     * Complete routing workflow:\n     * ```typescript\n     * import { routing as routingAPI } from '@tomtom-international/maps-sdk-js/services';\n     *\n     * // Calculate route\n     * const response = await routingAPI.calculateRoute({\n     *   locations: [[4.9, 52.4], [4.5, 51.9]],\n     *   traffic: true,\n     *   travelMode: 'car'\n     * });\n     *\n     * // Display on map\n     * const routing = await RoutingModule.get(map);\n     * await routing.showRoutes(response.routes);\n     * await routing.showWaypoints(response.routes[0].legs[0].points);\n     * ```\n     */\n    async showRoutes(routes: Routes, options?: ShowRoutesOptions) {\n        const displayRoutes = toDisplayRoutes(routes, options?.selectedIndex);\n        await this.waitUntilModuleReady();\n        this.sourcesWithLayers.mainLines.show(displayRoutes);\n        this.sourcesWithLayers.vehicleRestricted.show(toDisplayRouteSections(displayRoutes, 'vehicleRestricted'));\n        this.sourcesWithLayers.incidents.show(\n            toDisplayRouteSections(displayRoutes, 'traffic', toDisplayTrafficSectionProps),\n        );\n        this.sourcesWithLayers.chargingStops.show(toDisplayChargingStops(displayRoutes, this.config));\n        this.sourcesWithLayers.ferries.show(toDisplayRouteSections(displayRoutes, 'ferry'));\n        this.sourcesWithLayers.tunnels.show(toDisplayRouteSections(displayRoutes, 'tunnel'));\n        this.sourcesWithLayers.tollRoads.show(toDisplayRouteSections(displayRoutes, 'toll'));\n        this.sourcesWithLayers.instructionLines.show(toDisplayInstructions(displayRoutes));\n        this.sourcesWithLayers.instructionArrows.show(toDisplayInstructionArrows(displayRoutes));\n        this.sourcesWithLayers.summaryBubbles.show(toDisplayRouteSummaries(displayRoutes, this.config?.displayUnits));\n    }\n\n    /**\n     * Clears any previously shown routes from the map.\n     *\n     * @remarks\n     * - Clears all route-related layers (lines, sections, guidance, summaries)\n     * - Does NOT clear waypoints (use {@link clearWaypoints})\n     * - Module remains initialized and ready for new routes\n     *\n     * @example\n     * ```typescript\n     * await routing.clearRoutes();\n     * ```\n     */\n    async clearRoutes() {\n        await this.waitUntilModuleReady();\n        for (const key of Object.keys(this.sourcesWithLayers) as (keyof RoutingSourcesWithLayers)[]) {\n            if (key !== 'waypoints') {\n                this.sourcesWithLayers[key as keyof RoutingSourcesWithLayers].clear();\n            }\n        }\n    }\n\n    /**\n     * Changes which route appears as selected.\n     *\n     * @param index - Zero-based index of the route to select.\n     *\n     * @remarks\n     * **Visual Changes:**\n     * - Selected route appears more prominent (thicker, brighter)\n     * - Previously selected route becomes deselected style\n     * - Updates all route-related features (sections, guidance)\n     *\n     * **Requirements:**\n     * - Route must already be displayed via {@link showRoutes}\n     * - Index must be within range of displayed routes\n     *\n     * @example\n     * ```typescript\n     * // Show multiple routes\n     * await routing.showRoutes(routes);\n     *\n     * // User clicks alternative route\n     * await routing.selectRoute(1);\n     *\n     * // Switch back to first route\n     * await routing.selectRoute(0);\n     * ```\n     */\n    async selectRoute(index: number) {\n        const updatedRoutes = toDisplayRoutes(this.sourcesWithLayers.mainLines.shownFeatures, index);\n\n        await this.waitUntilModuleReady();\n        this.sourcesWithLayers.mainLines.show(updatedRoutes);\n        // TODO: simply update route style instead of regenerating EV stations again\n        this.sourcesWithLayers.chargingStops.show(toDisplayChargingStops(updatedRoutes, this.config));\n        showFeaturesWithRouteSelection(updatedRoutes, this.sourcesWithLayers.vehicleRestricted);\n        showFeaturesWithRouteSelection(updatedRoutes, this.sourcesWithLayers.incidents);\n        showFeaturesWithRouteSelection(updatedRoutes, this.sourcesWithLayers.ferries);\n        showFeaturesWithRouteSelection(updatedRoutes, this.sourcesWithLayers.tollRoads);\n        showFeaturesWithRouteSelection(updatedRoutes, this.sourcesWithLayers.tunnels);\n        showFeaturesWithRouteSelection(updatedRoutes, this.sourcesWithLayers.instructionLines);\n        showFeaturesWithRouteSelection(updatedRoutes, this.sourcesWithLayers.instructionArrows);\n        showFeaturesWithRouteSelection(updatedRoutes, this.sourcesWithLayers.summaryBubbles);\n    }\n\n    /**\n     * Shows the given waypoints on the map.\n     * @param waypoints The waypoint-like inputs to show.\n     */\n    async showWaypoints(waypoints: PlanningWaypoint[] | Waypoints) {\n        const displayWaypoints = Array.isArray(waypoints)\n            ? toDisplayWaypoints(waypoints, this.config?.waypoints)\n            : // FeatureCollection expected:\n              toDisplayWaypoints(waypoints.features as PlanningWaypoint[], this.config?.waypoints);\n        await this.waitUntilModuleReady();\n        this.sourcesWithLayers.waypoints.show(displayWaypoints);\n    }\n\n    /**\n     * Clears any previously shown waypoints from the map.\n     * * If nothing was shown before, nothing happens.\n     */\n    async clearWaypoints() {\n        await this.waitUntilModuleReady();\n        this.sourcesWithLayers.waypoints.clear();\n    }\n\n    /**\n     * Create the events on/off for this module\n     * @returns An instance of EventsModule\n     */\n    get events() {\n        return {\n            mainLines: new EventsModule<Route<DisplayRouteProps>>(\n                this.tomtomMap._eventsProxy,\n                this.sourcesWithLayers.mainLines,\n            ),\n            waypoints: new EventsModule<Waypoint<WaypointDisplayProps>>(\n                this.tomtomMap._eventsProxy,\n                this.sourcesWithLayers.waypoints,\n            ),\n            chargingStops: new EventsModule<RouteSection>(\n                this.tomtomMap._eventsProxy,\n                this.sourcesWithLayers.chargingStops,\n            ),\n            summaryBubbles: new EventsModule<DisplayRouteSummary>(\n                this.tomtomMap._eventsProxy,\n                this.sourcesWithLayers.summaryBubbles,\n            ),\n            incidents: new EventsModule<RouteSections<DisplayTrafficSectionProps>>(\n                this.tomtomMap._eventsProxy,\n                this.sourcesWithLayers.incidents,\n            ),\n            vehicleRestricted: new EventsModule<RouteSection>(\n                this.tomtomMap._eventsProxy,\n                this.sourcesWithLayers.vehicleRestricted,\n            ),\n            ferries: new EventsModule<RouteSection>(this.tomtomMap._eventsProxy, this.sourcesWithLayers.ferries),\n            tollRoads: new EventsModule<RouteSection>(this.tomtomMap._eventsProxy, this.sourcesWithLayers.tollRoads),\n            tunnels: new EventsModule<RouteSection>(this.tomtomMap._eventsProxy, this.sourcesWithLayers.tunnels),\n            instructionLines: new EventsModule<DisplayInstruction>(\n                this.tomtomMap._eventsProxy,\n                this.sourcesWithLayers.instructionLines,\n            ),\n        };\n    }\n\n    /**\n     * Returns the map style layer under which route lines are rendered.\n     * * Useful if you want to render extra layers just above the route ones but not on top of everything else.\n     * * It might differ depending on the loaded style/version.\n     */\n    getLayerToRenderLinesUnder(): string {\n        return mapStyleLayerIDs.lowestLabel;\n    }\n}\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"120\\\" height=\\\"140\\\">\\n    <path d=\\\"M63.734 86.383c-1.404.026-2.78-.393-3.93-1.197s-2.01-1.949-2.46-3.271l-3.15-9.339c-1.093-3.403-3.748-6.089-7.154-7.238L37.5 62.21c-2.742-.902-4.567-3.477-4.5-6.345-.058-2.874 1.761-5.457 4.5-6.388l36-11.886c2.461-.88 5.213-.27 7.062 1.567s2.466 4.571 1.578 7.015L70.17 81.918c-.938 2.719-3.54 4.526-6.436 4.469h0z\\\"\\n          fill=\\\"#f4f5f6\\\"/>\\n</svg>\\n\"","export default \"<svg width=\\\"32\\\" height=\\\"32\\\" viewBox=\\\"0 0 32 32\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n    <circle id=\\\"circle\\\" cx=\\\"16\\\" cy=\\\"16\\\" r=\\\"12\\\" fill=\\\"white\\\" stroke=\\\"#105287\\\" stroke-width=\\\"4\\\"/>\\n</svg>\\n\"","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"120\\\" height=\\\"140\\\">\\n    <path d=\\\"M33 83.404a2.99 2.99 0 0 1-3-2.978V44.681a2.99 2.99 0 1 1 6 0v35.745a2.99 2.99 0 0 1-3 2.978zm48-38.723H39v17.872h42V44.681zm3.878 37.851a3.02 3.02 0 0 0 4.244 0c.561-.559.878-1.317.878-2.106V44.681a2.99 2.99 0 1 0-6 0v35.745c0 .789.317 1.547.878 2.106z\\\"\\n          fill=\\\"#f4f5f6\\\"/>\\n</svg>\\n\"","import type { StyleSpecification } from 'maplibre-gl';\nimport type { StandardStyle, StandardStyleID, StyleInput, StyleModule, TomTomMapParams } from './types/mapInit';\nimport { styleModules } from './types/mapInit';\n\nconst DEFAULT_STANDARD_STYLE_ID: StandardStyleID = 'standardLight';\nconst URL_PREFIX = '${baseURL}/maps/orbis/assets/styles/${version}/style.json?&apiVersion=1&key=${apiKey}';\n\nconst standardStyleModulesValues: Record<StandardStyleID, Record<StyleModule, string>> = {\n    standardLight: {\n        trafficIncidents: 'incidents_light',\n        trafficFlow: 'flow_relative-light',\n        hillshade: 'hillshade_light',\n    },\n    standardDark: {\n        trafficIncidents: 'incidents_dark',\n        trafficFlow: 'flow_relative-dark',\n        hillshade: 'hillshade_dark',\n    },\n    drivingLight: {\n        trafficIncidents: 'incidents_light',\n        trafficFlow: 'flow_relative-light',\n        hillshade: 'hillshade_light',\n    },\n    drivingDark: {\n        trafficIncidents: 'incidents_dark',\n        trafficFlow: 'flow_relative-dark',\n        hillshade: 'hillshade_dark',\n    },\n    monoLight: {\n        trafficIncidents: 'incidents_light',\n        trafficFlow: 'flow_relative-light',\n        hillshade: 'hillshade_mono-light',\n    },\n    monoDark: {\n        trafficIncidents: 'incidents_dark',\n        trafficFlow: 'flow_relative-dark',\n        hillshade: 'hillshade_mono-dark',\n    },\n    satellite: {\n        trafficIncidents: 'incidents_light',\n        trafficFlow: 'flow_relative-light',\n        hillshade: 'hillshade_satellite',\n    },\n};\n\nconst baseMapStyleUrlTemplate = (suffix: string): string => `${URL_PREFIX}&map=${suffix}`;\n\nconst baseMapStyleUrlTemplates: Record<StandardStyleID, string> = {\n    standardLight: baseMapStyleUrlTemplate('basic_street-light'),\n    standardDark: baseMapStyleUrlTemplate('basic_street-dark'),\n    drivingLight: baseMapStyleUrlTemplate('basic_street-light-driving'),\n    drivingDark: baseMapStyleUrlTemplate('basic_street-dark-driving'),\n    monoLight: baseMapStyleUrlTemplate('basic_mono-light'),\n    monoDark: baseMapStyleUrlTemplate('basic_mono-dark'),\n    satellite: baseMapStyleUrlTemplate('basic_street-satellite'),\n};\n\nconst buildStandardStyleUrl = (standardStyle: StandardStyle, baseUrl: string, apiKey: string): string => {\n    const standardStyleID = standardStyle.id ?? DEFAULT_STANDARD_STYLE_ID;\n\n    const styleURL = new URL(\n        baseMapStyleUrlTemplates[standardStyleID]\n            .replace('${baseURL}', baseUrl)\n            .replace('${version}', standardStyle.version ?? '0.6.0-0')\n            .replace('${apiKey}', apiKey),\n    );\n\n    for (const module of standardStyle.include ?? styleModules) {\n        styleURL.searchParams.append(module, standardStyleModulesValues[standardStyleID][module]);\n    }\n\n    return styleURL.toString();\n};\n\nconst withApiKey = (givenUrl: string, apiKey: string): string => {\n    const url = new URL(givenUrl);\n    if (!url.searchParams.has('key')) {\n        url.searchParams.set('key', apiKey);\n    } else {\n        console.warn(\n            'The style URL is coming with an API key parameter which takes priority. ' +\n                'If you want to use the SDK configured API key, remove the key param from the style URL',\n        );\n    }\n    return url.toString();\n};\n\n/**\n * @ignore\n * @param mapParams The SDK parameters to convert to input renderer style.\n * @return The map style to load into the renderer.\n */\nexport const buildStyleInput = (mapParams: TomTomMapParams): StyleSpecification | string => {\n    const style = mapParams.style;\n    const baseUrl = mapParams.commonBaseURL;\n    const apiKey = mapParams.apiKey;\n\n    if (typeof style === 'string') {\n        return buildStandardStyleUrl({ id: style }, baseUrl, apiKey);\n    } else if (style?.type === 'standard') {\n        return buildStandardStyleUrl(style, baseUrl, apiKey);\n    } else if (style?.type === 'custom' && style?.url) {\n        return withApiKey(style.url, apiKey);\n    } else if (style?.type === 'custom' && style?.json) {\n        return style.json;\n    }\n\n    // no style defined, use default\n    return buildStandardStyleUrl({ id: DEFAULT_STANDARD_STYLE_ID }, baseUrl, apiKey);\n};\n\n/**\n * Includes the previous standard style parts into the given standard style if the new one didn't define any.\n * * Both new and previous styles must be of \"standard\" type.\n * @ignore\n */\nexport const withPreviousStyleParts = (style: StyleInput, previousStyle?: StyleInput): StyleInput => {\n    if (\n        previousStyle &&\n        typeof previousStyle === 'object' &&\n        previousStyle.type === 'standard' &&\n        previousStyle.include\n    ) {\n        if (typeof style === 'string' || (style.type === 'standard' && !style.include)) {\n            return {\n                type: 'standard',\n                id: typeof style === 'string' ? style : style.id,\n                include: (previousStyle as StandardStyle).include,\n            };\n        }\n    }\n    return style;\n};\n","import { type Language, mergeFromGlobal } from '@tomtom-org/maps-sdk/core';\nimport type { BBox } from 'geojson';\nimport { isEqual } from 'lodash-es';\nimport { getRTLTextPluginStatus, Map, setRTLTextPlugin } from 'maplibre-gl';\nimport { version as maplibreVersion } from 'maplibre-gl/package.json';\nimport type { MapLibreOptions, StyleInput, TomTomMapParams } from './init';\nimport { buildMapOptions } from './init/buildMapOptions';\nimport { buildStyleInput, withPreviousStyleParts } from './init/styleInputBuilder';\nimport {\n    EventsProxy,\n    filterLayersBySources,\n    HILLSHADE_SOURCE_ID,\n    LightDark,\n    TRAFFIC_FLOW_SOURCE_ID,\n    TRAFFIC_INCIDENTS_SOURCE_ID,\n} from './shared';\nimport { isLayerLocalizable } from './shared/localization';\nimport { addPinCategoriesSpriteToStyle, getStyleLightDarkTheme } from './shared/mapUtils';\n\n/**\n * Handler interface for responding to map style changes.\n *\n * @remarks\n * This interface defines callbacks that are invoked when the map style changes via {@link TomTomMap.setStyle}.\n * Use this to perform cleanup or reinitialization of custom map features when styles are switched.\n *\n * **Lifecycle:**\n * 1. `onStyleAboutToChange` - Called before the new style is applied\n * 2. Style change occurs\n * 3. `onStyleChanged` - Called after the new style has been fully loaded\n *\n * **Common Use Cases:**\n * - Saving and restoring custom layers or sources\n * - Reinitializing map modules after style changes\n * - Updating UI components based on the new style\n * - Cleaning up resources tied to the previous style\n *\n * @example\n * ```typescript\n * const styleHandler: StyleChangeHandler = {\n *   onStyleAboutToChange: () => {\n *     console.log('Style changing - saving state...');\n *     // Save custom layer data\n *   },\n *   onStyleChanged: () => {\n *     console.log('Style changed - restoring state...');\n *     // Restore custom layers\n *   }\n * };\n *\n * map.addStyleChangeHandler(styleHandler);\n * ```\n *\n * @see {@link TomTomMap.addStyleChangeHandler}\n * @see {@link TomTomMap.setStyle}\n *\n * @group Map Style\n */\nexport type StyleChangeHandler = {\n    /**\n     * Callback invoked immediately before a style change begins.\n     *\n     * @remarks\n     * Use this to perform cleanup or save state before the current style is removed.\n     * This method can be synchronous or asynchronous.\n     *\n     * @returns void or a Promise that resolves when preparation is complete\n     */\n    onStyleAboutToChange: () => void | Promise<void>;\n    /**\n     * Callback invoked after a new style has been fully loaded.\n     *\n     * @remarks\n     * Use this to restore state, reinitialize layers, or perform other setup\n     * that depends on the new style being ready. This method can be synchronous or asynchronous.\n     *\n     * @returns void or a Promise that resolves when reinitialization is complete\n     */\n    onStyleChanged: () => void | Promise<void>;\n};\n\n/**\n * Main TomTom Map class for displaying interactive maps in web applications.\n *\n * This is the entry point for rendering TomTom maps. It wraps MapLibre GL JS and provides\n * a simplified, enhanced API for common mapping tasks.\n *\n * @remarks\n * **Key Features:**\n * - Built on MapLibre GL JS for high-performance rendering\n * - Seamless style switching without map reload\n * - Integrated event handling system\n * - Multi-language support with dynamic switching\n * - Compatible with TomTom map modules (traffic, POIs, routing, etc.)\n *\n * **Architecture:**\n * - Exposes the underlying MapLibre Map instance via {@link mapLibreMap}\n * - Manages map lifecycle and style transitions\n * - Coordinates with map modules for data visualization\n *\n * @example\n * Basic map initialization:\n * ```typescript\n * import { TomTomMap } from '@tomtom-international/maps-sdk-js/map';\n *\n * const map = new TomTomMap(\n *   {\n *     container: 'map',\n *     center: [4.9041, 52.3676],\n *     zoom: 10\n *   },\n *   {\n *     key: 'YOUR_API_KEY',\n *     style: 'standardLight'\n *   }\n * );\n * ```\n *\n * @example\n * With modules and configuration:\n * ```typescript\n * const map = new TomTomMap(\n *   { container: 'map', center: [-74.006, 40.7128], zoom: 12 },\n *   {\n *     key: 'YOUR_API_KEY',\n *     style: {\n *       type: 'standard',\n *       id: 'standardDark',\n *       include: ['trafficFlow', 'trafficIncidents']\n *     },\n *     language: 'en-US',\n *     eventsConfig: {\n *       precisionMode: 'point-then-box',\n *       cursorOnHover: 'pointer'\n *     }\n *   }\n * );\n *\n * // Access MapLibre functionality directly\n * map.mapLibreMap.on('load', () => {\n *   console.log('Map loaded');\n * });\n * ```\n *\n * @group Map\n */\nexport class TomTomMap {\n    /**\n     * Indicates whether the map style has been fully loaded and is ready for interaction.\n     *\n     * @remarks\n     * - `true` when the style is loaded and modules can be safely initialized\n     * - `false` during map construction or style changes\n     * - Check this before performing style-dependent operations\n     *\n     * @example\n     * ```typescript\n     * if (map.mapReady) {\n     *   // Safe to initialize modules\n     *   const trafficModule = await TrafficFlowModule.get(map);\n     * }\n     * ```\n     */\n    mapReady = false;\n\n    /**\n     * The underlying MapLibre GL JS Map instance.\n     *\n     * @remarks\n     * **When to Use:**\n     * - Access advanced MapLibre functionality not exposed by TomTomMap\n     * - Add custom layers, sources, or controls\n     * - Listen to MapLibre-specific events\n     * - Integrate third-party MapLibre plugins\n     *\n     * **Important:**\n     * - Available immediately after TomTomMap construction\n     * - Direct modifications may affect SDK module behavior\n     * - Coordinate with SDK modules to avoid conflicts\n     *\n     * @example\n     * Add custom layer:\n     * ```typescript\n     * map.mapLibreMap.addLayer({\n     *   id: 'custom-layer',\n     *   type: 'circle',\n     *   source: 'my-data',\n     *   paint: {\n     *     'circle-radius': 6,\n     *     'circle-color': '#ff0000'\n     *   }\n     * });\n     * ```\n     *\n     * @example\n     * Listen to events:\n     * ```typescript\n     * map.mapLibreMap.on('moveend', () => {\n     *   console.log('Camera position:', map.mapLibreMap.getCenter());\n     * });\n     * ```\n     *\n     * @see {@link https://maplibre.org/maplibre-gl-js-docs/api/map/ | MapLibre Map Documentation}\n     */\n    readonly mapLibreMap: Map;\n    /**\n     * @ignore\n     */\n    readonly _eventsProxy: EventsProxy;\n    /**\n     * @ignore\n     */\n    _params: TomTomMapParams;\n\n    styleLightDarkTheme: LightDark;\n\n    private readonly styleChangeHandlers: StyleChangeHandler[] = [];\n\n    /**\n     * Constructs a new TomTom Map instance and attaches it to a DOM element.\n     *\n     * @param mapLibreOptions - MapLibre map configuration for viewport, controls, and rendering.\n     * Includes properties like `container`, `center`, `zoom`, `bearing`, `pitch`, etc.\n     * See {@link MapLibreOptions} for all available options.\n     *\n     * @param mapParams - TomTom-specific parameters including API key, style, and events.\n     * Can be partially specified here if already set via global configuration.\n     * See {@link TomTomMapParams} for all available parameters.\n     *\n     * @remarks\n     * **Initialization Process:**\n     * 1. Merges `mapParams` with global configuration\n     * 2. Creates underlying MapLibre map instance\n     * 3. Loads specified style asynchronously\n     * 4. Sets `mapReady` to `true` when complete\n     *\n     * **Configuration Priority:**\n     * - Parameters passed here override global configuration\n     * - Allows per-map customization while sharing common settings\n     *\n     * @example\n     * Minimal initialization:\n     * ```typescript\n     * const map = new TomTomMap(\n     *   { container: 'map', center: [0, 0], zoom: 2 },\n     *   { key: 'YOUR_API_KEY' }\n     * );\n     * ```\n     *\n     * @example\n     * Full configuration:\n     * ```typescript\n     * const map = new TomTomMap(\n     *   {\n     *     container: 'map',\n     *     center: [-122.4194, 37.7749],\n     *     zoom: 13,\n     *     pitch: 45,\n     *     bearing: -17.6,\n     *     antialias: true,\n     *     maxZoom: 18,\n     *     minZoom: 8\n     *   },\n     *   {\n     *     key: 'YOUR_API_KEY',\n     *     style: {\n     *       type: 'standard',\n     *       id: 'standardLight',\n     *       include: ['trafficFlow', 'hillshade']\n     *     },\n     *     language: 'en-US',\n     *     eventsConfig: {\n     *       precisionMode: 'point-then-box',\n     *       paddingBoxPx: 10\n     *     }\n     *   }\n     * );\n     * ```\n     *\n     * @throws Will log errors if RTL text plugin fails to load (non-blocking)\n     *\n     * @see {@link MapLibreOptions}\n     * @see {@link TomTomMapParams}\n     * @see {@link https://maplibre.org/maplibre-gl-js-docs/api/map/ | MapLibre Map Parameters}\n     * @see [Map Quickstart Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/quickstart)\n     * @see [Map Styles Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/map-styles)\n     * @see [User Events Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/user-events)\n     */\n    constructor(mapLibreOptions: MapLibreOptions, mapParams?: Partial<TomTomMapParams>) {\n        this._params = mergeFromGlobal(mapParams) as TomTomMapParams;\n        this.styleLightDarkTheme = getStyleLightDarkTheme(this._params.style);\n        this.ensureMapLibreCSSLoaded();\n\n        this.mapLibreMap = new Map(buildMapOptions(mapLibreOptions, this._params));\n        this.mapLibreMap.once('styledata', () => {\n            this.handleStyleData(false);\n        });\n        this._eventsProxy = new EventsProxy(this.mapLibreMap, this._params?.eventsConfig);\n\n        this.loadRTLTextPlugin();\n    }\n\n    private loadRTLTextPlugin(): void {\n        // deferred (just in case), lazy loading of the RTL plugin:\n        setTimeout(() => {\n            if (!['deferred', 'loaded'].includes(getRTLTextPluginStatus())) {\n                setRTLTextPlugin(\n                    'https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.3.0/dist/mapbox-gl-rtl-text.js',\n                    true,\n                ).catch((error) => console.error('Something went wrong when setting RTL plugin', error));\n            }\n        });\n    }\n\n    /**\n     * Dynamically loads the MapLibre CSS stylesheet from CDN.\n     */\n    private ensureMapLibreCSSLoaded(): void {\n        if (typeof document === 'undefined') {\n            return;\n        }\n        // Check if the CSS is already loaded to avoid duplicates:\n        const existingLink = Array.from(document.querySelectorAll('link[rel=\"stylesheet\"], style')).some((element) =>\n            element.textContent?.includes('maplibre'),\n        );\n        if (existingLink) {\n            return;\n        }\n\n        // Create and inject a link tag to load CSS from unpkg CDN\n        const link = document.createElement('link');\n        link.rel = 'stylesheet';\n        link.href = `https://unpkg.com/maplibre-gl@${maplibreVersion}/dist/maplibre-gl.css`;\n        document.head.appendChild(link);\n    }\n\n    /**\n     * Changes the map style dynamically without reloading the entire map.\n     *\n     * @param style - The new style to apply. Can be a string ID or a detailed style configuration.\n     * @param options - Configuration options for the style change behavior.\n     * @param options.keepState - Whether to preserve SDK-rendered items and configurations when changing styles.\n     * When `true` (default), maintains traffic layers, routes, markers, and other SDK features.\n     * When `false`, performs a clean style switch without preserving previous state.\n     *\n     * @remarks\n     * **Behavior:**\n     * - Temporarily sets {@link mapReady} to `false` during the transition\n     * - Triggers all registered {@link StyleChangeHandler} callbacks\n     * - Resets {@link mapReady} to `true` when the new style is fully loaded\n     *\n     * **State Preservation (keepState: true):**\n     * - Merges style parts from the previous style with the new one\n     * - Maintains SDK module layers (traffic, routes, POIs, etc.)\n     * - Preserves language settings\n     *\n     * **Clean Switch (keepState: false):**\n     * - Applies the new style without merging previous configuration\n     * - Removes all SDK module layers\n     * - Useful for complete style resets\n     *\n     * @example\n     * Simple style change:\n     * ```typescript\n     * // Switch to dark mode\n     * map.setStyle('standardDark');\n     * ```\n     *\n     * @example\n     * Style change with detailed configuration:\n     * ```typescript\n     * map.setStyle({\n     *   type: 'standard',\n     *   id: 'standardLight',\n     *   include: ['trafficFlow', 'hillshade']\n     * });\n     * ```\n     *\n     * @example\n     * Clean style switch without state preservation:\n     * ```typescript\n     * // Complete reset - removes all SDK layers and modules\n     * map.setStyle('standardDark', { keepState: false });\n     * ```\n     *\n     * @example\n     * With style change handlers:\n     * ```typescript\n     * map.addStyleChangeHandler({\n     *   onStyleAboutToChange: () => {\n     *     console.log('Preparing for style change...');\n     *   },\n     *   onStyleChanged: () => {\n     *     console.log('New style applied!');\n     *   }\n     * });\n     *\n     * map.setStyle('standardDark');\n     * ```\n     *\n     * @see {@link TomTomMapParams.style} - For setting style during initialization\n     * @see {@link StyleChangeHandler} - For handling style change events\n     * @see {@link getStyle} - For retrieving the current style\n     * @see [Map Styles Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/map-styles)\n     */\n    setStyle = (style: StyleInput, options: { keepState?: boolean } = { keepState: true }): void => {\n        this.mapReady = false;\n        for (const handler of this.styleChangeHandlers) {\n            try {\n                handler.onStyleAboutToChange();\n            } catch (e) {\n                console.error(e);\n            }\n        }\n        const effectiveStyle = options.keepState ? withPreviousStyleParts(style, this._params.style) : style;\n        this._params = { ...this._params, style: effectiveStyle };\n        this.styleLightDarkTheme = getStyleLightDarkTheme(effectiveStyle);\n        this.mapLibreMap.once('styledata', () => {\n            // We only handle the style data change if the applied style is still the same as the one we set,\n            // to prevent race conditions when handling stale styles applied quickly in succession.\n            // (If the current style parameters are different, there's likely a new style being set, which will trigger the handler soon after)\n            if (!this.mapReady && isEqual(effectiveStyle, this._params.style)) {\n                this.handleStyleData(options.keepState || true);\n            }\n        });\n        this.mapLibreMap.setStyle(buildStyleInput(this._params));\n    };\n\n    /**\n     * Retrieves the current style configuration of the map.\n     *\n     * @returns The current {@link StyleInput} configuration, or `undefined` if no style is set.\n     *\n     * @remarks\n     * Returns the style configuration as it was set, not the fully resolved MapLibre style object.\n     * Use this to inspect or store the current style configuration for later restoration.\n     *\n     * **Return Value:**\n     * - String ID (e.g., `'standardLight'`) for simple style configurations\n     * - Style object with `type`, `id`, and optional `include` properties for detailed configurations\n     * - `undefined` if no style has been explicitly set\n     *\n     * @example\n     * ```typescript\n     * const currentStyle = map.getStyle();\n     * console.log('Current style:', currentStyle);\n     *\n     * // Save style for later\n     * const savedStyle = map.getStyle();\n     *\n     * // Later, restore it\n     * if (savedStyle) {\n     *   map.setStyle(savedStyle);\n     * }\n     * ```\n     *\n     * @example\n     * Conditional logic based on current style:\n     * ```typescript\n     * const style = map.getStyle();\n     * if (typeof style === 'string' && style.includes('Dark')) {\n     *   console.log('Dark mode is active');\n     * }\n     * ```\n     *\n     * @see {@link setStyle} - For changing the map style\n     * @see {@link StyleInput} - For available style configuration options\n     */\n    getStyle = (): StyleInput | undefined => {\n        return this._params.style;\n    };\n\n    private _setLanguage(language: Language) {\n        this._params = { ...this._params, language };\n        const mapLanguage = language?.includes('-') ? language.split('-')[0] : language;\n        this.mapLibreMap.getStyle().layers.forEach((layer) => {\n            if (layer.type === 'symbol' && isLayerLocalizable(layer)) {\n                const textFieldValue = mapLanguage\n                    ? ['coalesce', ['get', `name_${mapLanguage}`], ['get', 'name']]\n                    : ['get', 'name'];\n                this.mapLibreMap.setLayoutProperty(layer.id, 'text-field', textFieldValue, { validate: false });\n            }\n        });\n    }\n\n    /**\n     * Changes the language of the map.\n     * * You can use this method to change the language at runtime.\n     * * To set the language upon initialization, you can better do it via {@link core!TomTomConfig global config}\n     * or {@link TomTomMapParams}.\n     * @param language The language to be used in map translations.\n     *\n     * @remarks\n     * **Behavior:**\n     * - Updates all localizable map labels to the specified language\n     * - Falls back to the default label name if the requested language is unavailable\n     * - Can be called before or after the map is fully loaded\n     * - If called before map is ready, will apply once the style loads\n     *\n     * **Language Format:**\n     * - Simple language codes: `'en'`, `'fr'`, `'de'`, `'ja'`, `'zh'`\n     * - Locale-specific codes: `'en-US'`, `'en-GB'`, `'zh-CN'`, `'pt-BR'`\n     * - When using locale codes (with `-`), only the language portion is used for labels\n     *\n     * **Persistence:**\n     * - Language setting persists across style changes (when `keepState: true`)\n     * - Set during initialization via {@link TomTomMapParams.language} for immediate application\n     *\n     * @example\n     * Change language at runtime:\n     * ```typescript\n     * // Switch to French\n     * map.setLanguage('fr');\n     * ```\n     *\n     * @example\n     * Use locale-specific codes:\n     * ```typescript\n     * // Use Simplified Chinese\n     * map.setLanguage('zh-CN');\n     *\n     * // Use Brazilian Portuguese\n     * map.setLanguage('pt-BR');\n     * ```\n     *\n     * @example\n     * Language switcher UI:\n     * ```typescript\n     * const languageSelector = document.getElementById('lang-select');\n     * languageSelector.addEventListener('change', (e) => {\n     *   map.setLanguage(e.target.value);\n     * });\n     * ```\n     *\n     * @see {@link TomTomMapParams.language} - For setting language during initialization\n     * @see {@link https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes | ISO 639-1 Language Codes}\n     */\n    setLanguage(language: Language) {\n        if (this.mapReady) {\n            this._setLanguage(language);\n        } else {\n            this.mapLibreMap.once('styledata', () => this.setLanguage(language));\n        }\n    }\n\n    /**\n     * Retrieves the current visible map area as a GeoJSON bounding box.\n     *\n     * @returns A {@link https://tools.ietf.org/html/rfc7946#section-5 | GeoJSON BBox} array\n     * in the format `[west, south, east, north]` representing the map's current viewport bounds.\n     *\n     * @remarks\n     * **Return Format:**\n     * - Array of four numbers: `[minLongitude, minLatitude, maxLongitude, maxLatitude]`\n     * - Coordinates are in WGS84 decimal degrees\n     * - West/East values range from -180 to 180\n     * - South/North values range from -90 to 90\n     *\n     * **Use Cases:**\n     * - Performing spatial queries within the visible area\n     * - Saving and restoring map view state\n     * - Filtering data to display only what's visible\n     * - Analytics and tracking of viewed regions\n     *\n     * @example\n     * Get current bounds:\n     * ```typescript\n     * const bbox = map.getBBox();\n     * console.log('Bounds:', bbox);\n     * // Output: [-122.5, 37.7, -122.3, 37.8]\n     * // [west, south, east, north]\n     * ```\n     *\n     * @example\n     * Use bounds for spatial query:\n     * ```typescript\n     * const bbox = map.getBBox();\n     * const results = await searchAPI.searchInBoundingBox({\n     *   bbox: bbox,\n     *   query: 'restaurants'\n     * });\n     * ```\n     *\n     * @example\n     * Save and restore map view:\n     * ```typescript\n     * // Save current view\n     * const savedBounds = map.getBBox();\n     * const savedZoom = map.mapLibreMap.getZoom();\n     *\n     * // Later, restore the view\n     * const [west, south, east, north] = savedBounds;\n     * map.mapLibreMap.fitBounds([[west, south], [east, north]]);\n     * ```\n     *\n     * @see {@link https://tools.ietf.org/html/rfc7946#section-5 | GeoJSON BBox Specification}\n     * @see {@link https://maplibre.org/maplibre-gl-js-docs/api/geography/#lnglatbounds | MapLibre LngLatBounds}\n     */\n    getBBox(): BBox {\n        return this.mapLibreMap.getBounds().toArray().flat() as BBox;\n    }\n\n    private handleStyleData(keepState: boolean) {\n        // We ensure to make traffic and hillshade hidden by default (even if right after the modules bring it back to visible state)\n        // This way we ensure such layers are invisible even of their related SDK modules are not used.\n        for (const layer of filterLayersBySources(this.mapLibreMap, [\n            TRAFFIC_INCIDENTS_SOURCE_ID,\n            TRAFFIC_FLOW_SOURCE_ID,\n            HILLSHADE_SOURCE_ID,\n        ])) {\n            this.mapLibreMap.setLayoutProperty(layer.id, 'visibility', 'none', { validate: false });\n        }\n\n        // For most use cases we'll need to have pins available (places, routing...) so we add them by default:\n        // (subsequent loads for the same sprite should be cached)\n        addPinCategoriesSpriteToStyle(this._params, this.mapLibreMap);\n        // We restore the language if it was set before:\n        this._params.language && this._setLanguage(this._params.language);\n\n        this.mapReady = true;\n        if (keepState) {\n            for (const handler of this.styleChangeHandlers) {\n                try {\n                    handler.onStyleChanged();\n                } catch (e) {\n                    console.error(e);\n                }\n            }\n        }\n    }\n\n    /**\n     * Registers a handler to be notified when the map style changes.\n     *\n     * @param handler - A {@link StyleChangeHandler} object with callbacks for style change events.\n     *\n     * @remarks\n     * **When to Use:**\n     * - You have custom layers or sources that need to be recreated after style changes\n     * - Your application needs to respond to style switches (e.g., light/dark mode transitions)\n     * - You need to save and restore state during style changes\n     * - Map modules need to reinitialize when styles change\n     *\n     * **Handler Lifecycle:**\n     * 1. `onStyleAboutToChange()` - Called before the style change begins\n     * 2. Style change occurs\n     * 3. `onStyleChanged()` - Called after the new style has been fully loaded\n     *\n     * **Multiple Handlers:**\n     * - Multiple handlers can be registered and will all be called in registration order\n     * - Each handler's errors are caught independently and logged to the console\n     * - One failing handler won't prevent others from executing\n     *\n     * **Important Notes:**\n     * - Handlers are only triggered by {@link setStyle} calls, not initial map construction\n     * - Only called when `keepState: true` in {@link setStyle} options\n     * - Handlers persist for the lifetime of the TomTomMap instance\n     *\n     * @example\n     * Basic usage:\n     * ```typescript\n     * map.addStyleChangeHandler({\n     *   onStyleAboutToChange: () => {\n     *     console.log('Style is changing...');\n     *   },\n     *   onStyleChanged: () => {\n     *     console.log('Style changed successfully!');\n     *   }\n     * });\n     *\n     * // Later trigger the handlers\n     * map.setStyle('standardDark');\n     * ```\n     *\n     * @example\n     * Preserve custom layers across style changes:\n     * ```typescript\n     * let customLayerData = null;\n     *\n     * map.addStyleChangeHandler({\n     *   onStyleAboutToChange: () => {\n     *     // Save custom layer data before style changes\n     *     if (map.mapLibreMap.getLayer('my-custom-layer')) {\n     *       customLayerData = map.mapLibreMap.getSource('my-data')._data;\n     *       map.mapLibreMap.removeLayer('my-custom-layer');\n     *       map.mapLibreMap.removeSource('my-data');\n     *     }\n     *   },\n     *   onStyleChanged: () => {\n     *     // Restore custom layer after new style is loaded\n     *     if (customLayerData) {\n     *       map.mapLibreMap.addSource('my-data', {\n     *         type: 'geojson',\n     *         data: customLayerData\n     *       });\n     *       map.mapLibreMap.addLayer({\n     *         id: 'my-custom-layer',\n     *         type: 'circle',\n     *         source: 'my-data',\n     *         paint: { 'circle-radius': 6, 'circle-color': '#007cbf' }\n     *       });\n     *     }\n     *   }\n     * });\n     * ```\n     *\n     * @example\n     * Async handler for external API calls:\n     * ```typescript\n     * map.addStyleChangeHandler({\n     *   onStyleAboutToChange: async () => {\n     *     await saveStateToAPI(map.getStyle());\n     *   },\n     *   onStyleChanged: async () => {\n     *     await loadStateFromAPI();\n     *   }\n     * });\n     * ```\n     *\n     * @example\n     * Update UI based on style:\n     * ```typescript\n     * map.addStyleChangeHandler({\n     *   onStyleAboutToChange: () => {\n     *     document.body.classList.add('style-changing');\n     *   },\n     *   onStyleChanged: () => {\n     *     document.body.classList.remove('style-changing');\n     *     const style = map.getStyle();\n     *     if (typeof style === 'string' && style.includes('Dark')) {\n     *       document.body.classList.add('dark-mode');\n     *     } else {\n     *       document.body.classList.remove('dark-mode');\n     *     }\n     *   }\n     * });\n     * ```\n     *\n     * @see {@link StyleChangeHandler} - Handler interface definition\n     * @see {@link setStyle} - Method that triggers the handlers\n     */\n    addStyleChangeHandler(handler: StyleChangeHandler): void {\n        this.styleChangeHandlers.push(handler);\n    }\n}\n","import type { MapOptions } from 'maplibre-gl';\nimport { injectTomTomHeaders } from '../shared/mapUtils';\nimport { buildStyleInput } from './styleInputBuilder';\nimport type { MapLibreOptions, TomTomMapParams } from './types/mapInit';\n\n/**\n * @ignore\n * @param mapLibreOptions\n * @param tomtomMapParams\n */\nexport const buildMapOptions = (mapLibreOptions: MapLibreOptions, tomtomMapParams: TomTomMapParams): MapOptions => {\n    return {\n        // defaults (can be overwritten by given options)\n        validateStyle: false,\n        maxTileCacheZoomLevels: 22,\n        cancelPendingTileRequestsWhileZooming: false,\n        // given options:\n        ...mapLibreOptions,\n        // SDK overrides (won't have any effect via given options):\n        style: buildStyleInput(tomtomMapParams),\n        attributionControl: { compact: false },\n        transformRequest: injectTomTomHeaders(tomtomMapParams),\n    };\n};\n","import type { ExpressionSpecification, SymbolLayerSpecification } from 'maplibre-gl';\n\n/**\n * @ignore\n */\nexport const isLayerLocalizable = (layer: SymbolLayerSpecification): boolean => {\n    const textField = (layer.layout?.['text-field'] ?? '') as string | ExpressionSpecification;\n    return textField\n        ? // tries to detect layers which have a \"text-field\" that can be localized\n          // ex. \"text-field\": \"{name}\" or \"text-field\": [\"get\", \"name\"]\n          textField === '{name}' ||\n              (textField.length === 2 && textField[1] === 'name') ||\n              // tries to detect layers which have \"text-field\" that was localized already\n              // ex. \"text-field\": [\"coalesce\", [\"get\", \"name_en\"], [\"get\", \"name\"]]\n              (textField.length === 3 &&\n                  Array.isArray(textField[1]) &&\n                  typeof textField[1][1] === 'string' &&\n                  textField[1][1].includes('name_') &&\n                  Array.isArray(textField[2]) &&\n                  textField[2].includes('name'))\n        : false;\n};\n","import type { DelayMagnitude } from '@tomtom-org/maps-sdk/core';\nimport type { FilterShowMode, ValuesFilter } from '../../shared';\n\n/**\n * Available traffic incident category identifiers.\n *\n * @remarks\n * These categories classify different types of traffic incidents that can be displayed on the map.\n *\n * @group Traffic Incidents\n */\nexport const incidentCategories = [\n    'unknown',\n    'accident',\n    'fog',\n    'dangerous_conditions',\n    'rain',\n    'ice',\n    'jam',\n    'lane_closed',\n    'road_closed',\n    'road_works',\n    'wind',\n    'flooding',\n    'broken_down_vehicle',\n] as const;\n\n/**\n * Traffic incident category type.\n *\n * @remarks\n * Represents the type of traffic incident affecting road conditions.\n * Used for filtering and categorizing incidents displayed on the map.\n *\n * Available categories:\n * - `unknown` - Unclassified incident\n * - `accident` - Vehicle collision or crash\n * - `fog` - Low visibility due to fog\n * - `dangerous_conditions` - Hazardous road conditions\n * - `rain` - Heavy rain affecting traffic\n * - `ice` - Icy road conditions\n * - `jam` - Traffic congestion or standstill\n * - `lane_closed` - One or more lanes unavailable\n * - `road_closed` - Complete road closure\n * - `road_works` - Construction or maintenance\n * - `wind` - Strong winds affecting traffic\n * - `flooding` - Water on roadway\n * - `broken_down_vehicle` - Disabled vehicle blocking traffic\n *\n * @group Traffic Incidents\n */\nexport type IncidentCategory = (typeof incidentCategories)[number];\n\n/**\n * @ignore\n */\nexport const incidentCategoriesMapping: Record<IncidentCategory, number> = {\n    unknown: 0,\n    accident: 1,\n    fog: 2,\n    dangerous_conditions: 3,\n    rain: 4,\n    ice: 5,\n    jam: 6,\n    lane_closed: 7,\n    road_closed: 8,\n    road_works: 9,\n    wind: 10,\n    flooding: 11,\n    broken_down_vehicle: 14,\n} as const;\n\n/**\n * Available road hierarchy category identifiers.\n *\n * @remarks\n * These categories represent different levels in the road network hierarchy,\n * from major highways to local streets.\n *\n * @group Traffic\n */\nexport const roadCategories = ['motorway', 'trunk', 'primary', 'secondary', 'tertiary', 'street'] as const;\n\n/**\n * Road hierarchy category type.\n *\n * @remarks\n * Classifies roads by their importance and capacity in the transportation network.\n * Used for filtering traffic data display based on road significance.\n *\n * Road hierarchy (from highest to lowest):\n * - `motorway` - High-capacity highways with restricted access\n * - `trunk` - Major inter-city roads\n * - `primary` - Primary through routes\n * - `secondary` - Secondary through routes\n * - `tertiary` - Connecting roads (see {@link TertiaryRoadCategory})\n * - `street` - Local streets (see {@link StreetRoadCategory})\n *\n * @group Traffic\n */\nexport type RoadCategory = (typeof roadCategories)[number];\n\n/**\n * Available tertiary road sub-category identifiers.\n *\n * @remarks\n * Provides finer granularity for classifying tertiary roads.\n *\n * @group Traffic\n */\nexport const tertiaryRoadCategories = ['connecting', 'major_local'] as const;\n\n/**\n * Tertiary road sub-category type.\n *\n * @remarks\n * Further classifies tertiary roads into specific sub-types for more granular filtering.\n *\n * Sub-categories:\n * - `connecting` - Roads connecting different areas\n * - `major_local` - Major roads within local areas\n *\n * @group Traffic\n */\nexport type TertiaryRoadCategory = (typeof tertiaryRoadCategories)[number];\n\n/**\n * Available street road sub-category identifiers.\n *\n * @remarks\n * Provides finer granularity for classifying local streets.\n *\n * @group Traffic\n */\nexport const streetRoadCategories = ['local', 'minor_local'] as const;\n\n/**\n * Street road sub-category type.\n *\n * @remarks\n * Further classifies local streets into specific sub-types for more granular filtering.\n *\n * Sub-categories:\n * - `local` - Standard local streets\n * - `minor_local` - Minor residential streets\n *\n * @group Traffic\n */\nexport type StreetRoadCategory = (typeof streetRoadCategories)[number];\n\n/**\n * Configuration for filtering traffic incidents by delay duration.\n *\n * @remarks\n * Allows filtering incidents based on whether they cause delays and the severity of those delays.\n * Useful for focusing on incidents with the most significant traffic impact.\n *\n * @group Traffic\n */\nexport type DelayFilter = {\n    /**\n     * Requires incidents to have an associated delay.\n     *\n     * @remarks\n     * When `true`, incidents without delay information will be hidden from the map.\n     * When `false` or omitted, incidents are shown regardless of delay data availability.\n     *\n     * @defaultValue `false`\n     */\n    mustHaveDelay?: boolean;\n\n    /**\n     * Minimum delay threshold in minutes.\n     *\n     * @remarks\n     * Only incidents causing delays of at least this duration will be shown.\n     *\n     * **Behavior:**\n     * - If `mustHaveDelay` is `false` or not set, this filter only applies to incidents that have delay data\n     * - Incidents without delay data are still shown (unless `mustHaveDelay` is `true`)\n     *\n     * @example\n     * ```ts\n     * // Show only incidents with delays of 5 minutes or more\n     * delays: { minDelayMinutes: 5 }\n     * ```\n     */\n    minDelayMinutes?: number;\n};\n\n/**\n * Common filter configuration shared between traffic incidents and flow visualization.\n *\n * @remarks\n * Provides road category filtering capabilities used by both incident and flow modules.\n *\n * @group Traffic\n */\nexport type TrafficCommonFilter = {\n    /**\n     * Filters traffic data by road hierarchy categories.\n     *\n     * @remarks\n     * Controls which road types display traffic information.\n     * Use the `mode` field to specify whether to show or hide the selected categories.\n     *\n     * @example\n     * ```ts\n     * // Show only motorways and trunk roads\n     * roadCategories: { mode: 'show', values: ['motorway', 'trunk'] }\n     * ```\n     */\n    roadCategories?: ValuesFilter<RoadCategory>;\n\n    /**\n     * Filters traffic data by road sub-categories.\n     *\n     * @remarks\n     * Provides finer-grained control for tertiary roads and streets.\n     * Applies to sub-categories of {@link TertiaryRoadCategory} and {@link StreetRoadCategory}.\n     *\n     * @example\n     * ```ts\n     * // Hide minor local streets\n     * roadSubCategories: { mode: 'hide', values: ['minor_local'] }\n     * ```\n     */\n    roadSubCategories?: ValuesFilter<TertiaryRoadCategory | StreetRoadCategory>;\n};\n\n/**\n * Filter configuration for traffic incidents visualization.\n *\n * @remarks\n * Extends common traffic filters with incident-specific filtering options\n * including category, severity, and delay-based filtering.\n *\n * @group Traffic Incidents\n */\nexport type TrafficIncidentsFilter = TrafficCommonFilter & {\n    /**\n     * Filters incidents by category type.\n     *\n     * @remarks\n     * Controls which types of incidents are displayed on the map.\n     *\n     * @example\n     * ```ts\n     * // Show only accidents and road closures\n     * incidentCategories: { mode: 'show', values: ['accident', 'road_closed'] }\n     * ```\n     */\n    incidentCategories?: ValuesFilter<IncidentCategory>;\n\n    /**\n     * Filters incidents by delay severity magnitude.\n     *\n     * @remarks\n     * Controls display based on the severity of traffic delays caused by incidents.\n     *\n     * Magnitude levels:\n     * - `0` - Unknown\n     * - `1` - Minor\n     * - `2` - Moderate\n     * - `3` - Major\n     * - `4` - Undefined\n     *\n     * @example\n     * ```ts\n     * // Show only major incidents\n     * magnitudes: { mode: 'show', values: [3] }\n     * ```\n     */\n    magnitudes?: ValuesFilter<DelayMagnitude>;\n\n    /**\n     * Filters incidents by delay duration.\n     *\n     * @remarks\n     * Allows filtering based on whether incidents have delays and minimum delay thresholds.\n     */\n    delays?: DelayFilter;\n};\n\n/**\n * Collection of traffic incident filters with OR logic.\n *\n * @remarks\n * Combines multiple incident filter configurations where an incident is shown\n * if it matches **any** of the provided filter criteria (logical OR).\n *\n * This allows for complex filtering scenarios where incidents from different\n * categories or with different characteristics can all be displayed.\n *\n * @example\n * ```ts\n * // Show major incidents OR road closures\n * filters: {\n *   any: [\n *     { magnitudes: { mode: 'show', values: [3] } },\n *     { incidentCategories: { mode: 'show', values: ['road_closed'] } }\n *   ]\n * }\n * ```\n *\n * @group Traffic Incidents\n */\nexport type TrafficIncidentsFilters = {\n    /**\n     * Array of incident filters combined with OR logic.\n     *\n     * @remarks\n     * An incident is displayed if it satisfies at least one of the filter configurations.\n     */\n    any: TrafficIncidentsFilter[];\n};\n\n/**\n * Filter configuration for traffic flow visualization.\n *\n * @remarks\n * Extends common traffic filters with flow-specific options,\n * particularly for highlighting road closures in the flow layer.\n *\n * @group Traffic Flow\n */\nexport type TrafficFlowFilter = TrafficCommonFilter & {\n    /**\n     * Controls road closure display in the traffic flow layer.\n     *\n     * @remarks\n     * Determines whether to exclusively show road closures or exclude them from display.\n     *\n     * - `'show'` - Display only road closures\n     * - `'hide'` - Display everything except road closures\n     *\n     * @example\n     * ```ts\n     * // Highlight only road closures\n     * showRoadClosures: 'show'\n     * ```\n     */\n    showRoadClosures?: FilterShowMode;\n};\n\n/**\n * Collection of traffic flow filters with OR logic.\n *\n * @remarks\n * Combines multiple flow filter configurations where traffic flow data is shown\n * if it matches **any** of the provided filter criteria (logical OR).\n *\n * @example\n * ```ts\n * // Show flow on motorways OR show road closures on any road\n * filters: {\n *   any: [\n *     { roadCategories: { mode: 'show', values: ['motorway'] } },\n *     { showRoadClosures: 'show' }\n *   ]\n * }\n * ```\n *\n * @group Traffic Flow\n */\nexport type TrafficFlowFilters = {\n    /**\n     * Array of flow filters combined with OR logic.\n     *\n     * @remarks\n     * Traffic flow data is displayed if it satisfies at least one of the filter configurations.\n     */\n    any: TrafficFlowFilter[];\n};\n\n/**\n * Common configuration for traffic incident visualization components.\n *\n * @remarks\n * Provides shared styling and filtering options used by both incident lines and icons.\n * Extends base style module configuration with traffic incident-specific filters.\n *\n * @group Traffic Incidents\n */\nexport type IncidentsCommonConfig = {\n    /**\n     * Controls the visibility of the traffic incident layers.\n     *\n     * @default false\n     */\n    visible?: boolean;\n\n    /**\n     * Filter configuration for traffic incidents.\n     *\n     * @remarks\n     * Controls which incidents are displayed based on category, severity, delay, and road type.\n     */\n    filters?: TrafficIncidentsFilters;\n};\n\n/**\n * Configuration for traffic incidents module.\n *\n * @remarks\n * Provides complete configuration for displaying traffic incidents on the map,\n * including separate styling for incident lines and icons.\n *\n * @group Traffic Incidents\n */\nexport type IncidentsConfig = IncidentsCommonConfig & {\n    /**\n     * Configuration specific to incident icon display.\n     *\n     * @remarks\n     * Allows separate styling and filtering for incident marker icons,\n     * independent of the incident line styling.\n     */\n    icons?: IncidentsCommonConfig;\n};\n\n/**\n * Configuration for traffic flow visualization module.\n *\n * @remarks\n * Controls the display of real-time traffic flow data on road segments,\n * including styling and filtering options.\n *\n * @group Traffic Flow\n */\nexport type FlowConfig = {\n    /**\n     * Controls the visibility of the traffic flow layers.\n     *\n     * @default false\n     */\n    visible?: boolean;\n\n    /**\n     * Filter configuration for traffic flow data.\n     *\n     * @remarks\n     * Controls which road segments display traffic flow information\n     * based on road category and closure status.\n     */\n    filters?: TrafficFlowFilters;\n};\n","import { indexedMagnitudes } from '@tomtom-org/maps-sdk/core';\nimport { isNil } from 'lodash-es';\nimport type {\n    ExpressionFilterSpecification,\n    FilterSpecification,\n    LayerSpecification,\n    LegacyFilterSpecification,\n    Map,\n} from 'maplibre-gl';\nimport type { MultiSyntaxFilter, ValuesFilter } from '../../shared';\nimport { buildValuesFilter, getMergedAllFilter, getMergedAnyFilter } from '../../shared/mapLibreFilterUtils';\nimport type {\n    DelayFilter,\n    TrafficCommonFilter,\n    TrafficFlowFilter,\n    TrafficFlowFilters,\n    TrafficIncidentsFilter,\n    TrafficIncidentsFilters,\n} from '../types/trafficModuleConfig';\nimport { incidentCategoriesMapping } from '../types/trafficModuleConfig';\n\nconst toMultiSyntaxAllFilter = (\n    newSyntaxExpressions: unknown[],\n    legacySyntaxExpressions: unknown[],\n): MultiSyntaxFilter | null => {\n    if (!newSyntaxExpressions.length) {\n        return null;\n    }\n    if (newSyntaxExpressions.length === 1) {\n        return {\n            expression: newSyntaxExpressions[0] as ExpressionFilterSpecification,\n            legacy: legacySyntaxExpressions[0] as LegacyFilterSpecification,\n        };\n    }\n    return {\n        expression: ['all', ...newSyntaxExpressions] as ExpressionFilterSpecification,\n        legacy: ['all', ...legacySyntaxExpressions] as LegacyFilterSpecification,\n    };\n};\n\nconst delayFilterToMapLibre = (delayFilter: DelayFilter): MultiSyntaxFilter | null => {\n    const newSyntaxExpressions = [];\n    const legacySyntaxExpressions = [];\n    if (delayFilter.mustHaveDelay && delayFilter.minDelayMinutes) {\n        // there must be a delay and with the min specified value:\n        const delaySeconds = delayFilter.minDelayMinutes * 60;\n        newSyntaxExpressions.push(['>=', ['get', 'delay'], delaySeconds]);\n        legacySyntaxExpressions.push(['>=', 'delay', delaySeconds]);\n    } else if (delayFilter.mustHaveDelay) {\n        // just expects a delay of any kind\n        newSyntaxExpressions.push(['>', ['get', 'delay'], 0]);\n        legacySyntaxExpressions.push(['>', 'delay', 0]);\n    } else if (delayFilter.minDelayMinutes) {\n        // Min delay expected, but also allows for non-existing delays:\n        const delaySeconds = delayFilter.minDelayMinutes * 60;\n        newSyntaxExpressions.push([\n            'any',\n            ['!', ['has', 'delay']],\n            ['==', ['get', 'delay'], 0],\n            ['>=', ['get', 'delay'], delaySeconds],\n        ]);\n        legacySyntaxExpressions.push(['any', ['!has', 'delay'], ['==', 'delay', 0], ['>=', 'delay', delaySeconds]]);\n    }\n    return toMultiSyntaxAllFilter(newSyntaxExpressions, legacySyntaxExpressions);\n};\n\nconst addFilter = (\n    filter: MultiSyntaxFilter | undefined | null,\n    newSyntaxExpressions: unknown[],\n    legacySyntaxExpressions: unknown[],\n) => {\n    if (filter) {\n        newSyntaxExpressions.push(filter.expression);\n        legacySyntaxExpressions.push(filter.legacy);\n    }\n};\n\nconst addValuesFilter = (\n    valuesFilter: ValuesFilter<string> | undefined,\n    propName: string,\n    newSyntaxExpressions: unknown[],\n    legacySyntaxExpressions: unknown[],\n) => {\n    if (valuesFilter) {\n        addFilter(buildValuesFilter(propName, valuesFilter), newSyntaxExpressions, legacySyntaxExpressions);\n    }\n};\n\nconst addCommonFilterExpressions = (\n    sdkFilter: TrafficCommonFilter,\n    newSyntaxExpressions: unknown[],\n    legacySyntaxExpressions: unknown[],\n): void => {\n    addValuesFilter(sdkFilter.roadCategories, 'road_category', newSyntaxExpressions, legacySyntaxExpressions);\n    addValuesFilter(sdkFilter.roadSubCategories, 'road_subcategory', newSyntaxExpressions, legacySyntaxExpressions);\n};\n\nconst buildMapLibreIncidentsFilter = (sdkFilter: TrafficIncidentsFilter): MultiSyntaxFilter | null => {\n    const newSyntaxExpressions: unknown[] = [];\n    const legacySyntaxExpressions: unknown[] = [];\n\n    addCommonFilterExpressions(sdkFilter, newSyntaxExpressions, legacySyntaxExpressions);\n\n    if (sdkFilter.incidentCategories) {\n        const incidentCategoryFilter = buildValuesFilter(\n            'icon_category_0',\n            sdkFilter.incidentCategories,\n            (value) => incidentCategoriesMapping[value],\n        );\n        addFilter(incidentCategoryFilter, newSyntaxExpressions, legacySyntaxExpressions);\n    }\n    if (sdkFilter.magnitudes) {\n        const magnitudesFilter = buildValuesFilter('magnitude', sdkFilter.magnitudes, (magnitude) =>\n            indexedMagnitudes.indexOf(magnitude),\n        );\n        addFilter(magnitudesFilter, newSyntaxExpressions, legacySyntaxExpressions);\n    }\n    if (sdkFilter.delays) {\n        addFilter(delayFilterToMapLibre(sdkFilter.delays), newSyntaxExpressions, legacySyntaxExpressions);\n    }\n\n    return toMultiSyntaxAllFilter(newSyntaxExpressions, legacySyntaxExpressions);\n};\n\n/**\n * @ignore\n */\nexport const buildMapLibreIncidentFilters = (incidentFilters: TrafficIncidentsFilters): MultiSyntaxFilter | null => {\n    if (!incidentFilters?.any?.length) {\n        return null;\n    }\n    const mapLibreFilters = incidentFilters.any\n        .map(buildMapLibreIncidentsFilter)\n        .filter((mapLibreFilter) => !isNil(mapLibreFilter));\n    return getMergedAnyFilter(mapLibreFilters);\n};\n\nconst buildMapLibreFlowFilter = (sdkFilter: TrafficFlowFilter): MultiSyntaxFilter | null => {\n    const newSyntaxExpressions: unknown[] = [];\n    const legacySyntaxExpressions: unknown[] = [];\n\n    addCommonFilterExpressions(sdkFilter, newSyntaxExpressions, legacySyntaxExpressions);\n    if (sdkFilter.showRoadClosures) {\n        const operator = sdkFilter.showRoadClosures === 'only' ? '==' : '!=';\n        newSyntaxExpressions.push([operator, ['get', 'road_closure'], true]);\n        legacySyntaxExpressions.push([operator, 'road_closure', true]);\n    }\n\n    return toMultiSyntaxAllFilter(newSyntaxExpressions, legacySyntaxExpressions);\n};\n\n/**\n * @ignore\n */\nexport const buildMapLibreFlowFilters = (flowFilters: TrafficFlowFilters): MultiSyntaxFilter | null => {\n    if (!flowFilters?.any?.length) {\n        return null;\n    }\n    const mapLibreFilters = flowFilters.any\n        .map(buildMapLibreFlowFilter)\n        .filter((mapLibreFilter) => !isNil(mapLibreFilter));\n    return getMergedAnyFilter(mapLibreFilters);\n};\n\n/**\n * @ignore\n * @param filter\n * @param layers\n * @param mapLibreMap\n * @param originalFilters\n */\nexport const applyFilter = (\n    filter: MultiSyntaxFilter | undefined,\n    layers: LayerSpecification[],\n    mapLibreMap: Map,\n    originalFilters: Record<string, FilterSpecification | undefined>,\n) => {\n    for (const layer of layers) {\n        mapLibreMap.setFilter(\n            layer.id,\n            filter ? getMergedAllFilter(filter, originalFilters[layer.id]) : originalFilters[layer.id],\n        );\n    }\n};\n","import { isNil, omitBy } from 'lodash-es';\nimport type { FilterSpecification } from 'maplibre-gl';\nimport type { LayerSpecWithSource } from '../shared';\nimport {\n    AbstractMapModule,\n    EventsModule,\n    filterLayersBySources,\n    StyleSourceWithLayers,\n    TRAFFIC_FLOW_SOURCE_ID,\n} from '../shared';\nimport { notInTheStyle } from '../shared/errorMessages';\nimport { ensureAddedToStyle, waitUntilMapIsReady } from '../shared/mapUtils';\nimport type { TomTomMap } from '../TomTomMap';\nimport { applyFilter, buildMapLibreFlowFilters } from './filters/trafficFilters';\nimport type { FlowConfig, TrafficFlowFilters } from './types/trafficModuleConfig';\n\n/**\n * IDs of sources and layers for traffic flow module.\n */\ntype TrafficFlowSourcesWithLayers = {\n    trafficFlow: StyleSourceWithLayers;\n};\n\n/**\n * Traffic Flow Module for displaying and configuring real-time traffic flow information on the map.\n *\n * This module controls the vector tile traffic flow layers that visualize current\n * traffic speed conditions using color-coded road segments.\n *\n * @remarks\n * **Features:**\n * - Toggle traffic flow visibility on/off\n * - Filter by road categories and types\n * - Color-coded speed visualization (green = free flow, red = congestion)\n * - Real-time traffic data from vector tiles\n * - Filter road closures\n *\n * **Visual Representation:**\n * - Green: Free-flowing traffic\n * - Yellow/Orange: Slow traffic\n * - Red: Heavy congestion\n * - Dark gray: Road closures\n *\n * **Use Cases:**\n * - Real-time traffic monitoring\n * - Route planning with current conditions\n * - Traffic analysis applications\n * - Navigation systems\n *\n * @example\n * Basic usage:\n * ```typescript\n * import { TrafficFlowModule } from '@tomtom-international/maps-sdk-js/map';\n *\n * // Get module (auto-add to style if needed)\n * const trafficFlow = await TrafficFlowModule.get(map, {\n *   visible: true\n * });\n *\n * // Toggle visibility\n * trafficFlow.setVisible(false);\n * trafficFlow.setVisible(true);\n * ```\n *\n * @example\n * Filter by road type:\n * ```typescript\n * // Show only highway traffic\n * trafficFlow.filter({\n *   any: [{\n *     roadCategories: {\n *       show: 'only',\n *       values: ['motorway', 'trunk']\n *     }\n *   }]\n * });\n *\n * // Hide local streets\n * trafficFlow.filter({\n *   any: [{\n *     roadCategories: {\n *       show: 'all_except',\n *       values: ['street']\n *     }\n *   }]\n * });\n * ```\n *\n * @example\n * Show only road closures:\n * ```typescript\n * trafficFlow.filter({\n *   any: [{\n *     showRoadClosures: 'only'\n *   }]\n * });\n * ```\n *\n * @see [Traffic Flow Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/traffic-flow)\n * @see [Traffic Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/traffic)\n *\n * @group Traffic Flow\n */\nexport class TrafficFlowModule extends AbstractMapModule<TrafficFlowSourcesWithLayers, FlowConfig> {\n    private originalFilters!: Record<string, FilterSpecification | undefined>;\n\n    /**\n     * Retrieves a TrafficFlowModule instance for the given map.\n     *\n     * @param map - The TomTomMap instance to attach this module to.\n     * @param config - Optional configuration for initialization, visibility, and filters.\n     *\n     * @returns A promise that resolves to the initialized TrafficFlowModule.\n     *\n     * @remarks\n     * **Configuration:**\n     * - `visible`: Initial visibility state\n     * - `ensureAddedToStyle`: Auto-add traffic flow to style if missing\n     * - `filters`: Road category and type filters\n     *\n     * **Style Requirement:**\n     * Traffic flow must be included in the map style or added via `ensureAddedToStyle`.\n     *\n     * @throws Error if traffic flow source is not in style and `ensureAddedToStyle` is false\n     *\n     * @example\n     * Default initialization:\n     * ```typescript\n     * const trafficFlow = await TrafficFlowModule.get(map);\n     * ```\n     *\n     * @example\n     * Auto-add to style:\n     * ```typescript\n     * const trafficFlow = await TrafficFlowModule.get(map, {\n     *   visible: true,\n     *   filters: {\n     *     any: [{\n     *       roadCategories: {\n     *         show: 'only',\n     *         values: ['motorway', 'trunk', 'primary']\n     *       }\n     *     }]\n     *   }\n     * });\n     * ```\n     */\n    static async get(map: TomTomMap, config?: FlowConfig): Promise<TrafficFlowModule> {\n        await waitUntilMapIsReady(map);\n        await ensureAddedToStyle(map, TRAFFIC_FLOW_SOURCE_ID, 'trafficFlow');\n        return new TrafficFlowModule(map, config);\n    }\n\n    private constructor(map: TomTomMap, config?: FlowConfig) {\n        super('style', map, config);\n    }\n\n    /**\n     * @ignore\n     */\n    protected _initSourcesWithLayers() {\n        const flowSource = this.mapLibreMap.getSource(TRAFFIC_FLOW_SOURCE_ID);\n        if (!flowSource) {\n            throw notInTheStyle(`init ${TrafficFlowModule.name} with source ID ${TRAFFIC_FLOW_SOURCE_ID}`);\n        }\n        this.originalFilters = {};\n        for (const layer of this.getLayers()) {\n            this.originalFilters[layer.id] = layer.filter;\n        }\n        return { trafficFlow: new StyleSourceWithLayers(this.mapLibreMap, flowSource) };\n    }\n\n    /**\n     * @ignore\n     */\n    protected _applyConfig(config: FlowConfig | undefined) {\n        this.setVisible(config?.visible ?? false);\n        this._filter(config?.filters, false);\n        return config;\n    }\n\n    private getLayers(): LayerSpecWithSource[] {\n        return filterLayersBySources(this.tomtomMap.mapLibreMap, [TRAFFIC_FLOW_SOURCE_ID]);\n    }\n\n    /**\n     * Applies filters to traffic flow display.\n     *\n     * @param filters - Filter configuration for road types, categories, and closures.\n     * Pass `undefined` to reset to defaults (show all).\n     *\n     * @remarks\n     * **Filter Options:**\n     * - `roadCategories`: Filter by road importance (motorway, trunk, primary, etc.)\n     * - `roadSubCategories`: Filter by specific street types\n     * - `showRoadClosures`: Show only closures or exclude them\n     *\n     * **Available Road Categories:**\n     * - `motorway`: Major highways\n     * - `trunk`: Major roads\n     * - `primary`: Primary roads\n     * - `secondary`: Secondary roads\n     * - `tertiary`: Tertiary roads\n     * - `street`: Local streets\n     *\n     * **Filter Logic:**\n     * Uses \"any\" (OR) logic - traffic matching any filter is shown.\n     *\n     * @example\n     * Show only major roads:\n     * ```typescript\n     * trafficFlow.filter({\n     *   any: [{\n     *     roadCategories: {\n     *       show: 'only',\n     *       values: ['motorway', 'trunk', 'primary']\n     *     }\n     *   }]\n     * });\n     * ```\n     *\n     * @example\n     * Hide street-level traffic:\n     * ```typescript\n     * trafficFlow.filter({\n     *   any: [{\n     *     roadCategories: {\n     *       show: 'all_except',\n     *       values: ['street']\n     *     }\n     *   }]\n     * });\n     * ```\n     *\n     * @example\n     * Multiple filter criteria:\n     * ```typescript\n     * trafficFlow.filter({\n     *   any: [\n     *     {\n     *       roadCategories: { show: 'only', values: ['motorway'] }\n     *     },\n     *     {\n     *       showRoadClosures: 'only'\n     *     }\n     *   ]\n     * });\n     * ```\n     *\n     * @example\n     * Reset filters:\n     * ```typescript\n     * trafficFlow.filter(undefined);\n     * ```\n     */\n    filter(filters?: TrafficFlowFilters) {\n        this._filter(filters);\n    }\n\n    private _filter(filters: TrafficFlowFilters | undefined, updateConfig = true) {\n        if (this.tomtomMap.mapReady) {\n            if (filters?.any?.length) {\n                const filterExpression = buildMapLibreFlowFilters(filters);\n                if (filterExpression) {\n                    applyFilter(filterExpression, this.getLayers(), this.mapLibreMap, this.originalFilters);\n                }\n            } else if (this.config?.filters?.any?.length) {\n                applyFilter(undefined, this.getLayers(), this.mapLibreMap, this.originalFilters);\n            }\n        }\n\n        if (updateConfig) {\n            this.config = omitBy({ ...this.config, filters }, isNil);\n        }\n    }\n\n    /**\n     * Sets the visibility of traffic flow layers.\n     *\n     * @param visible - `true` to show traffic flow, `false` to hide it.\n     *\n     * @example\n     * ```typescript\n     * trafficFlow.setVisible(true);  // Show traffic\n     * trafficFlow.setVisible(false); // Hide traffic\n     * ```\n     */\n    setVisible(visible: boolean): void {\n        this.config = { ...this.config, visible };\n        if (this.tomtomMap.mapReady) {\n            this.sourcesWithLayers.trafficFlow.setLayersVisible(visible);\n        }\n    }\n\n    /**\n     * Returns if any layer for traffic flow is visible or not.\n     */\n    isVisible(): boolean {\n        return this.sourcesWithLayers.trafficFlow.isAnyLayerVisible();\n    }\n\n    /**\n     * Create the events on/off for this module\n     * @returns An instance of EventsModule\n     */\n    get events() {\n        return new EventsModule(this.tomtomMap._eventsProxy, this.sourcesWithLayers.trafficFlow);\n    }\n}\n","import { isEmpty, isNil, omitBy } from 'lodash-es';\nimport type { FilterSpecification } from 'maplibre-gl';\nimport type { LayerSpecWithSource } from '../shared';\nimport {\n    AbstractMapModule,\n    EventsModule,\n    filterLayersBySources,\n    StyleSourceWithLayers,\n    TRAFFIC_INCIDENTS_SOURCE_ID,\n} from '../shared';\nimport { notInTheStyle } from '../shared/errorMessages';\nimport { ensureAddedToStyle, waitUntilMapIsReady } from '../shared/mapUtils';\nimport type { TomTomMap } from '../TomTomMap';\nimport { applyFilter, buildMapLibreIncidentFilters } from './filters/trafficFilters';\nimport type { IncidentsConfig, TrafficIncidentsFilters } from './types/trafficModuleConfig';\n\n/**\n * IDs of sources and layers for traffic incidents module.\n */\ntype TrafficIncidentsSourcesWithLayers = {\n    trafficIncidents: StyleSourceWithLayers;\n};\n\n/**\n * Traffic Incidents Module for displaying and configuring real-time traffic incidents on the map.\n *\n * This module controls the vector tile traffic incidents layers that show traffic\n * events like accidents, road closures, construction, and hazards.\n *\n * @remarks\n * **Features:**\n * - Toggle incidents visibility on/off\n * - Separate control for incident icons\n * - Filter by incident type (accident, construction, etc.)\n * - Filter by severity/delay magnitude\n * - Filter by road categories\n * - Icon and line/polygon visualization\n *\n * **Incident Types:**\n * - Accidents\n * - Road closures\n * - Construction/road works\n * - Weather conditions (fog, ice, rain, etc.)\n * - Lane closures\n * - Traffic jams\n * - Broken down vehicles\n *\n * **Use Cases:**\n * - Real-time incident monitoring\n * - Route planning around incidents\n * - Traffic management systems\n * - Driver alert systems\n *\n * @example\n * Basic usage:\n * ```typescript\n * import { TrafficIncidentsModule } from '@tomtom-international/maps-sdk-js/map';\n *\n * // Get module (auto-add to style if needed)\n * const incidents = await TrafficIncidentsModule.get(map, {\n *   visible: true\n * });\n *\n * // Toggle visibility\n * incidents.setVisible(false);\n * incidents.setVisible(true);\n *\n * // Control icons separately\n * incidents.setIconsVisible(false);\n * ```\n *\n * @example\n * Filter by incident type:\n * ```typescript\n * // Show only accidents and road closures\n * incidents.filter({\n *   any: [{\n *     incidentCategories: {\n *       show: 'only',\n *       values: ['accident', 'road_closed']\n *     }\n *   }]\n * });\n *\n * // Hide construction\n * incidents.filter({\n *   any: [{\n *     incidentCategories: {\n *       show: 'all_except',\n *       values: ['road_works']\n *     }\n *   }]\n * });\n * ```\n *\n * @example\n * Filter by severity:\n * ```typescript\n * // Show only major delays\n * incidents.filter({\n *   any: [{\n *     magnitudes: {\n *       show: 'only',\n *       values: ['major']\n *     }\n *   }]\n * });\n *\n * // Show incidents with at least 10 minutes delay\n * incidents.filter({\n *   any: [{\n *     delays: {\n *       mustHaveDelay: true,\n *       minDelayMinutes: 10\n *     }\n *   }]\n * });\n * ```\n *\n * @example\n * Filter icons separately from incident areas:\n * ```typescript\n * // Show all incidents but only major icons\n * incidents.filter(\n *   {\n *     any: [{}] // Show all incidents\n *   },\n *   {\n *     any: [{\n *       magnitudes: { show: 'only', values: ['major'] }\n *     }]\n *   }\n * );\n * ```\n *\n * @see [Traffic Incidents Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/traffic-incidents)\n * @see [Traffic Guide](https://docs.tomtom.com/maps-sdk-js/guides/map/traffic)\n *\n * @group Traffic Incidents\n */\nexport class TrafficIncidentsModule extends AbstractMapModule<TrafficIncidentsSourcesWithLayers, IncidentsConfig> {\n    private originalFilters!: Record<string, FilterSpecification | undefined>;\n\n    /**\n     * Retrieves a TrafficIncidentsModule instance for the given map.\n     *\n     * @param map - The TomTomMap instance to attach this module to.\n     * @param config - Optional configuration for initialization, visibility, and filters.\n     *\n     * @returns A promise that resolves to the initialized TrafficIncidentsModule.\n     *\n     * @remarks\n     * **Configuration:**\n     * - `visible`: Initial visibility state for all incidents\n     * - `icons.visible`: Initial visibility for incident icons\n     * - `ensureAddedToStyle`: Auto-add traffic incidents to style if missing\n     * - `filters`: Incident type, severity, and delay filters\n     * - `icons.filters`: Separate filters for icons\n     *\n     * @throws Error if traffic incidents source is not in style and `ensureAddedToStyle` is false\n     *\n     * @example\n     * Default initialization:\n     * ```typescript\n     * const incidents = await TrafficIncidentsModule.get(map);\n     * ```\n     *\n     * @example\n     * With configuration:\n     * ```typescript\n     * const incidents = await TrafficIncidentsModule.get(map, {\n     *   visible: true,\n     *   icons: { visible: true },\n     *   filters: {\n     *     any: [{\n     *       incidentCategories: {\n     *         show: 'only',\n     *         values: ['accident', 'road_closed', 'jam']\n     *       }\n     *     }]\n     *   }\n     * });\n     * ```\n     */\n    static async get(map: TomTomMap, config?: IncidentsConfig): Promise<TrafficIncidentsModule> {\n        await waitUntilMapIsReady(map);\n        await ensureAddedToStyle(map, TRAFFIC_INCIDENTS_SOURCE_ID, 'trafficIncidents');\n        return new TrafficIncidentsModule(map, config);\n    }\n\n    private constructor(map: TomTomMap, config?: IncidentsConfig) {\n        super('style', map, config);\n    }\n\n    /**\n     * @ignore\n     */\n    protected _initSourcesWithLayers() {\n        const incidentsSource = this.mapLibreMap.getSource(TRAFFIC_INCIDENTS_SOURCE_ID);\n        if (!incidentsSource) {\n            throw notInTheStyle(`init ${TrafficIncidentsModule.name} with source ID ${TRAFFIC_INCIDENTS_SOURCE_ID}`);\n        }\n        this.originalFilters = {};\n        for (const layer of this.getLayers()) {\n            this.originalFilters[layer.id] = layer.filter;\n        }\n        return { trafficIncidents: new StyleSourceWithLayers(this.mapLibreMap, incidentsSource) };\n    }\n\n    /**\n     * @ignore\n     */\n    protected _applyConfig(config: IncidentsConfig | undefined) {\n        // We do not update config in setVisible since it could override icons visibility setting:\n        this._setVisible(config?.visible ?? false, { updateConfig: false });\n        if (!isNil(config?.icons?.visible)) {\n            this.setIconsVisible(config.icons.visible);\n        }\n        this._filter(config?.filters, config?.icons?.filters, false);\n        console.log(config);\n        return config;\n    }\n\n    /**\n     * Applies filters to traffic incidents display.\n     *\n     * @param incidentFilters - Filter for incident areas/lines. Pass `undefined` to reset.\n     * @param iconFilters - Optional separate filter for incident icons. Pass `undefined` to reset.\n     *\n     * @remarks\n     * **Filter Options:**\n     * - `incidentCategories`: Filter by incident type\n     * - `magnitudes`: Filter by delay severity (minor/moderate/major/unknown)\n     * - `delays`: Filter by delay duration\n     * - `roadCategories`: Filter by road importance\n     * - `roadSubCategories`: Filter by specific road types\n     *\n     * **Available Incident Categories:**\n     * - `accident`, `road_closed`, `lane_closed`\n     * - `road_works` (construction)\n     * - `jam` (traffic jam)\n     * - `fog`, `rain`, `ice`, `wind`, `flooding`\n     * - `dangerous_conditions`\n     * - `broken_down_vehicle`\n     * - `unknown`\n     *\n     * **Delay Magnitudes:**\n     * - `minor`: Small delays\n     * - `moderate`: Moderate delays\n     * - `major`: Significant delays\n     * - `unknown`: Unknown or no delay info\n     *\n     * @example\n     * Filter by type:\n     * ```typescript\n     * incidents.filter({\n     *   any: [{\n     *     incidentCategories: {\n     *       show: 'only',\n     *       values: ['accident', 'road_closed']\n     *     }\n     *   }]\n     * });\n     * ```\n     *\n     * @example\n     * Filter by severity and delay:\n     * ```typescript\n     * incidents.filter({\n     *   any: [{\n     *     magnitudes: { show: 'only', values: ['major', 'moderate'] },\n     *     delays: {\n     *       mustHaveDelay: true,\n     *       minDelayMinutes: 5\n     *     }\n     *   }]\n     * });\n     * ```\n     *\n     * @example\n     * Different filters for icons and areas:\n     * ```typescript\n     * // Show all incidents on roads\n     * const incidentFilter = {\n     *   any: [{\n     *     roadCategories: { show: 'only', values: ['motorway', 'trunk'] }\n     *   }]\n     * };\n     *\n     * // But only show icons for major incidents\n     * const iconFilter = {\n     *   any: [{\n     *     magnitudes: { show: 'only', values: ['major'] }\n     *   }]\n     * };\n     *\n     * incidents.filter(incidentFilter, iconFilter);\n     * ```\n     */\n    filter(incidentFilters?: TrafficIncidentsFilters, iconFilters?: TrafficIncidentsFilters) {\n        this._filter(incidentFilters, iconFilters);\n    }\n\n    private _filter(\n        incidentFilters: TrafficIncidentsFilters | undefined,\n        iconFilters: TrafficIncidentsFilters | undefined,\n        updateConfig = true,\n    ) {\n        if (this.tomtomMap.mapReady) {\n            if (incidentFilters?.any?.length) {\n                const incidentFilterExpression = buildMapLibreIncidentFilters(incidentFilters);\n                if (incidentFilterExpression) {\n                    const layers = iconFilters ? this.getNonSymbolLayers() : this.getLayers();\n                    applyFilter(incidentFilterExpression, layers, this.mapLibreMap, this.originalFilters);\n                }\n            } else if (this.config?.filters?.any?.length) {\n                applyFilter(undefined, this.getLayers(), this.mapLibreMap, this.originalFilters);\n            }\n            if (iconFilters?.any?.length) {\n                const iconFilterExpression = buildMapLibreIncidentFilters(iconFilters);\n                if (iconFilterExpression) {\n                    applyFilter(iconFilterExpression, this.getSymbolLayers(), this.mapLibreMap, this.originalFilters);\n                }\n            }\n        }\n\n        // else: default incidents visibility has been set already if necessary\n        if (updateConfig) {\n            this.config = omitBy(\n                {\n                    ...this.config,\n                    filters: incidentFilters,\n                    icons: { ...this.config?.icons, filters: iconFilters },\n                },\n                isNil,\n            );\n        }\n    }\n\n    private getLayers(): LayerSpecWithSource[] {\n        return filterLayersBySources(this.tomtomMap.mapLibreMap, [TRAFFIC_INCIDENTS_SOURCE_ID]);\n    }\n\n    private getSymbolLayers(): LayerSpecWithSource[] {\n        return this.getLayers().filter((layer) => layer.type === 'symbol');\n    }\n\n    private getNonSymbolLayers(): LayerSpecWithSource[] {\n        return this.getLayers().filter((layer) => layer.type != 'symbol');\n    }\n\n    /**\n     * Sets the visibility of incident icon layers.\n     *\n     * @param visible - `true` to show icons, `false` to hide them.\n     *\n     * @remarks\n     * This controls only the icon/symbol layers, not the incident area polygons or lines.\n     *\n     * @example\n     * ```typescript\n     * // Hide icons but keep incident areas visible\n     * incidents.setIconsVisible(false);\n     *\n     * // Show icons\n     * incidents.setIconsVisible(true);\n     * ```\n     */\n    setIconsVisible(visible: boolean): void {\n        // We adjust the config for this change (but it might be overwritten if it's part of an \"applyConfig\" call)\n        this.config = { ...this.config, icons: { ...this.config?.icons, visible } };\n\n        if (this.tomtomMap.mapReady) {\n            this.sourcesWithLayers.trafficIncidents.setLayersVisible(\n                visible,\n                (layerSpec) => layerSpec.type === 'symbol',\n            );\n        }\n    }\n\n    /**\n     * Sets the visibility of all traffic incident layers.\n     *\n     * @param visible - `true` to show incidents, `false` to hide them.\n     *\n     * @remarks\n     * This controls all incident layers including icons, lines, and polygons.\n     *\n     * @example\n     * ```typescript\n     * incidents.setVisible(false); // Hide all incidents\n     * incidents.setVisible(true);  // Show all incidents\n     * ```\n     */\n    setVisible(visible: boolean): void {\n        this._setVisible(visible);\n    }\n\n    private _setVisible(visible: boolean, options?: { updateConfig: boolean }): void {\n        const updateConfig = options?.updateConfig ?? true;\n        if (updateConfig) {\n            // setting all traffic visible also nullifies the icons visible setting\n            delete this.config?.icons?.visible;\n            // we remove empty values from config to avoid confusion (in case icons part is just empty after deleting visible)\n            this.config = { ...omitBy({ ...this.config }, isEmpty), visible };\n        }\n        if (this.tomtomMap.mapReady) {\n            this.sourcesWithLayers.trafficIncidents.setLayersVisible(visible);\n        }\n    }\n\n    /**\n     * Checks if any traffic incident layers are currently visible.\n     *\n     * @returns `true` if any incident layer is visible, `false` if all are hidden.\n     *\n     * @example\n     * ```typescript\n     * if (incidents.isVisible()) {\n     *   console.log('Incidents are displayed');\n     * }\n     * ```\n     */\n    isVisible(): boolean {\n        return this.sourcesWithLayers.trafficIncidents.isAnyLayerVisible();\n    }\n\n    /**\n     * Checks if any incident icon layers are currently visible.\n     *\n     * @returns `true` if any icon layer is visible, `false` if all icons are hidden.\n     *\n     * @example\n     * ```typescript\n     * if (incidents.anyIconLayersVisible()) {\n     *   console.log('Incident icons are shown');\n     * }\n     * ```\n     */\n    anyIconLayersVisible(): boolean {\n        return !!this.sourcesWithLayers.trafficIncidents?.isAnyLayerVisible((layerSpec) => layerSpec.type === 'symbol');\n    }\n\n    /**\n     * Create the events on/off for this module\n     * @returns An instance of EventsModule\n     */\n    get events() {\n        return new EventsModule(this.tomtomMap._eventsProxy, this.sourcesWithLayers.trafficIncidents);\n    }\n}\n"],"names":["freeGlobal","global","Object","freeSelf","self","root","Function","Symbol","objectProto","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","toStringTag","baseGetTag","value","isOwn","call","tag","unmasked","e","result","getRawTag","objectToString","isObjectLike","isSymbol","arrayMap","array","iteratee","index","length","Array","isArray","symbolProto","symbolToString","baseToString","isObject","type","identity","isFunction","uid","coreJsData","maskSrcKey","exec","keys","IE_PROTO","funcToString","toSource","func","reIsHostCtor","funcProto","reIsNative","RegExp","replace","baseIsNative","test","getNative","object","key","getValue","WeakMap","nativeNow","Date","now","count","lastCalled","defineProperty","baseSetToString","string","configurable","enumerable","writable","setToString","stamp","remaining","arguments","apply","reIsUint","isIndex","baseAssignValue","eq","other","assignValue","objValue","nativeMax","Math","max","isLength","isArrayLike","isPrototype","Ctor","constructor","baseIsArguments","propertyIsEnumerable","isArguments","freeExports","exports","nodeType","freeModule","module","Buffer","isBuffer","typedArrayTags","baseUnary","freeProcess","process","nodeUtil","types","require","binding","nodeIsTypedArray","isTypedArray","arrayLikeKeys","inherited","isArr","isArg","isBuff","isType","skipIndexes","n","baseTimes","String","push","overArg","transform","arg","nativeKeys","baseKeys","baseKeysIn","nativeKeysIn","isProto","keysIn","reIsDeepProp","reIsPlainProp","isKey","nativeCreate","Hash","entries","this","clear","entry","set","assocIndexOf","__data__","size","has","get","data","splice","ListCache","pop","Map","getMapData","map","MapCache","hash","memoize","resolver","TypeError","memoized","args","cache","Cache","rePropName","reEscapeChar","stringToPath","memoizeCapped","charCodeAt","match","number","quote","subString","castPath","toKey","baseGet","path","arrayPush","values","offset","spreadableSymbol","isConcatSpreadable","isFlattenable","flatten","depth","predicate","isStrict","baseFlatten","getPrototype","getPrototypeOf","objectCtorString","Stack","pairs","LARGE_ARRAY_SIZE","stubArray","allocUnsafe","nativeGetSymbols","getOwnPropertySymbols","getSymbols","resIndex","arrayFilter","symbol","getSymbolsIn","baseGetAllKeys","keysFunc","symbolsFunc","getAllKeys","getAllKeysIn","DataView","Promise","Set","mapTag","promiseTag","setTag","weakMapTag","dataViewTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","getTag","ArrayBuffer","resolve","ctorString","Uint8Array","cloneArrayBuffer","arrayBuffer","byteLength","reFlags","symbolValueOf","valueOf","initCloneByTag","isDeep","regexp","dataView","buffer","byteOffset","typedArray","cloneTypedArray","source","lastIndex","nodeIsMap","isMap","nodeIsSet","isSet","argsTag","funcTag","objectTag","cloneableTags","baseClone","bitmask","customizer","stack","input","initCloneArray","isFunc","slice","stacked","forEach","subValue","add","props","arrayEach","SetCache","arraySome","equalArrays","equalFunc","isPartial","arrLength","othLength","arrStacked","othStacked","seen","arrValue","othValue","compared","othIndex","mapToArray","setToArray","arrayTag","baseIsEqualDeep","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","name","message","convert","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","objLength","objStacked","skipCtor","objCtor","othCtor","equalObjects","baseIsEqual","isStrictComparable","matchesStrictComparable","srcValue","baseMatches","matchData","getMatchData","COMPARE_PARTIAL_FLAG","baseIsMatch","baseHasIn","hasIn","hasFunc","hasPath","baseMatchesProperty","defaultValue","property","basePropertyDeep","baseIteratee","parent","start","end","baseSlice","isEmpty","isEqual","isNil","baseUnset","customOmitClone","proto","isPlainObject","omit","otherArgs","thisArg","overRest","flatRest","paths","isNew","newValue","copyObject","CLONE_DEEP_FLAG","baseSet","nested","pickBy","prop","basePickBy","omitBy","negate","remove","indexes","previous","basePullAt","notInTheStyle","actionText","Error","isDOMImageSupported","document","DOMParser","btoa","svgToImg","svgDomElement","img","createElement","src","XMLSerializer","serializeToString","parseSvg","svgString","parseFromString","documentElement","pinSvg","options","element","fillColor","querySelector","setAttribute","outlineColor","outlineOpacity","asDefined","assertDefined","TomTomMapSource","id","spec","runtimeSource","ensureAddedToMap","getSource","addSource","AbstractSourceWithLayers","layerSpecs","_layerSpecs","_updateSourceAndLayerIDs","isAnyLayerVisible","filter","getLayerSpecs","some","layer","isLayerVisible","areAllLayersVisible","every","_sourceAndLayerIDs","sourceID","layerIDs","getLayoutProperty","setLayersVisible","visible","layerSpec","setLayoutProperty","validate","sourceAndLayerIDs","equalSourceAndLayerIDs","filterLayersBySources","loadedMap","sourceIDs","getStyle","layers","includes","StyleSourceWithLayers","super","sources","AddedSourceWithLayers","sourceId","sourceSpec","ensureLayersAddedToMap","getLayer","addLayer","beforeID","ensureAddedToMapWithVisibility","addLayersToMap","emptyFeatureCollection","features","GeoJSONSourceWithLayers","promoteId","shownFeatures","show","featureCollection","setData","findFeature","find","f","putEventState","mode","feature","properties","eventState","state","cleanEventState","cleanEventStates","changed","states","waitUntilMapIsReady","async","tomtomMap","mapReady","mapLibreMap","once","deserializeFeatures","JSON","parse","console","warn","changeLayerProps","newLayerProps","prevLayerProps","layerId","maxzoom","minzoom","setLayerZoomRange","getMinZoom","getMaxZoom","setFilter","layout","paint","setPaintProperty","changeLayersProps","layoutPaint","addLayers","layersToAdd","layerIdsAlreadyOnMap","visibility","mapIdDependency","idsWeCanProcess","stringify","updateStyleWithModule","style","styleModule","include","cannotAddStyleModuleToCustomStyle","ensureAddedToStyle","isStyleLoaded","setStyle","isSourceLoaded","waitUntilSourceIsLoaded","addOrUpdateImage","imageId","imageToLoad","imgElement","hasImage","addImage","setTimeout","loadImage","getStandardStyleTheme","standardStyleID","getStyleLightDarkTheme","styleInput","standardStyle","AbstractMapModule","sourceType","config","_initializing","moduleReady","eventsProxy","_eventsProxy","initSourcesWithLayers","applyConfig","addStyleChangeHandler","onStyleAboutToChange","onStyleChanged","restoreDataAndConfig","restore","sourcesWithLayers","_initSourcesWithLayers","fromEntries","sourceWithLayers","updateIfRegistered","waitUntilModuleReady","interval","setInterval","clearInterval","_applyConfig","resetConfig","restoreDataAndConfigImpl","getConfig","EventsModule","eventProxy","on","handler","addEventHandler","off","AbstractEventProxy","interactiveLayerIDs","handlers","findHandlers","flatMap","sourceEventTypeHandlers","ensureInteractiveLayerIDsAdded","handlerFn","fn","matchesLayers","removeAll","hasSourceID","sourceHandlers","isHighPriority","eventType","featureId","featuresToUpdate","i","findFeatureById","updatedFeature","removeEventStateAndShow","newEventType","rawFeature","prevFeaturesToUpdate","updateEventState","eventFeature","prevEventFeature","prevSourceWithLayers","updatedIndex","featureB","featureA","eventsProxyDefaultConfig","precisionMode","paddingBoxPx","cursorOnHover","cursorOnMouseDown","cursorOnMap","longHoverDelayAfterMapMoveMS","longHoverDelayOnStillMapMS","EventsProxy","enabled","firstDelayedHoverSinceMapMove","mapCanvas","getCanvas","cursor","lastCursorStyle","defaultZoomLevel","round","getZoom","listenToEvents","ev","onMouseMove","onMouseStart","onMouseOut","onMouseDown","onMouseUp","onMapClick","enable","clearLongHoverTimeout","toPaddedBounds","point","padding","x","y","isEnabled","isMoving","getRenderedFeatures","precision","renderedFeatures","queryRenderedFeatures","window","clearTimeout","longHoverTimeoutHandlerID","restartLongHoverTimeout","handleLongHoverTimeout","hoveringSourceWithLayers","hoveringFeature","hoveringLngLat","hoveringFeatures","hoveredTopFeature","hoverChanged","mouseInMotionOverHoveredFeature","hoveringPoint","prevHoveredPoint","prevHoveredFeature","detectHoverState","lngLat","prevHoveredSourceWithLayers","allHandlers","updateCursor","hoverHandlers","clickType","clickedFeatures","prevClickedFeature","lastClickedFeature","prevClickedSourceWithLayers","lastClickedSourceWithLayers","clickHandlers","mapStyleLayerIDs","country","lowestPlaceLabel","poi","lowestLabel","lowestRoadLine","lowestBuilding","POI_SOURCE_ID","HILLSHADE_SOURCE_ID","PLACES_SOURCE_PREFIX_ID","BASE_MAP_SOURCE_ID","TRAFFIC_INCIDENTS_SOURCE_ID","TRAFFIC_FLOW_SOURCE_ID","poiLayerIDs","mapDisplayPoiCategoryMappings","ACCESS_GATEWAY","ADVENTURE_SPORTS_FACILITY","ADVENTURE_SPORTS_VENUE","AGRICULTURE","AIRPORT","AMUSEMENT_PARK","AQUATIC_ZOO","ASHRAM","ATM","AUTOMOTIVE_DEALER","BANK","BEACH","BUS_STOP","BUSINESS_PARK","CAFE_PUB","CAMPING_GROUND","CAR_WASH","CASH_DISPENSER","CASINO","CLOTHING_SHOP","CHURCH","CINEMA","CLUB_ASSOCIATION","COLLEGE_UNIVERSITY","COMMERCIAL_BUILDING","COMMUNITY_CENTER","COMPANY","CONCERT_HALL","COURTHOUSE","CULTURAL_CENTER","DENTIST","DEPARTMENT_STORE","DOCTOR","ELECTRIC_VEHICLE_STATION","EMBASSY","EMERGENCY_MEDICAL_SERVICE","EMERGENCY_ROOM","ENTERTAINMENT","EXCHANGE","EXHIBITION_CONVENTION_CENTER","FERRY_TERMINAL","FIRE_STATION_BRIGADE","FRONTIER_CROSSING","FUEL_FACILITIES","GAS_STATION","GEOGRAPHIC_FEATURE","GOLD_EXCHANGE","GOLF_COURSE","GOVERNMENT_OFFICE","GURUDWARA","HEALTH_CARE_SERVICE","HELIPAD_HELICOPTER_LANDING","HILL","HOLIDAY_RENTAL","HOSPITAL","HOSPITAL_POLYCLINIC","HOTEL_MOTEL","ICE_SKATING_RINK","IMPORTANT_TOURIST_ATTRACTION","INDUSTRIAL_BUILDING","LEISURE_CENTER","LIBRARY","MANUFACTURING_FACILITY","MARINA","MARKET","MEDIA_FACILITY","MILITARY_INSTALLATION","MOSQUE","MOTORING_ORGANIZATION_OFFICE","MOUNTAIN_PASS","MOUNTAIN_PEAK","MOVIE_THEATER","MUSEUM","NATIVE_RESERVATION","NIGHTLIFE","NON_GOVERNMENTAL_ORGANIZATION","OPEN_PARKING_AREA","OPERA_HOUSE","PAGODA","PARK_RECREATION_AREA","PARKING_GARAGE","PETROL_STATION","PHARMACY","PLACE_OF_WORSHIP","POLICE_STATION","PORT_WAREHOUSE_FACILITY","POST_OFFICE","PRIMARY_RESOURCE_UTILITY","PRISON_CORRECTIONAL_FACILITY","PUBLIC_AMENITY","PUBLIC_TRANSPORT_STOP","RAILWAY_STATION","RENT_A_CAR_FACILITY","RENT_A_CAR_PARKING","REPAIR_FACILITY","RESEARCH_FACILITY","RESIDENTIAL_ACCOMMODATION","REST_AREA","RESTAURANT","RESTAURANT_AREA","SCENIC_PANORAMIC_VIEW","SCHOOL","SHOP","SHOPPING_CENTER","SPORTS_CENTER","STADIUM","SUPERMARKETS_HYPERMARKETS","SWIMMING_POOL","SYNAGOG","TAXI_STAND","TEMPLE","TENNIS_COURT","THEATER","TOLL_GATE","TOURIST_INFORMATION_OFFICE","TRAFFIC_CONTROL_DEPARTMENT","TRAFFIC_SERVICE_CENTER","TRAIL_SYSTEM","TRAILS","TRANSPORT_AUTHORITY_VEHICLE_REGISTRATION","TRUCK_STOP","VACATION_RENTAL","VETERINARIAN","WATER_SPORT","WEIGH_STATION","WELFARE_ORGANIZATION","WINERY","ZOOS_ARBORETA_BOTANICAL_GARDEN","toMapDisplayPOICategory","category","toLowerCase","MAP_BOLD_FONT","TITLE","ICON_ID","DEFAULT_PLACE_ICON_ID","pinIconBaseLayout","pinIconBasePaint","pinTextBaseLayout","pinTextBasePaint","pinLayerBaseSpec","isClickEventState","hasEventState","SELECTED_COLOR","pinLayerSpec","selectedPinLayerSpec","withConfig","layerName","textConfig","text","customLayer","font","title","color","haloColor","haloWidth","getTextSizeSpec","textSize","buildPlacesLayerSpecs","layerSpecTemplates","theme","poiLikeLayerSpec","poiLayer","buildPoiLikeLayerSpec","main","selected","additional","defaultPin","supportedPinSubcategories","buildPlaceTitle","place","address","freeformAddress","imageIDWithInstanceSuffix","baseID","instanceIndex","getIconIDForPlace","iconTheme","categoryIcons","icon","classificationCode","classifications","code","matchingCustomIcon","customIcon","defaultPlaceIconID","iconId","categoryID","categoryIds","substring","toMapDisplayPin","getPOILayerCategoryForPlace","toPlaces","places","preparePlacesForDisplay","placesInput","extraFeatureProps","geometry","bbox","iconID","_PlacesModule","lastInstanceIndex","layerIDPrefix","buildLayerSpecs","updateLayersAndData","previousShownFeatures","applyTheme","applyConfigPart","applyIconConfig","iconConfig","applyTextConfig","partialConfig","applyExtraFeatureProps","updateData","setupImages","newLayerSpecs","newLayerSpecsArray","oldLayerSpecsArray","log","image","pixelRatio","default","events","PlacesModule","isExpressionFilter","getMergedAnyFilter","filters","expression","legacy","getMergedAllFilter","filterToAdd","originalFilter","buildMappedValuesFilter","propName","showMode","comparator","filterArrayNew","buildValuesFilter","valuesMapping","poiCategoryGroups","FOOD_DRINKS_GROUP","SHOPPING_GROUP","TRANSPORTATION_GROUP","HEALTH_GROUP","PARKING_GROUP","HOLIDAY_TOURISM_GROUP","EV_CHARGING_STATIONS_GROUP","GAS_STATIONS_GROUP","ACCOMMODATION_GROUP","ENTERTAINMENT_GROUP","SPORTS_LEISURE_GROUP","EDUCATION_GROUP","GOVERNMENT_GROUP","getStyleCategories","categories","POIsModule","poiRuntimeSource","mainLayer","getFilter","setVisible","isVisible","filterCategories","categoriesFilter","poiFilter","layerGroupMappings","land","layerIDMatches","layerTypes","borders","water","buildings2D","buildings3D","houseNumbers","roadLines","roadLabels","roadShields","placeLabels","smallerTownLabels","cityLabels","capitalLabels","stateLabels","countryLabels","isMatching","group","mapping","part","buildBaseMapLayerGroupFilter","layerGroupsFilter","layerGroups","groups","names","filterLayerByGroups","BaseMapModule","vectorTiles","layerGroupsVisibility","error","buildLayerGroupFilter","baseMapLayerGroupNames","GEOMETRY_TITLE_PROP","GEOMETRY_COLOR_PROP","colorPalettes","warm","browns","cold","fadedBlues","blues","greens","fadedGreenToBlue","blueToRed","greenToYellow","pastel","retro","contrastRetro","fadedRainbow","pastelRainbow","defaultColor","geometryFillSpec","geometryOutlineSpec","buildGeometryLayerSpecs","fillLayerId","outlineLayerId","colorConfig","lineConfig","fillOpacity","lineColor","lineWidth","lineOpacity","buildGeometryTitleLayerSpec","textField","prepareGeometryForDisplay","buildTitle","palette","buildColor","prepareTitleForDisplay","geometries","coordinates","placeCoordinates","biggestPolygon","flat","reduce","coord","getLongestArray","bboxFromCoordsArray","bboxCenter","_GeometriesModule","titleSourceID","layerIdPrefix","fillLayerID","outlineLayerID","titleLayerID","titleLayerSpec","titleLayerSpecs","geometryFillLayerSpecs","geometryOutlineLayerSpecs","geometryLabel","updateLayerAndData","beforeLayerConfig","moveBeforeLayer","moveBeforeLayerID","beforeLayerId","moveLayer","layerConfig","newTitleLayerSpecs","GeometriesModule","HillshadeModule","hillshadeSource","hillshade","standardStyleIDs","styleModules","ROUTE_LINE_FOREGROUND_COLOR","ROUTE_LINE_OUTLINE_COLOR","DESELECTED_FOREGROUND_COLOR","DESELECTED_OUTLINE_COLOR","DESELECTED_SECONDARY_COLOR","ROUTE_LINE_FOREGROUND_WIDTH","SELECTED_ROUTE_FILTER","DESELECTED_ROUTE_FILTER","MAJOR_DELAY_COLOR","MODERATE_DELAY_COLOR","MINOR_DELAY_LABEL_COLOR","UNKNOWN_DELAY_COLOR","chargingStopTextField","chargingStopSymbol","commonProps","commonLineProps","instructionOutline","instructionLine","INSTRUCTION_ARROW_IMAGE_ID","instructionArrow","routeFerriesLine","routeFerriesSymbol","routeLineBaseTemplate","outlineLineWidth","routeDeselectedOutline","routeDeselectedLine","routeOutline","routeLineArrows","SELECTED_SUMMARY_POPUP_IMAGE_ID","DESELECTED_SUMMARY_POPUP_IMAGE_ID","routeTollRoadsOutline","routeTollRoadsSymbol","EXTRA_FOREGROUND_LINE_WIDTH","routeIncidentsBGLine","routeIncidentsDashedLine","magnitudeOfDelayTextColor","routeIncidentsSymbolBase","routeIncidentsJamSymbol","routeIncidentsCauseSymbol","routeTunnelsLine","routeVehicleRestrictedBackgroundLine","routeVehicleRestrictedDottedLine","TRAFFIC_CLEAR_IMAGE_ID","TRAFFIC_MAJOR_IMAGE_ID","TRAFFIC_MODERATE_IMAGE_ID","TRAFFIC_MINOR_IMAGE_ID","hasFormattedTraffic","summaryBubbleSymbolPoint","START_INDEX","MIDDLE_INDEX","FINISH_INDEX","INDEX_TYPE","STOP_DISPLAY_INDEX","WAYPOINT_START_IMAGE_ID","WAYPOINT_STOP_IMAGE_ID","WAYPOINT_SOFT_IMAGE_ID","WAYPOINT_FINISH_IMAGE_ID","pinIndexLabelLayout","waypointSymbols","waypointLabels","buildRoutingLayers","configLayers","configSectionLayers","sections","mainColor","mainLines","routeLine","waypoints","routeWaypointSymbol","routeWaypointLabel","chargingStops","routeChargingStopSymbol","incident","routeIncidentJamSymbol","routeIncidentCauseSymbol","routeIncidentBackgroundLine","routeIncidentDashedLine","ferry","routeFerryLine","routeFerrySymbol","tollRoad","routeTollRoadOutline","routeTollRoadSymbol","tunnel","routeTunnelLine","vehicleRestricted","routeVehicleRestrictedForegroundLine","instructionLines","routeInstructionLine","routeInstructionOutline","instructionArrows","routeInstructionArrowSymbol","summaryBubbles","routeSummaryBubbleSymbol","defaultRoutingLayers","instructionArrowIconImg","summaryMapBubbleImg","svg","summaryBubbleImageOptions","stretchX","stretchY","content","trafficImg","waypointIcon","foregroundSvg","svgOptions","appendChild","mapLayerSpecs","createLayersSpecs","layerConfigs","ferries","incidents","tollRoads","tunnels","routeModuleConfigWithDefaults","globalDisplayUnits","TomTomConfig","instance","displayUnits","commonBaseURL","apiKey","apiVersion","t","put","reset","r","F","minutes","L","a","abs","o","floor","s","time","hours","padStart","getIconID","chargingStop","basedOn","chargingConnectionInfo","chargingSpeed","formatTitle","chargingParkName","chargingParkOperatorName","toDisplayChargingStops","routes","displayChargingStops","route","leg","summary","chargingInformationAtEndOfLeg","chargingParkId","chargingPower","chargingPowerInkW","chargingDuration","formatDuration","chargingTimeInSeconds","routeState","hasJam","sectionProps","toDisplayTrafficSectionProps","delayInSeconds","jamIconID","magnitudeOfDelay","toTrafficJamIconSuffix","toJamIconID","causeIconID","toCauseIconID","getImageIDForWaypoint","waypoint","indexType","radiusMeters","toDisplayWaypoints","hardWaypointIndex","waypointInput","asWaypoint","arrayLength","indexTypeFor","hardWaypoint","isHardWaypoint","placeProperties","buildWaypointTitle","generateId","entryPoints","getPosition","useEntryPoint","stopDisplayIndex","degreesToRadians","degrees","PI","getCoord","bearing","final","bear","calculateFinalBearing","coordinates1","coordinates2","lon1","lon2","lat1","lat2","sin","cos","b","atan2","index_default","toDisplayRouteSections","sectionType","displaySectionPropsBuilder","startPointIndex","endPointIndex","routeIndex","buildRouteSectionsFromRoute","showFeaturesWithRouteSelection","routesWithSelection","toDisplayRoutes","selectedIndex","hasMagnitude","magnitude","section","toDisplayRouteSummaries","routeCoordinates","formattedTraffic","trafficDelayInSeconds","trafficSections","traffic","summaryDelayMagnitude","formattedDistance","formatDistance","lengthInMeters","distance","formattedDuration","travelTimeInSeconds","RoutingModule","createSourcesWithLayers","layersSpecs","routingSourcesWithLayers","svgIconOptions","addImageIfNotExisting","waypointStartIcon","softWaypointIcon","waypointFinishIcon","customChargingStopIcon","customIcons","mergedConfig","newLayersSpecs","layersSpecID","oldLayersSpecs","newLayersMap","acc","cur","oldLayersMap","layersToRemove","newLayersToUpdate","oldLayersToUpdate","removeLayer","toBeAddedLayerSpec","updateLayersAndSource","listOfSources","previouslyShown","item","showRoutes","displayRoutes","guidance","instructions","instruction","routePath","pathPoint","toDisplayInstructions","instructionLastSegment","lastPointBearingDegrees","calcBearing","toDisplayInstructionArrows","clearRoutes","selectRoute","updatedRoutes","showWaypoints","displayWaypoints","clearWaypoints","getLayerToRenderLinesUnder","DEFAULT_STANDARD_STYLE_ID","standardStyleModulesValues","standardLight","trafficIncidents","trafficFlow","standardDark","drivingLight","drivingDark","monoLight","monoDark","satellite","baseMapStyleUrlTemplate","suffix","baseMapStyleUrlTemplates","buildStandardStyleUrl","baseUrl","styleURL","URL","version","searchParams","append","buildStyleInput","mapParams","url","givenUrl","withApiKey","json","TomTomMap","mapLibreOptions","styleChangeHandlers","keepState","effectiveStyle","previousStyle","withPreviousStyleParts","_params","styleLightDarkTheme","handleStyleData","mergeFromGlobal","ensureMapLibreCSSLoaded","tomtomMapParams","validateStyle","maxTileCacheZoomLevels","cancelPendingTileRequestsWhileZooming","attributionControl","compact","transformRequest","params","resourceType","headers","generateTomTomHeaders","buildMapOptions","eventsConfig","loadRTLTextPlugin","getRTLTextPluginStatus","setRTLTextPlugin","catch","from","querySelectorAll","textContent","link","rel","href","head","_setLanguage","language","mapLanguage","split","isLayerLocalizable","textFieldValue","setLanguage","getBBox","getBounds","toArray","setSprite","addPinCategoriesSpriteToStyle","incidentCategories","incidentCategoriesMapping","unknown","accident","fog","dangerous_conditions","rain","ice","jam","lane_closed","road_closed","road_works","wind","flooding","broken_down_vehicle","roadCategories","tertiaryRoadCategories","streetRoadCategories","toMultiSyntaxAllFilter","newSyntaxExpressions","legacySyntaxExpressions","addFilter","addValuesFilter","valuesFilter","addCommonFilterExpressions","sdkFilter","roadSubCategories","buildMapLibreIncidentsFilter","incidentCategoryFilter","magnitudes","magnitudesFilter","indexedMagnitudes","indexOf","delays","delayFilter","mustHaveDelay","minDelayMinutes","delaySeconds","delayFilterToMapLibre","buildMapLibreIncidentFilters","incidentFilters","any","mapLibreFilters","mapLibreFilter","buildMapLibreFlowFilter","showRoadClosures","operator","applyFilter","originalFilters","TrafficFlowModule","flowSource","getLayers","_filter","updateConfig","filterExpression","flowFilters","buildMapLibreFlowFilters","TrafficIncidentsModule","incidentsSource","_setVisible","icons","setIconsVisible","iconFilters","incidentFilterExpression","getNonSymbolLayers","iconFilterExpression","getSymbolLayers","anyIconLayersVisible"],"mappings":"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EAAOjiB,KAAM2hB,GAAUD,GAAWC,EAAO1hB,KAGhE+D,QAAQue,MAAM,iCAAkCzf,GACzC,KAAM,ICoMuB0f,CAAsB/jB,EAAQujB,aAGlE,CA8CA,UAAIlE,GACA,OAAO,IAAIpV,GAAa3Y,KAAK0T,UAAU4D,aAActX,KAAK8X,kBAAkBwa,YAChF,EC3UG,MAAMI,GAAyB,CAClC,OACA,QACA,UACA,cACA,cACA,eACA,YACA,aACA,cACA,cACA,oBACA,aACA,gBACA,cACA,iBC+FSC,GAAsB,QAKtBC,GAAsB,QC1HtBC,GAAgB,CACzBC,KAAM,CACF,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,OAAQ,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,KAAM,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAC/FC,WAAY,CACR,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,MAAO,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAChGC,OAAQ,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACtFC,iBAAkB,CACd,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,UAAW,CACP,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,cAAe,CACX,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,OAAQ,CACJ,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,MAAO,CACH,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,cAAe,CACX,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAEJC,aAAc,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WACvGC,cAAe,CACX,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,YAMFC,GAAe,UAK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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,224,225,226]}